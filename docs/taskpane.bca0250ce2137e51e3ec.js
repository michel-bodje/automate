/*! For license information please see taskpane.bca0250ce2137e51e3ec.js.LICENSE.txt */
!function(){var e={3227:function(e,t,r){"use strict";var n=r(95108);function o(e,t){if(!(this instanceof o))return new o(e,t);this.files={},this.comment=null,this.root="",e&&this.load(e,t),this.clone=function(){var e=this,t=new o;return Object.keys(this.files).forEach((function(r){t.file(r,e.files[r].asUint8Array())})),t},this.shallowClone=function(){var e=new o;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}o.prototype=r(56820),o.prototype.load=r(38435),o.support=r(3276),o.defaults=r(62261),o.utils=r(61970),o.base64={encode:function(e){return n.encode(e)},decode:function(e){return n.decode(e)}},o.compressions=r(35872),e.exports=o,e.exports.default=o},3276:function(e,t){"use strict";if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,t.nodebuffer="undefined"!=typeof Buffer,t.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)t.blob=!1;else{var r=new ArrayBuffer(0);try{t.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(r),t.blob=0===n.getBlob("application/zip").size}catch(e){t.blob=!1}}}},5135:function(e,t,r){"use strict";var n=["modules"];function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}var l=r(62559);l.traits=r(11680),l.moduleWrapper=r(73323);var u=r(80683),d=r(31751),h=r(10614),p=r(64983).getTags;function f(e,t){!0!==e.hideDeprecations&&console.warn(t)}function m(e,t){if(!0!==e.hideDeprecations)return f(e,'Deprecated method ".'.concat(t,'", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ').concat((new Error).stack))}var g=r(62946),y=g.throwMultiError,v=g.throwResolveBeforeCompile,w=g.throwRenderInvalidTemplate,b=g.throwRenderTwice,A=g.XTInternalError,E=g.XTTemplateError,C=g.throwFileTypeNotIdentified,T=g.throwFileTypeNotHandled,x=g.throwApiVersionError,k=r(18468),I=r(58883),_=l.getDefaults,S=l.str2xml,L=l.xml2str,N=l.moduleWrapper,P=l.concatArrays,O=l.uniq,R=l.getDuplicates,M=l.stableSort,D=l.pushArray,U=[3,44,0];function q(e){e.modules=e.modules.filter((function(t){if(!t.supportedFileTypes)return!0;if(!Array.isArray(t.supportedFileTypes))throw new Error("The supportedFileTypes field of the module must be an array");var r=t.supportedFileTypes.includes(e.fileType);return r||t.on("detached"),r}))}function B(e){var t=e.compiled;e.errors=P(Object.keys(t).map((function(e){return t[e].allErrors}))),0!==e.errors.length&&(e.options.errorLogging&&k(e.errors,e.options.errorLogging),y(e.errors))}var H=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.modules,i=void 0===o?[]:o,a=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(r,n);if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targets=[],this.rendered=!1,this.scopeManagers={},this.compiled={},this.modules=[h()],this.xmlDocuments={},0===arguments.length)f(this,"Deprecated docxtemplater constructor with no arguments, view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ".concat((new Error).stack)),this.hideDeprecations=!0,this.setOptions(a);else{if(this.hideDeprecations=!0,this.setOptions(a),!t||!t.files||"function"!=typeof t.file)throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");if(!Array.isArray(i))throw new Error("The modules argument of docxtemplater's constructor must be an array");for(var s=0;s<i.length;s++){var c=i[s];this.attachModule(c)}this.loadZip(t),this.compile(),this.v4Constructor=!0}this.hideDeprecations=!1}return t=e,r=[{key:"verifyApiVersion",value:function(e){return 3!==(e=e.split(".").map((function(e){return parseInt(e,10)}))).length&&x("neededVersion is not a valid version",{neededVersion:e,explanation:"the neededVersion must be an array of length 3"}),e[0]!==U[0]&&x("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:U,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(U.join("."))}),e[1]>U[1]&&x("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:U,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(U.join("."))}),e[1]===U[1]&&e[2]>U[2]&&x("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:U,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(U.join("."))}),!0}},{key:"setModules",value:function(e){for(var t=0,r=this.modules;t<r.length;t++)r[t].set(e)}},{key:"sendEvent",value:function(e){for(var t=0,r=this.modules;t<r.length;t++)r[t].on(e)}},{key:"attachModule",value:function(e){if(this.v4Constructor)throw new A("attachModule() should not be called manually when using the v4 constructor");m(this,"attachModule");var t=a(e);if("function"===t)throw new A("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.");if(!e||"object"!==t)throw new A("Cannot attachModule with a falsy value");if(e.requiredAPIVersion&&this.verifyApiVersion(e.requiredAPIVersion),!0===e.attached){if("function"!=typeof e.clone)throw new Error('Cannot attach a module that was already attached : "'.concat(e.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));e=e.clone()}e.attached=!0;var r=N(e);return this.modules.push(r),r.on("attached"),this.fileType&&q(this),this}},{key:"setOptions",value:function(e){var t,r;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(m(this,"setOptions"),!e)throw new Error("setOptions should be called with an object as first parameter");this.options={};var n=_();for(var o in n){var i=n[o];this.options[o]=null!=e[o]?e[o]:this[o]||i,this[o]=this.options[o]}return(t=this.delimiters).start&&(t.start=l.utf8ToWord(this.delimiters.start)),(r=this.delimiters).end&&(r.end=l.utf8ToWord(this.delimiters.end)),this}},{key:"loadZip",value:function(e){if(this.v4Constructor)throw new Error("loadZip() should not be called manually when using the v4 constructor");if(m(this,"loadZip"),e.loadAsync)throw new A("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");this.zip=e,this.updateFileTypeConfig(),this.modules=P([this.fileTypeConfig.baseModules.map((function(e){return e()})),this.modules]);for(var t=0,r=this.modules;t<r.length;t++){var n=r[t];n.zip=this.zip,n.docxtemplater=this}return q(this),this}},{key:"precompileFile",value:function(e){var t=this.createTemplateClass(e);t.preparse(),this.compiled[e]=t}},{key:"compileFile",value:function(e){this.compiled[e].parse()}},{key:"getScopeManager",value:function(e,t,r){var n;return(n=this.scopeManagers)[e]||(n[e]=u({tags:r,parser:this.parser,cachedParsers:t.cachedParsers})),this.scopeManagers[e]}},{key:"resolveData",value:function(e){var t=this;m(this,"resolveData");var r=[];return Object.keys(this.compiled).length||v(),Promise.resolve(e).then((function(e){return t.data=e,t.setModules({data:t.data,Lexer:d}),t.mapper=t.modules.reduce((function(e,t){return t.getRenderedMap(e)}),{}),Promise.all(Object.keys(t.mapper).map((function(e){var n=t.mapper[e],o=n.from,i=n.data;return Promise.resolve(i).then((function(n){var i=t.compiled[o];return i.filePath=e,i.scopeManager=t.getScopeManager(e,i,n),i.resolveTags(n).then((function(e){return i.scopeManager.finishedResolving=!0,e}),(function(e){Array.prototype.push.apply(r,e)}))}))}))).then((function(e){return 0!==r.length&&(t.options.errorLogging&&k(r,t.options.errorLogging),y(r)),P(e)}))}))}},{key:"reorderModules",value:function(){this.modules=M(this.modules,(function(e,t){return(t.priority||0)-(e.priority||0)}))}},{key:"throwIfDuplicateModules",value:function(){var e=R(this.modules.map((function(e){return e.name})));if(e.length>0)throw new A('Detected duplicate module "'.concat(e[0],'"'))}},{key:"compile",value:function(){var e=this;if(m(this,"compile"),this.updateFileTypeConfig(),this.throwIfDuplicateModules(),this.reorderModules(),Object.keys(this.compiled).length)return this;this.options=this.modules.reduce((function(t,r){return r.optionsTransformer(t,e)}),this.options),this.options.xmlFileNames=O(this.options.xmlFileNames);for(var t=0,r=this.options.xmlFileNames;t<r.length;t++){var n=r[t],o=this.zip.files[n].asText();this.xmlDocuments[n]=S(o)}this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles();for(var i=0,a=this.templatedFiles;i<a.length;i++){var s=a[i];null!=this.zip.files[s]&&this.precompileFile(s)}for(var c=0,l=this.templatedFiles;c<l.length;c++){var u=l[c];null!=this.zip.files[u]&&this.compileFile(u)}return this.setModules({compiled:this.compiled}),B(this),this}},{key:"getRelsTypes",value:function(){for(var e=this.zip.files["_rels/.rels"],t=e?S(e.asText()):null,r=t?t.getElementsByTagName("Relationship"):[],n={},o=0;o<r.length;o++){var i=r[o];n[i.getAttribute("Target")]=i.getAttribute("Type")}return n}},{key:"getContentTypes",value:function(){var e=this.zip.files["[Content_Types].xml"],t=e?S(e.asText()):null;return{overrides:t?t.getElementsByTagName("Override"):null,defaults:t?t.getElementsByTagName("Default"):null,contentTypes:e,contentTypeXml:t}}},{key:"updateFileTypeConfig",value:function(){var t;this.zip.files.mimetype&&(t="odt"),this.relsTypes=this.getRelsTypes();var r=this.getContentTypes(),n=r.overrides,o=r.defaults,i=r.contentTypes,a=r.contentTypeXml;a&&(this.filesContentTypes=I(n,o,this.zip),this.invertedContentTypes=l.invertMap(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes}));for(var s=0,c=this.modules;s<c.length;s++)t=c[s].getFileType({zip:this.zip,contentTypes:i,contentTypeXml:a,overrides:n,defaults:o,doc:this})||t;"odt"===t&&T(t),t||C(this.zip);for(var u=0,d=this.modules;u<d.length;u++)for(var h=0,p=d[u].xmlContentTypes||[];h<p.length;h++){var f=p[h];D(this.options.xmlFileNames,this.invertedContentTypes[f]||[])}if(this.fileType=t,q(this),this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig,!this.fileTypeConfig){if(!e.FileTypeConfig[this.fileType]){var m='Filetype "'.concat(this.fileType,'" is not supported'),g="filetype_not_supported";"xlsx"===this.fileType&&(m='Filetype "'.concat(this.fileType,'" is supported only with the paid XlsxModule'),g="xlsx_filetype_needs_xlsx_module");var y=new E(m);throw y.properties={id:g,explanation:m},y}this.fileTypeConfig=e.FileTypeConfig[this.fileType]()}return this}},{key:"renderAsync",value:function(e){var t=this;this.hideDeprecations=!0;var r=this.resolveData(e);return this.hideDeprecations=!1,r.then((function(){return t.render()}))}},{key:"render",value:function(e){this.rendered&&b(),this.rendered=!0,0===Object.keys(this.compiled).length&&this.compile(),this.errors.length>0&&w(),arguments.length>0&&(this.data=e),this.setModules({data:this.data,Lexer:d}),this.mapper||(this.mapper=this.modules.reduce((function(e,t){return t.getRenderedMap(e)}),{}));var t=[];for(var r in this.mapper){var n=this.mapper[r],i=n.from,a=n.data,s=this.compiled[i];s.scopeManager=this.getScopeManager(r,s,a),s.render(r),t.push([r,s.content,s]),delete s.content}for(var c=0;c<t.length;c++)for(var l=t[c],u=o(l,3),h=u[1],p=u[2],f=0,m=this.modules;f<m.length;f++){var g=m[f];if(g.preZip){var y=g.preZip(h,p);"string"==typeof y&&(l[1]=y)}}for(var v=0;v<t.length;v++){var A=o(t[v],2),E=A[0],C=A[1];this.zip.file(E,C,{createFolders:!0})}return B(this),this.sendEvent("syncing-zip"),this.syncZip(),this.sendEvent("synced-zip"),this}},{key:"syncZip",value:function(){for(var e in this.xmlDocuments){this.zip.remove(e);var t=L(this.xmlDocuments[e]);this.zip.file(e,t,{createFolders:!0})}}},{key:"setData",value:function(e){return m(this,"setData"),this.data=e,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:"createTemplateClassFromContent",value:function(t,r){for(var n={filePath:r,contentType:this.filesContentTypes[r],relsType:this.relsTypes[r]},o=_(),i=D(Object.keys(o),["filesContentTypes","fileTypeConfig","fileType","modules"]),a=0;a<i.length;a++){var s=i[a];n[s]=this[s]}return new e.XmlTemplater(t,n)}},{key:"getFullText",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),D(this.templatedFiles,this.targets),this.templatedFiles=O(this.templatedFiles),this.templatedFiles}},{key:"getTags",value:function(){var e={headers:[],footers:[]};for(var t in this.compiled){var r=this.filesContentTypes[t];"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"===r&&(e.document={target:t,tags:p(this.compiled[t].postparsed)}),"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"===r&&e.headers.push({target:t,tags:p(this.compiled[t].postparsed)}),"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"===r&&e.footers.push({target:t,tags:p(this.compiled[t].postparsed)})}return e}}],r&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();H.DocUtils=l,H.Errors=r(62946),H.XmlTemplater=r(71362),H.FileTypeConfig=r(87399),H.XmlMatcher=r(64759),e.exports=H,e.exports.default=H},6479:function(e,t,r){"use strict";var n=r(62566).freeze;t.XML_ENTITIES=n({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=n({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),t.entityMap=t.HTML_ENTITIES},9236:function(e,t,r){"use strict";e.exports=r.p+"assets/images/image001.gif"},10540:function(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},10614:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var a=r(73323),s=r(67770),c=r(26548),l=[c.settingsContentType,c.coreContentType,c.appContentType,c.customContentType,c.diagramDataContentType,c.diagramDrawingContentType],u=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Common"},(t=[{key:"getFileType",value:function(e){var t=e.doc,r=t.invertedContentTypes;if(r){for(var n=0;n<l.length;n++){var o=l[n];r[o]&&Array.prototype.push.apply(t.targets,r[o])}for(var i,a=["docx","pptx","xlsx"],c=0;c<a.length;c++){for(var u=a[c],d=s[u],h=0;h<d.length;h++){var p=d[h];if(r[p])for(var f=0,m=r[p];f<m.length;f++){var g=m[f];t.relsTypes[g]&&-1===["http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"].indexOf(t.relsTypes[g])||(i=u,-1===s.main.indexOf(p)&&p!==s.pptx[0]||t.textTarget||(t.textTarget=g),"xlsx"!==i&&t.targets.push(g))}}if(i)return i}return i}}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return a(new u)}},11680:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=r(62559),d=u.getRightOrNull,h=u.getRight,p=u.getLeft,f=u.getLeftOrNull,m=u.chunkBy,g=u.isTagStart,y=u.isTagEnd,v=u.isContent,w=u.last,b=u.first,A=r(62946),E=A.XTTemplateError,C=A.throwExpandNotFound,T=A.getLoopPositionProducesInvalidXMLError;function x(e,t){return 0!==e.length&&0===w(e).substr(1).indexOf(t)}function k(e,t,r,n){var o=e.expandTo||n.expandTo;if(o){var i,a;try{a=p(r,o,t),i=h(r,o,t)}catch(i){var s=c({part:e,rootError:i,postparsed:r,expandTo:o,index:t},n.error);if(n.onError&&"ignore"===n.onError(s))return;C(s)}return[a,i]}}function I(e,t,r,n){var i=o(e,2),a=i[0],s=i[1],c=r.indexOf(t),l=r.slice(a,c),u=r.slice(c+1,s+1),d=n.getInner({postparse:n.postparse,index:c,part:t,leftParts:l,rightParts:u,left:a,right:s,postparsed:r});return d.length||(d.expanded=[l,u],d=[d]),{left:a,right:s,inner:d}}e.exports={expandToOne:function(e,t){var r,n=[];e.errors&&(n=e.errors,e=e.postparsed);for(var s=[],l=0,u=e.length;l<u;l++){var d=e[l];if("placeholder"===d.type&&d.module===t.moduleName&&!d.subparsed&&!d.expanded)try{var h=k(d,l,e,t);if(!h)continue;var p=o(h,2),f=p[0],m=p[1];s.push({left:f,right:m,part:d,i:l,leftPart:e[f],rightPart:e[m]})}catch(e){n.push(e)}}s.sort((function(e,t){return e.left===t.left?t.part.lIndex<e.part.lIndex?1:-1:t.left<e.left?1:-1}));for(var g=-1,y=0,v=0,w=s.length;v<w;v++){var b,A=s[v];if(g=Math.max(g,v>0?s[v-1].right:0),!(A.left<g)){var C=void 0;try{C=I([A.left+y,A.right+y],A.part,e,t)}catch(r){if(t.onError&&"ignore"===t.onError(c({part:A.part,rootError:r,postparsed:e,expandOne:I},t.errors)))continue;if(!(r instanceof E))throw r;n.push(r)}C&&(y+=C.inner.length-(C.right+1-C.left),(b=e).splice.apply(b,[C.left,C.right+1-C.left].concat(function(e){if(Array.isArray(e))return a(e)}(r=C.inner)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||i(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())))}}return{postparsed:e,errors:n}},getExpandToDefault:function(e,t,r){var n=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],o=n.position,i=n.value,a=n.tag;a&&("end"===o?x(t,a)?t.pop():t.push(i):"start"===o&&t.push(i))}return t}(e.slice(t[0].offset,t[1].offset));if(n.filter((function(e){return"/"===e[1]})).length!==n.filter((function(e){return"/"!==e[1]&&"/"!==e[e.length-2]})).length)return{error:T({tag:b(t).part.value,offset:[b(t).part.offset,w(t).part.offset]})};for(var o,i=function(){var o=r[a],i=o.contains,s=o.expand,c=o.onlyTextInTag;if(function(e,t){for(var r=0;r<t.length;r++)if(0===t[r].indexOf("<".concat(e)))return!0;return!1}(i,n)){if(c){var l=f(e,i,t[0].offset),u=d(e,i,t[1].offset);if(null===l||null===u)return 0;var h=m(e.slice(l,u),(function(e){return g(i,e)?"start":y(i,e)?"end":null})),p=b(h),A=w(h),E=p.filter(v),C=A.filter(v);if(1!==E.length||1!==C.length)return 0}return{v:{value:s}}}},a=0;a<r.length;a++)if(0!==(o=i())&&o)return o.v;return{}}}},15153:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=r(79814);e.exports=function(e){var t=[],r=e.baseNullGetter,n=e.compiled,i=e.scopeManager;e.nullGetter=function(e,t){return r(e,t||i)},e.resolved=t;var s=[];return Promise.all(n.filter((function(e){return-1===["content","tag"].indexOf(e.type)})).reduce((function(r,n){var l,u=function(e,t){for(var r=0,n=t.modules;r<n.length;r++){var o=n[r].resolve(e,t);if(o)return o}return!1}(n,a(a({},e),{},{resolvedId:c(n,e)}));if(u)l=u.then((function(e){t.push({tag:n.value,lIndex:n.lIndex,value:e})}));else{if("placeholder"!==n.type)return;l=i.getValueAsync(n.value,{part:n}).then((function(t){return null==t?e.nullGetter(n):t})).then((function(e){return t.push({tag:n.value,lIndex:n.lIndex,value:e}),e}))}return r.push(l.catch((function(e){var t;e instanceof Array?s.push.apply(s,function(e){if(Array.isArray(e))return o(e)}(t=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):s.push(e)}))),r}),[])).then((function(){return{errors:s,resolved:t}}))}},15474:function(e,t,r){"use strict";var n=r(62566),o=r(58491),i=r(97191),a=n.isHTMLEscapableRawTextElement,s=n.isHTMLMimeType,c=n.isHTMLRawTextElement,l=n.hasOwn,u=n.NAMESPACE,d=i.ParseError,h=i.DOMException;function p(){}p.prototype={parse:function(e,t,r){var i=this.domBuilder;i.startDocument(),w(t,t=Object.create(null)),function(e,t,r,i,a){var c=s(i.mimeType);function u(e){var t=";"===e[e.length-1]?e:e+";";if(!c&&t!==e)return a.error("EntityRef: expecting ;"),e;var n=o.Reference.exec(t);if(!n||n[0].length!==t.length)return a.error("entity not matching Reference production: "+e),e;var i=t.slice(1,-1);return l(r,i)?r[i]:"#"===i.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}(parseInt(i.substring(1).replace("x","0x"))):(a.error("entity not found:"+e),e)}function p(t){if(t>S){var r=e.substring(S,t).replace(f,u);x&&k(S),i.characters(r,0,t-S),S=t}}e.indexOf(o.UNICODE_REPLACEMENT_CHARACTER)>=0&&a.warning("Unicode replacement character detected, source encoding issues?");var w=0,b=0,T=/\r\n?|\n|$/g,x=i.locator;function k(t,r){for(;t>=b&&(r=T.exec(e));)w=b,b=r.index+r[0].length,x.lineNumber++;x.columnNumber=t-w+1}for(var I=[{currentNSMap:t}],_=[],S=0;;){try{var L=e.indexOf("<",S);if(L<0){if(!c&&_.length>0)return a.fatalError("unclosed xml tag(s): "+_.join(", "));if(!e.substring(S).match(/^\s*$/)){var N=i.doc,P=N.createTextNode(e.substring(S));if(N.documentElement)return a.error("Extra content at the end of the document");N.appendChild(P),i.currentElement=P}return}if(L>S){var O=e.substring(S,L);c||0!==_.length||(O=O.replace(new RegExp(o.S_OPT.source,"g"),""))&&a.error("Unexpected content outside root element: '"+O+"'"),p(L)}switch(e.charAt(L+1)){case"/":var R=e.indexOf(">",L+2),M=e.substring(L+2,R>0?R:void 0);if(!M)return a.fatalError("end tag name missing");var D=R>0&&o.reg("^",o.QName_group,o.S_OPT,"$").exec(M);if(!D)return a.fatalError('end tag name contains invalid characters: "'+M+'"');if(!i.currentElement&&!i.doc.documentElement)return;var U=_[_.length-1]||i.currentElement.tagName||i.doc.documentElement.tagName||"";if(U!==D[1]){var q=D[1].toLowerCase();if(!c||U.toLowerCase()!==q)return a.fatalError('Opening and ending tag mismatch: "'+U+'" != "'+M+'"')}var B=I.pop();_.pop();var H=B.localNSMap;if(i.endElement(B.uri,B.localName,U),H)for(var F in H)l(H,F)&&i.endPrefixMapping(F);R++;break;case"?":x&&k(L),R=E(e,L,i,a);break;case"!":x&&k(L),R=A(e,L,i,a,c);break;default:x&&k(L);var z=new C,j=I[I.length-1].currentNSMap,G=(R=g(e,L,z,0,u,a,c),z.length);if(z.closed||(c&&n.isHTMLVoidElement(z.tagName)?z.closed=!0:_.push(z.tagName)),x&&G){for(var W=m(x,{}),K=0;K<G;K++){var $=z[K];k($.offset),$.locator=m(x,{})}i.locator=W,y(z,i,j)&&I.push(z),i.locator=x}else y(z,i,j)&&I.push(z);c&&!z.closed?R=v(e,R,z.tagName,u,i):R++}}catch(e){if(e instanceof d)throw e;if(e instanceof h)throw new d(e.name+": "+e.message,i.locator,e);a.error("element parse error: "+e),R=-1}R>S?S=R:p(Math.max(L,S)+1)}}(e,t,r,i,this.errorHandler),i.endDocument()}};var f=/&#?\w+;?/g;function m(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function g(e,t,r,n,o,i,a){function s(e,t,n){return l(r.attributeNames,e)?i.fatalError("Attribute "+e+" redefined"):!a&&t.indexOf("<")>=0?i.fatalError("Unescaped '<' not allowed in attributes values"):void r.addValue(e,t.replace(/[\t\n\r]/g," ").replace(f,o),n)}for(var c,u=++t,d=0;;){var h=e.charAt(u);switch(h){case"=":if(1===d)c=e.slice(t,u),d=3;else{if(2!==d)throw new Error("attribute equal must after attrName");d=3}break;case"'":case'"':if(3===d||1===d){if(1===d&&(i.warning('attribute value must after "="'),c=e.slice(t,u)),t=u+1,!((u=e.indexOf(h,t))>0))throw new Error("attribute value no end '"+h+"' match");s(c,p=e.slice(t,u),t-1),d=5}else{if(4!=d)throw new Error('attribute value must after "="');s(c,p=e.slice(t,u),t),i.warning('attribute "'+c+'" missed start quot('+h+")!!"),t=u+1,d=5}break;case"/":switch(d){case 0:r.setTagName(e.slice(t,u));case 5:case 6:case 7:d=7,r.closed=!0;case 4:case 1:break;case 2:r.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),0==d&&r.setTagName(e.slice(t,u)),u;case">":switch(d){case 0:r.setTagName(e.slice(t,u));case 5:case 6:case 7:break;case 4:case 1:"/"===(p=e.slice(t,u)).slice(-1)&&(r.closed=!0,p=p.slice(0,-1));case 2:2===d&&(p=c),4==d?(i.warning('attribute "'+p+'" missed quot(")!'),s(c,p,t)):(a||i.warning('attribute "'+p+'" missed value!! "'+p+'" instead!!'),s(p,p,t));break;case 3:if(!a)return i.fatalError("AttValue: ' or \" expected")}return u;case"":h=" ";default:if(h<=" ")switch(d){case 0:r.setTagName(e.slice(t,u)),d=6;break;case 1:c=e.slice(t,u),d=2;break;case 4:var p=e.slice(t,u);i.warning('attribute "'+p+'" missed quot(")!!'),s(c,p,t);case 5:d=6}else switch(d){case 2:a||i.warning('attribute "'+c+'" missed value!! "'+c+'" instead2!!'),s(c,c,t),t=u,d=1;break;case 5:i.warning('attribute space is required"'+c+'"!!');case 6:d=1,t=u;break;case 3:d=4,t=u;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function y(e,t,r){for(var n=e.tagName,o=null,i=e.length;i--;){var a=e[i],s=a.qName,c=a.value;if((f=s.indexOf(":"))>0)var d=a.prefix=s.slice(0,f),h=s.slice(f+1),p="xmlns"===d&&h;else h=s,d=null,p="xmlns"===s&&"";a.localName=h,!1!==p&&(null==o&&(o=Object.create(null),w(r,r=Object.create(null))),r[p]=o[p]=c,a.uri=u.XMLNS,t.startPrefixMapping(p,c))}for(i=e.length;i--;)(a=e[i]).prefix&&("xml"===a.prefix&&(a.uri=u.XML),"xmlns"!==a.prefix&&(a.uri=r[a.prefix]));var f;(f=n.indexOf(":"))>0?(d=e.prefix=n.slice(0,f),h=e.localName=n.slice(f+1)):(d=null,h=e.localName=n);var m=e.uri=r[d||""];if(t.startElement(m,h,n,e),!e.closed)return e.currentNSMap=r,e.localNSMap=o,!0;if(t.endElement(m,h,n),o)for(d in o)l(o,d)&&t.endPrefixMapping(d)}function v(e,t,r,n,o){var i=a(r);if(i||c(r)){var s=e.indexOf("</"+r+">",t),l=e.substring(t+1,s);return i&&(l=l.replace(f,n)),o.characters(l,0,l.length),s}return t+1}function w(e,t){for(var r in e)l(e,r)&&(t[r]=e[r])}function b(e,t){var r=t;function n(t){return t=t||0,e.charAt(r+t)}function i(e){r+=e=e||1}function a(){return e.substring(r)}return{char:n,getIndex:function(){return r},getMatch:function(e){var t=o.reg("^",e).exec(a());return t?(i(t[0].length),t[0]):null},getSource:function(){return e},skip:i,skipBlanks:function(){for(var t=0;r<e.length;){var o=n();if(" "!==o&&"\n"!==o&&"\t"!==o&&"\r"!==o)return t;t++,i()}return-1},substringFromIndex:a,substringStartsWith:function(t){return e.substring(r,r+t.length)===t},substringStartsWithCaseInsensitive:function(t){return e.substring(r,r+t.length).toUpperCase()===t.toUpperCase()}}}function A(e,t,r,n,i){var a=b(e,t);switch(i?a.char(2).toUpperCase():a.char(2)){case"-":var s=a.getMatch(o.Comment);return s?(r.comment(s,o.COMMENT_START.length,s.length-o.COMMENT_START.length-o.COMMENT_END.length),a.getIndex()):n.fatalError("comment is not well-formed at position "+a.getIndex());case"[":var c=a.getMatch(o.CDSect);return c?i||r.currentElement?(r.startCDATA(),r.characters(c,o.CDATA_START.length,c.length-o.CDATA_START.length-o.CDATA_END.length),r.endCDATA(),a.getIndex()):n.fatalError("CDATA outside of element"):n.fatalError("Invalid CDATA starting at position "+t);case"D":if(r.doc&&r.doc.documentElement)return n.fatalError("Doctype not allowed inside or after documentElement at position "+a.getIndex());if(i?!a.substringStartsWithCaseInsensitive(o.DOCTYPE_DECL_START):!a.substringStartsWith(o.DOCTYPE_DECL_START))return n.fatalError("Expected "+o.DOCTYPE_DECL_START+" at position "+a.getIndex());if(a.skip(o.DOCTYPE_DECL_START.length),a.skipBlanks()<1)return n.fatalError("Expected whitespace after "+o.DOCTYPE_DECL_START+" at position "+a.getIndex());var l={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(l.name=a.getMatch(o.Name),!l.name)return n.fatalError("doctype name missing or contains unexpected characters at position "+a.getIndex());if(i&&"html"!==l.name.toLowerCase()&&n.warning("Unexpected DOCTYPE in HTML document at position "+a.getIndex()),a.skipBlanks(),a.substringStartsWith(o.PUBLIC)||a.substringStartsWith(o.SYSTEM)){var u=o.ExternalID_match.exec(a.substringFromIndex());if(!u)return n.fatalError("doctype external id is not well-formed at position "+a.getIndex());void 0!==u.groups.SystemLiteralOnly?l.systemId=u.groups.SystemLiteralOnly:(l.systemId=u.groups.SystemLiteral,l.publicId=u.groups.PubidLiteral),a.skip(u[0].length)}else if(i&&a.substringStartsWithCaseInsensitive(o.SYSTEM)){if(a.skip(o.SYSTEM.length),a.skipBlanks()<1)return n.fatalError("Expected whitespace after "+o.SYSTEM+" at position "+a.getIndex());if(l.systemId=a.getMatch(o.ABOUT_LEGACY_COMPAT_SystemLiteral),!l.systemId)return n.fatalError("Expected "+o.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+o.SYSTEM+" at position "+a.getIndex())}return i&&l.systemId&&!o.ABOUT_LEGACY_COMPAT_SystemLiteral.test(l.systemId)&&n.warning("Unexpected doctype.systemId in HTML document at position "+a.getIndex()),i||(a.skipBlanks(),l.internalSubset=function(e,t){function r(e,t){var r=o.PI.exec(e.substringFromIndex());return r?"xml"===r[1].toLowerCase()?t.fatalError("xml declaration is only allowed at the start of the document, but found at position "+e.getIndex()):(e.skip(r[0].length),r[0]):t.fatalError("processing instruction is not well-formed at position "+e.getIndex())}var n=e.getSource();if("["===e.char()){e.skip(1);for(var i=e.getIndex();e.getIndex()<n.length;){if(e.skipBlanks(),"]"===e.char()){var a=n.substring(i,e.getIndex());return e.skip(1),a}var s=null;if("<"===e.char()&&"!"===e.char(1))switch(e.char(2)){case"E":"L"===e.char(3)?s=e.getMatch(o.elementdecl):"N"===e.char(3)&&(s=e.getMatch(o.EntityDecl));break;case"A":s=e.getMatch(o.AttlistDecl);break;case"N":s=e.getMatch(o.NotationDecl);break;case"-":s=e.getMatch(o.Comment)}else if("<"===e.char()&&"?"===e.char(1))s=r(e,t);else{if("%"!==e.char())return t.fatalError("Error detected in Markup declaration");s=e.getMatch(o.PEReference)}if(!s)return t.fatalError("Error in internal subset at position "+e.getIndex())}return t.fatalError("doctype internal subset is not well-formed, missing ]")}}(a,n)),a.skipBlanks(),">"!==a.char()?n.fatalError("doctype not terminated with > at position "+a.getIndex()):(a.skip(1),r.startDTD(l.name,l.publicId,l.systemId,l.internalSubset),r.endDTD(),a.getIndex());default:return n.fatalError('Not well-formed XML starting with "<!" at position '+t)}}function E(e,t,r,n){var i=e.substring(t).match(o.PI);if(!i)return n.fatalError("Invalid processing instruction starting at position "+t);if("xml"===i[1].toLowerCase()){if(t>0)return n.fatalError("processing instruction at position "+t+" is an xml declaration which is only at the start of the document");if(!o.XMLDecl.test(e.substring(t)))return n.fatalError("xml declaration is not well-formed")}return r.processingInstruction(i[1],i[2]),t+i[0].length}function C(){this.attributeNames=Object.create(null)}C.prototype={setTagName:function(e){if(!o.QName_exact.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,r){if(!o.QName_exact.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=p,t.parseUtils=b,t.parseDoctypeCommentOrCData=A},18468:function(e,t,r){"use strict";var n=r(62559).pushArray;function o(e,t){return t instanceof Error?n(Object.getOwnPropertyNames(t),["stack"]).reduce((function(e,r){return e[r]=t[r],"stack"===r&&(e[r]=t[r].toString()),e}),{}):t}e.exports=function(e,t){if(console.log(JSON.stringify({error:e},o,"json"===t?2:null)),e.properties&&e.properties.errors instanceof Array){var r=e.properties.errors.map((function(e){return e.properties.explanation})).join("\n");console.log("errorMessages",r)}}},26548:function(e){"use strict";e.exports={settingsContentType:"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",coreContentType:"application/vnd.openxmlformats-package.core-properties+xml",appContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml",customContentType:"application/vnd.openxmlformats-officedocument.custom-properties+xml",diagramDataContentType:"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",diagramDrawingContentType:"application/vnd.ms-office.drawingml.diagramDrawing+xml"}},28205:function(e,t,r){"use strict";var n=r(66144),o=r(94758);function i(e,t){this.data=e,t||(this.data=o.string2binary(this.data)),this.length=this.data.length,this.index=0,this.zero=0}i.prototype=new n,i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},28926:function(e,t,r){"use strict";var n=r(71354),o=r.n(n),i=r(76314),a=r.n(i)()(o());a.push([e.id,':root {\r\n    --bg-dark: #1e1e1e;\r\n    --bg-darker: #2c2c2c;\r\n    --bg-form: #333;\r\n    --text-light: #f4f4f4;\r\n    --accent: #0078d4;\r\n    --accent-hover: #005a9e;\r\n    --neutral-dark: #444;\r\n    --neutral-border: #666;\r\n    --radius: 6px;\r\n    --transition: 0.2s ease-in-out;\r\n    --font-size-base: 14px;\r\n}\r\n\r\nhtml, body {\r\n    height: 100%;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nbody {\r\n    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;\r\n    background-color: var(--bg-dark);\r\n    color: var(--text-light);\r\n    -webkit-font-smoothing: antialiased;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n/* Prevent scrolling only on the menu page */\r\n#menu-page.page.active {\r\n    overflow: hidden;\r\n}\r\n\r\n.page {\r\n    visibility: hidden;\r\n    opacity: 0;\r\n    transform: translateY(10px);\r\n    position: absolute;\r\n    padding: 24px;\r\n    background-color: var(--bg-darker);\r\n    border-radius: var(--radius);\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);\r\n    max-width: 600px;\r\n    transition: opacity 0.3s ease, transform 0.3s ease, visibility 0s linear 0.3s;\r\n    left: 0;\r\n    right: 0;\r\n    margin: 20px auto;\r\n    pointer-events: none;\r\n}\r\n\r\n.page.active {\r\n    visibility: visible;\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n    transition-delay: 0s;\r\n    pointer-events: all;\r\n}\r\n\r\nh1 {\r\n    font-size: 22px;\r\n    color: var(--accent);\r\n    text-align: center;\r\n    margin-bottom: 20px;\r\n    font-weight: 600;\r\n}\r\n\r\n.header {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    text-align: center;\r\n    padding: 24px;\r\n}\r\n\r\n.logo {\r\n    max-width: 180px;\r\n    max-height: 180px;\r\n    margin: 12px auto;\r\n    display: block;\r\n}\r\n\r\n.ms-overlay {\r\n    position: fixed;\r\n    top: 0; left: 0; right: 0; bottom: 0;\r\n    background: rgba(0,0,0,0.8);\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: 1000;\r\n}\r\n\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.ms-Spinner {\r\n    margin-bottom: 1rem;\r\n}\r\n\r\n#menu-page button {\r\n    display: block;\r\n    width: 100%;\r\n    margin: 12px 0;\r\n    padding: 10px 16px;\r\n    font-size: var(--font-size-base);\r\n    font-weight: bold;\r\n    background-color: var(--accent);\r\n    color: #fff;\r\n    border: none;\r\n    border-radius: var(--radius);\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n    cursor: pointer;\r\n    transition: background-color var(--transition), transform var(--transition);\r\n}\r\n\r\n#menu-page button:hover {\r\n    background-color: var(--accent-hover);\r\n    transform: translateY(-1px);\r\n}\r\n\r\nform {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 18px;\r\n}\r\n\r\nlabel {\r\n    font-size: 13px;\r\n    font-weight: 600;\r\n    margin-bottom: 4px;\r\n    color: var(--text-light);\r\n}\r\n\r\ninput[type="text"],\r\ninput[type="email"],\r\ninput[type="tel"],\r\ninput[type="file"],\r\ninput[type="date"],\r\ninput[type="time"],\r\ninput[type="number"],\r\nselect,\r\ntextarea {\r\n    width: 100%;\r\n    padding: 10px;\r\n    border: 1px solid var(--neutral-dark);\r\n    border-radius: var(--radius);\r\n    font-size: var(--font-size-base);\r\n    background-color: var(--bg-form);\r\n    color: var(--text-light);\r\n    box-sizing: border-box;\r\n    transition: border-color var(--transition);\r\n}\r\n\r\ninput:focus,\r\nselect:focus,\r\ntextarea:focus {\r\n    border-color: var(--accent);\r\n    outline: none;\r\n    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.4);\r\n}\r\n\r\ntextarea {\r\n    resize: vertical;\r\n    min-height: 80px;\r\n}\r\n\r\n.checkbox-container {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n}\r\n\r\ninput[type="checkbox"] {\r\n    width: 18px;\r\n    height: 18px;\r\n    accent-color: var(--accent);\r\n}\r\n\r\nbutton {\r\n    padding: 10px 16px;\r\n    font-size: var(--font-size-base);\r\n    font-weight: bold;\r\n    color: #fff;\r\n    background-color: var(--accent);\r\n    border: none;\r\n    border-radius: var(--radius);\r\n    cursor: pointer;\r\n    transition: background-color var(--transition), box-shadow var(--transition);\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n}\r\n\r\nbutton:hover {\r\n    background-color: var(--accent-hover);\r\n    box-shadow: 0 4px 8px rgba(0,0,0,0.3);\r\n}\r\n\r\nbutton[type="button"] {\r\n    background-color: var(--neutral-dark);\r\n    color: var(--text-light);\r\n    border: 1px solid var(--neutral-border);\r\n}\r\n\r\nbutton[type="button"]:hover {\r\n    background-color: #555;\r\n}\r\n\r\n#case-details {\r\n    padding: 18px;\r\n    border: 1px solid var(--accent);\r\n    border-radius: var(--radius);\r\n    background-color: var(--bg-form);\r\n}\r\n\r\ninput[type="file"] {\r\n    padding: 6px;\r\n}\r\n\r\n.modal {\r\n    position: fixed;\r\n    top: 0; left: 0; width: 100%; height: 100%;\r\n    background-color: rgba(0, 0, 0, 0.6);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    z-index: 1000;\r\n}\r\n\r\n.modal.hidden {\r\n    display: none;\r\n}\r\n\r\n.modal-content {\r\n    background-color: #fff;\r\n    padding: 24px;\r\n    border-radius: var(--radius);\r\n    text-align: center;\r\n    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);\r\n    color: #000;\r\n    min-width: 280px;\r\n}\r\n\r\n#error-ok-button {\r\n    margin-top: 16px;\r\n    padding: 10px 20px;\r\n    background-color: var(--accent);\r\n    color: white;\r\n    border: none;\r\n    border-radius: var(--radius);\r\n    cursor: pointer;\r\n}\r\n\r\n#error-ok-button:hover {\r\n    background-color: var(--accent-hover);\r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .page {\r\n        margin: 12px;\r\n        padding: 16px;\r\n    }\r\n\r\n    h1 {\r\n        font-size: 18px;\r\n    }\r\n\r\n    button {\r\n        font-size: 12px;\r\n    }\r\n}\r\n\r\n/* Focus-visible styles for keyboard nav */\r\ninput:focus-visible,\r\nselect:focus-visible,\r\ntextarea:focus-visible,\r\nbutton:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Add to all transitions */\r\ninput,\r\nselect,\r\ntextarea,\r\nbutton {\r\n    transition: background-color var(--transition), border-color var(--transition), transform var(--transition), box-shadow var(--transition);\r\n}\r\n\r\n/* Button active press down effect */\r\nbutton:active {\r\n    transform: scale(0.98);\r\n}',"",{version:3,sources:["webpack://./app/styles/main.css"],names:[],mappings:"AAAA;IACI,kBAAkB;IAClB,oBAAoB;IACpB,eAAe;IACf,qBAAqB;IACrB,iBAAiB;IACjB,uBAAuB;IACvB,oBAAoB;IACpB,sBAAsB;IACtB,aAAa;IACb,8BAA8B;IAC9B,sBAAsB;AAC1B;;AAEA;IACI,YAAY;IACZ,SAAS;IACT,UAAU;AACd;;AAEA;IACI,4DAA4D;IAC5D,gCAAgC;IAChC,wBAAwB;IACxB,mCAAmC;IACnC,aAAa;IACb,sBAAsB;AAC1B;;AAEA,4CAA4C;AAC5C;IACI,gBAAgB;AACpB;;AAEA;IACI,kBAAkB;IAClB,UAAU;IACV,2BAA2B;IAC3B,kBAAkB;IAClB,aAAa;IACb,kCAAkC;IAClC,4BAA4B;IAC5B,yCAAyC;IACzC,gBAAgB;IAChB,6EAA6E;IAC7E,OAAO;IACP,QAAQ;IACR,iBAAiB;IACjB,oBAAoB;AACxB;;AAEA;IACI,mBAAmB;IACnB,UAAU;IACV,wBAAwB;IACxB,oBAAoB;IACpB,mBAAmB;AACvB;;AAEA;IACI,eAAe;IACf,oBAAoB;IACpB,kBAAkB;IAClB,mBAAmB;IACnB,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,uBAAuB;IACvB,kBAAkB;IAClB,aAAa;AACjB;;AAEA;IACI,gBAAgB;IAChB,iBAAiB;IACjB,iBAAiB;IACjB,cAAc;AAClB;;AAEA;IACI,eAAe;IACf,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS;IACpC,2BAA2B;IAC3B,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,uBAAuB;IACvB,aAAa;AACjB;;AAEA;IACI,wBAAwB;AAC5B;;AAEA;IACI,mBAAmB;AACvB;;AAEA;IACI,cAAc;IACd,WAAW;IACX,cAAc;IACd,kBAAkB;IAClB,gCAAgC;IAChC,iBAAiB;IACjB,+BAA+B;IAC/B,WAAW;IACX,YAAY;IACZ,4BAA4B;IAC5B,qCAAqC;IACrC,eAAe;IACf,2EAA2E;AAC/E;;AAEA;IACI,qCAAqC;IACrC,2BAA2B;AAC/B;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,SAAS;AACb;;AAEA;IACI,eAAe;IACf,gBAAgB;IAChB,kBAAkB;IAClB,wBAAwB;AAC5B;;AAEA;;;;;;;;;IASI,WAAW;IACX,aAAa;IACb,qCAAqC;IACrC,4BAA4B;IAC5B,gCAAgC;IAChC,gCAAgC;IAChC,wBAAwB;IACxB,sBAAsB;IACtB,0CAA0C;AAC9C;;AAEA;;;IAGI,2BAA2B;IAC3B,aAAa;IACb,4CAA4C;AAChD;;AAEA;IACI,gBAAgB;IAChB,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,SAAS;AACb;;AAEA;IACI,WAAW;IACX,YAAY;IACZ,2BAA2B;AAC/B;;AAEA;IACI,kBAAkB;IAClB,gCAAgC;IAChC,iBAAiB;IACjB,WAAW;IACX,+BAA+B;IAC/B,YAAY;IACZ,4BAA4B;IAC5B,eAAe;IACf,4EAA4E;IAC5E,qCAAqC;AACzC;;AAEA;IACI,qCAAqC;IACrC,qCAAqC;AACzC;;AAEA;IACI,qCAAqC;IACrC,wBAAwB;IACxB,uCAAuC;AAC3C;;AAEA;IACI,sBAAsB;AAC1B;;AAEA;IACI,aAAa;IACb,+BAA+B;IAC/B,4BAA4B;IAC5B,gCAAgC;AACpC;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,eAAe;IACf,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,YAAY;IAC1C,oCAAoC;IACpC,aAAa;IACb,uBAAuB;IACvB,mBAAmB;IACnB,aAAa;AACjB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,sBAAsB;IACtB,aAAa;IACb,4BAA4B;IAC5B,kBAAkB;IAClB,yCAAyC;IACzC,WAAW;IACX,gBAAgB;AACpB;;AAEA;IACI,gBAAgB;IAChB,kBAAkB;IAClB,+BAA+B;IAC/B,YAAY;IACZ,YAAY;IACZ,4BAA4B;IAC5B,eAAe;AACnB;;AAEA;IACI,qCAAqC;AACzC;;AAEA;IACI;QACI,YAAY;QACZ,aAAa;IACjB;;IAEA;QACI,eAAe;IACnB;;IAEA;QACI,eAAe;IACnB;AACJ;;AAEA,0CAA0C;AAC1C;;;;IAII,gCAAgC;IAChC,mBAAmB;AACvB;;AAEA,2BAA2B;AAC3B;;;;IAII,yIAAyI;AAC7I;;AAEA,oCAAoC;AACpC;IACI,sBAAsB;AAC1B",sourcesContent:[':root {\r\n    --bg-dark: #1e1e1e;\r\n    --bg-darker: #2c2c2c;\r\n    --bg-form: #333;\r\n    --text-light: #f4f4f4;\r\n    --accent: #0078d4;\r\n    --accent-hover: #005a9e;\r\n    --neutral-dark: #444;\r\n    --neutral-border: #666;\r\n    --radius: 6px;\r\n    --transition: 0.2s ease-in-out;\r\n    --font-size-base: 14px;\r\n}\r\n\r\nhtml, body {\r\n    height: 100%;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nbody {\r\n    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;\r\n    background-color: var(--bg-dark);\r\n    color: var(--text-light);\r\n    -webkit-font-smoothing: antialiased;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n/* Prevent scrolling only on the menu page */\r\n#menu-page.page.active {\r\n    overflow: hidden;\r\n}\r\n\r\n.page {\r\n    visibility: hidden;\r\n    opacity: 0;\r\n    transform: translateY(10px);\r\n    position: absolute;\r\n    padding: 24px;\r\n    background-color: var(--bg-darker);\r\n    border-radius: var(--radius);\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);\r\n    max-width: 600px;\r\n    transition: opacity 0.3s ease, transform 0.3s ease, visibility 0s linear 0.3s;\r\n    left: 0;\r\n    right: 0;\r\n    margin: 20px auto;\r\n    pointer-events: none;\r\n}\r\n\r\n.page.active {\r\n    visibility: visible;\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n    transition-delay: 0s;\r\n    pointer-events: all;\r\n}\r\n\r\nh1 {\r\n    font-size: 22px;\r\n    color: var(--accent);\r\n    text-align: center;\r\n    margin-bottom: 20px;\r\n    font-weight: 600;\r\n}\r\n\r\n.header {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    text-align: center;\r\n    padding: 24px;\r\n}\r\n\r\n.logo {\r\n    max-width: 180px;\r\n    max-height: 180px;\r\n    margin: 12px auto;\r\n    display: block;\r\n}\r\n\r\n.ms-overlay {\r\n    position: fixed;\r\n    top: 0; left: 0; right: 0; bottom: 0;\r\n    background: rgba(0,0,0,0.8);\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: 1000;\r\n}\r\n\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.ms-Spinner {\r\n    margin-bottom: 1rem;\r\n}\r\n\r\n#menu-page button {\r\n    display: block;\r\n    width: 100%;\r\n    margin: 12px 0;\r\n    padding: 10px 16px;\r\n    font-size: var(--font-size-base);\r\n    font-weight: bold;\r\n    background-color: var(--accent);\r\n    color: #fff;\r\n    border: none;\r\n    border-radius: var(--radius);\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n    cursor: pointer;\r\n    transition: background-color var(--transition), transform var(--transition);\r\n}\r\n\r\n#menu-page button:hover {\r\n    background-color: var(--accent-hover);\r\n    transform: translateY(-1px);\r\n}\r\n\r\nform {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 18px;\r\n}\r\n\r\nlabel {\r\n    font-size: 13px;\r\n    font-weight: 600;\r\n    margin-bottom: 4px;\r\n    color: var(--text-light);\r\n}\r\n\r\ninput[type="text"],\r\ninput[type="email"],\r\ninput[type="tel"],\r\ninput[type="file"],\r\ninput[type="date"],\r\ninput[type="time"],\r\ninput[type="number"],\r\nselect,\r\ntextarea {\r\n    width: 100%;\r\n    padding: 10px;\r\n    border: 1px solid var(--neutral-dark);\r\n    border-radius: var(--radius);\r\n    font-size: var(--font-size-base);\r\n    background-color: var(--bg-form);\r\n    color: var(--text-light);\r\n    box-sizing: border-box;\r\n    transition: border-color var(--transition);\r\n}\r\n\r\ninput:focus,\r\nselect:focus,\r\ntextarea:focus {\r\n    border-color: var(--accent);\r\n    outline: none;\r\n    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.4);\r\n}\r\n\r\ntextarea {\r\n    resize: vertical;\r\n    min-height: 80px;\r\n}\r\n\r\n.checkbox-container {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n}\r\n\r\ninput[type="checkbox"] {\r\n    width: 18px;\r\n    height: 18px;\r\n    accent-color: var(--accent);\r\n}\r\n\r\nbutton {\r\n    padding: 10px 16px;\r\n    font-size: var(--font-size-base);\r\n    font-weight: bold;\r\n    color: #fff;\r\n    background-color: var(--accent);\r\n    border: none;\r\n    border-radius: var(--radius);\r\n    cursor: pointer;\r\n    transition: background-color var(--transition), box-shadow var(--transition);\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n}\r\n\r\nbutton:hover {\r\n    background-color: var(--accent-hover);\r\n    box-shadow: 0 4px 8px rgba(0,0,0,0.3);\r\n}\r\n\r\nbutton[type="button"] {\r\n    background-color: var(--neutral-dark);\r\n    color: var(--text-light);\r\n    border: 1px solid var(--neutral-border);\r\n}\r\n\r\nbutton[type="button"]:hover {\r\n    background-color: #555;\r\n}\r\n\r\n#case-details {\r\n    padding: 18px;\r\n    border: 1px solid var(--accent);\r\n    border-radius: var(--radius);\r\n    background-color: var(--bg-form);\r\n}\r\n\r\ninput[type="file"] {\r\n    padding: 6px;\r\n}\r\n\r\n.modal {\r\n    position: fixed;\r\n    top: 0; left: 0; width: 100%; height: 100%;\r\n    background-color: rgba(0, 0, 0, 0.6);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    z-index: 1000;\r\n}\r\n\r\n.modal.hidden {\r\n    display: none;\r\n}\r\n\r\n.modal-content {\r\n    background-color: #fff;\r\n    padding: 24px;\r\n    border-radius: var(--radius);\r\n    text-align: center;\r\n    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);\r\n    color: #000;\r\n    min-width: 280px;\r\n}\r\n\r\n#error-ok-button {\r\n    margin-top: 16px;\r\n    padding: 10px 20px;\r\n    background-color: var(--accent);\r\n    color: white;\r\n    border: none;\r\n    border-radius: var(--radius);\r\n    cursor: pointer;\r\n}\r\n\r\n#error-ok-button:hover {\r\n    background-color: var(--accent-hover);\r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .page {\r\n        margin: 12px;\r\n        padding: 16px;\r\n    }\r\n\r\n    h1 {\r\n        font-size: 18px;\r\n    }\r\n\r\n    button {\r\n        font-size: 12px;\r\n    }\r\n}\r\n\r\n/* Focus-visible styles for keyboard nav */\r\ninput:focus-visible,\r\nselect:focus-visible,\r\ntextarea:focus-visible,\r\nbutton:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Add to all transitions */\r\ninput,\r\nselect,\r\ntextarea,\r\nbutton {\r\n    transition: background-color var(--transition), border-color var(--transition), transform var(--transition), box-shadow var(--transition);\r\n}\r\n\r\n/* Button active press down effect */\r\nbutton:active {\r\n    transform: scale(0.98);\r\n}'],sourceRoot:""}]),t.A=a},31317:function(e,t,r){"use strict";var n=r(94758);function o(e){this.data=new Uint8Array(e),this.index=0}o.prototype={append:function(e){0!==e.length&&(e=n.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},e.exports=o},31751:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=r(62946),u=l.getUnclosedTagException,d=l.getUnopenedTagException,h=l.getDuplicateOpenTagException,p=l.getDuplicateCloseTagException,f=l.throwMalformedXml,m=l.throwXmlInvalid,g=l.XTTemplateError,y=r(62559),v=y.isTextStart,w=y.isTextEnd,b=y.wordToUtf8;function A(e,t){return e[0]<=t.offset&&t.offset<e[1]}function E(e,t){return v(e)?(t&&f(),!0):w(e)?(t||f(),!1):t}function C(e){var t="",r=1,n=e.indexOf(" ");return"/"===e[e.length-2]?(t="selfclosing",-1===n&&(n=e.length-2)):"/"===e[1]?(r=2,t="end",-1===n&&(n=e.length-1)):(t="start",-1===n&&(n=e.length-1)),{tag:e.slice(r,n),position:t}}function T(e,t){return-1===e&&-1===t?0:e===t?1:-1===e||-1===t?t<e?2:3:e<t?2:3}function x(e){var t=e.split(" ");if(2!==t.length){var r=new g("New Delimiters cannot be parsed");throw r.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},r}var n=o(t,2),i=n[0],a=n[1];if(0===i.length||0===a.length){var s=new g("New Delimiters cannot be parsed");throw s.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},s}return[i,a]}function k(e,t,r){var n=e.map((function(e){return e.value})).join(""),i=function(e,t,r){var n=[],i=t.start,a=t.end,s=-1,c=!1;if(null==i&&null==a)return[];for(;;){var l=e.indexOf(i,s+1),u=e.indexOf(a,s+1),d=null,h=void 0,p=T(l,u);switch(1===p&&(p=c?3:2),p){case 0:return n;case 3:c=!1,s=u,d="end",h=a.length;break;case 2:c=!0,s=l,d="start",h=i.length}if(r.changeDelimiterPrefix&&2===p&&e[s+i.length]===r.changeDelimiterPrefix){n.push({offset:l,position:"start",length:i.length,changedelimiter:!0});var f=e.indexOf(r.changeDelimiterPrefix,s+i.length+1),m=e.indexOf(a,f+1);n.push({offset:m,position:"end",length:a.length,changedelimiter:!0});var g=o(x(e.substr(s+i.length+1,f-s-i.length-1)),2);i=g[0],a=g[1],s=m}else n.push({offset:s,position:d,length:h})}}(n,t,r),a=0,c=e.map((function(e){return{offset:(a+=e.value.length)-e.value.length,lIndex:e.lIndex}})),l=function(e,t,r){var n,o=[],i=!1,a={offset:0},c=e.reduce((function(e,c){var l=c.position,f=c.offset,m=a.offset,g=a.length;if(n=t.substr(m,f-m),i&&"start"===l){if(m+g===f&&(n=t.substr(m,f-m+g+4),!r.allowUnclosedTag))return o.push(h({xtag:n,offset:m})),a=c,e.push(s(s({},c),{},{error:!0})),e;if(!r.allowUnclosedTag)return o.push(u({xtag:b(n),offset:m})),a=c,e.push(s(s({},c),{},{error:!0})),e;e.pop()}return i||"end"!==l?(i="start"===l,a=c,e.push(c),e):r.allowUnopenedTag?e:m+g===f?(n=t.substr(m-4,f-m+g+4),o.push(p({xtag:n,offset:m})),a=c,e.push(s(s({},c),{},{error:!0})),e):(o.push(d({xtag:n,offset:f})),a=c,e.push(s(s({},c),{},{error:!0})),e)}),[]);if(i){var l=a.offset;n=t.substr(l,t.length-l),r.allowUnclosedTag?c.pop():o.push(u({xtag:b(n),offset:l}))}return{delimiterWithErrors:c,errors:o}}(i,n,r),f=l.delimiterWithErrors,m=l.errors,g=0,y=0,v=c.map((function(t,r){for(var n=t.offset,o=[n,n+e[r].value.length],i=e[r].value,a=[];y<f.length&&A(o,f[y]);)a.push(f[y]),y++;var s=[],c=0;g>0&&(c=g,g=0);for(var l=0;l<a.length;l++){var u=a[l],d=i.substr(c,u.offset-n-c);if(u.changedelimiter)"start"===u.position?d.length>0&&s.push({type:"content",value:d}):c=u.offset-n+u.length;else{d.length>0&&(s.push({type:"content",value:d}),c+=d.length);var h={type:"delimiter",position:u.position,offset:c+n};s.push(h),c=u.offset-n+u.length}}g=c-i.length;var p=i.substr(c);return p.length>0&&s.push({type:"content",value:p}),s}),this);return{parsed:v,errors:m}}function I(e){return"content"===e.type&&"insidetag"===e.position}e.exports={parseDelimiters:k,parse:function(e,t,r,n){!function(e,t){for(var r=!1,n=0;n<e.length;n++){var o=e[n];r=E(o,r),"content"===o.type&&(o.position=r?"insidetag":"outsidetag"),"text"!==t&&I(o)&&(o.value=o.value.replace(/>/g,"&gt;"))}}(e,n);for(var o=k(e.filter(I),t,r),i=o.parsed,a=o.errors,s=[],c=0,l=0,u=0;u<e.length;u++){var d=e[u];if(I(d)){for(var h=0,p=i[c];h<p.length;h++){var f=p[h];"content"===f.type&&(f.position="insidetag"),f.lIndex=l++}Array.prototype.push.apply(s,i[c]),c++}else d.lIndex=l++,s.push(d)}return{errors:a,lexed:s}},xmlparse:function(e,t){var r=function(e,t,r){for(var n=0,o=e.length,i={},a=0;a<t.length;a++)i[t[a]]=!0;for(var s=0;s<r.length;s++)i[r[s]]=!1;for(var c=[];n<o&&-1!==(n=e.indexOf("<",n));){var l=n,u=e.indexOf("<",n+1);(-1===(n=e.indexOf(">",n))||-1!==u&&n>u)&&m(e,l);var d=e.slice(l,n+1),h=C(d),p=h.tag,f=h.position,g=i[p];null!=g&&c.push({type:"tag",position:f,text:g,offset:l,value:d,tag:p})}return c}(e,t.text,t.other),n=0,o=r.reduce((function(t,r){return e.length>n&&r.offset-n>0&&t.push({type:"content",value:e.substr(n,r.offset-n)}),n=r.offset+r.value.length,delete r.offset,t.push(r),t}),[]);return e.length>n&&o.push({type:"content",value:e.substr(n)}),o}}},35872:function(e,t,r){"use strict";t.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},t.DEFLATE=r(80777)},38435:function(e,t,r){"use strict";var n=r(95108),o=r(85668),i=r(94758),a=r(97950);e.exports=function(e,t){var r,s;(t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode})).base64&&(e=n.decode(e));var c=new a(e,t),l=c.files;for(r=0;r<l.length;r++)s=l[r],this.file(s.fileNameStr,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders});return c.zipComment.length&&(this.comment=c.zipComment),this}},38450:function(e,t,r){"use strict";var n=r(62566),o=n.find,i=n.hasDefaultHTMLNamespace,a=n.hasOwn,s=n.isHTMLMimeType,c=n.isHTMLRawTextElement,l=n.isHTMLVoidElement,u=n.MIME_TYPE,d=n.NAMESPACE,h=Symbol(),p=r(97191),f=p.DOMException,m=p.DOMExceptionName,g=r(58491);function y(e){if(e!==h)throw new TypeError("Illegal constructor")}function v(e){return""!==e}function w(e,t){return a(e,t)||(e[t]=!0),e}function b(e){if(!e)return[];var t=function(e){return e?e.split(/[\t\n\f\r ]+/).filter(v):[]}(e);return Object.keys(t.reduce(w,{}))}function A(e){if(!g.QName_exact.test(e))throw new f(f.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+e+'"')}function E(e,t){A(t),e=e||null;var r=null,o=t;if(t.indexOf(":")>=0){var i=t.split(":");r=i[0],o=i[1]}if(null!==r&&null===e)throw new f(f.NAMESPACE_ERR,"prefix is non-null and namespace is null");if("xml"===r&&e!==n.NAMESPACE.XML)throw new f(f.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if(("xmlns"===r||"xmlns"===t)&&e!==n.NAMESPACE.XMLNS)throw new f(f.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(e===n.NAMESPACE.XMLNS&&"xmlns"!==r&&"xmlns"!==t)throw new f(f.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[e,r,o]}function C(e,t){for(var r in e)a(e,r)&&(t[r]=e[r])}function T(e,t){var r=e.prototype;if(!(r instanceof t)){function n(){}n.prototype=t.prototype,C(r,n=new n),e.prototype=r=n}r.constructor!=e&&("function"!=typeof e&&console.error("unknown Class:"+e),r.constructor=e)}var x={},k=x.ELEMENT_NODE=1,I=x.ATTRIBUTE_NODE=2,_=x.TEXT_NODE=3,S=x.CDATA_SECTION_NODE=4,L=x.ENTITY_REFERENCE_NODE=5,N=x.ENTITY_NODE=6,P=x.PROCESSING_INSTRUCTION_NODE=7,O=x.COMMENT_NODE=8,R=x.DOCUMENT_NODE=9,M=x.DOCUMENT_TYPE_NODE=10,D=x.DOCUMENT_FRAGMENT_NODE=11,U=x.NOTATION_NODE=12,q=n.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function B(e,t){if(t.length<e.length)return B(t,e);var r=null;for(var n in e){if(e[n]!==t[n])return r;r=e[n]}return r}function H(e){return e.guid||(e.guid=Math.random()),e.guid}function F(){}function z(e,t){this._node=e,this._refresh=t,j(this)}function j(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var r=e._refresh(e._node);if(_e(e,"length",r.length),!e.$$length||r.length<e.$$length)for(var n=r.length;n in e;n++)a(e,n)&&delete e[n];C(r,e),e._inc=t}}function G(){}function W(e,t){for(var r=0;r<e.length;){if(e[r]===t)return r;r++}}function K(e,t,r){var n=W(t,r);if(n>=0){for(var o=t.length-1;n<=o;)t[n]=t[++n];if(t.length=o,e){var i=e.ownerDocument;i&&Z(i,e,r),r.ownerElement=null}}}function $(){}function V(e){y(e)}function Y(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function Q(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(Q(e,t))return!0}while(e=e.nextSibling)}function X(e,t){y(e);var r=t||{};this.ownerDocument=this,this.contentType=r.contentType||u.XML_APPLICATION,this.type=s(this.contentType)?"html":"xml"}function Z(e,t,r,n){e&&e._inc++,r.namespaceURI===d.XMLNS&&delete t._nsMap[r.prefix?r.localName:""]}function J(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r&&!r.nextSibling)n[n.length++]=r;else{for(var o=t.firstChild,i=0;o;)n[i++]=o,o=o.nextSibling;n.length=i,delete n[n.length]}}}function ee(e,t){if(e!==t.parentNode)throw new f(f.NOT_FOUND_ERR,"child's parent is not parent");var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,J(e.ownerDocument,e),t.parentNode=null,t.previousSibling=null,t.nextSibling=null,t}function te(e){return e&&e.nodeType===V.DOCUMENT_TYPE_NODE}function re(e){return e&&e.nodeType===V.ELEMENT_NODE}function ne(e){return e&&e.nodeType===V.TEXT_NODE}function oe(e,t){var r=e.childNodes||[];if(o(r,re)||te(t))return!1;var n=o(r,te);return!(t&&n&&r.indexOf(n)>r.indexOf(t))}function ie(e,t){var r=e.childNodes||[];if(o(r,(function(e){return re(e)&&e!==t})))return!1;var n=o(r,te);return!(t&&n&&r.indexOf(n)>r.indexOf(t))}function ae(e,t,r){var n=e.childNodes||[],i=t.childNodes||[];if(t.nodeType===V.DOCUMENT_FRAGMENT_NODE){var a=i.filter(re);if(a.length>1||o(i,ne))throw new f(f.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(1===a.length&&!oe(e,r))throw new f(f.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(re(t)&&!oe(e,r))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(te(t)){if(o(n,te))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var s=o(n,re);if(r&&n.indexOf(s)<n.indexOf(r))throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!r&&s)throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function se(e,t,r){var n=e.childNodes||[],i=t.childNodes||[];if(t.nodeType===V.DOCUMENT_FRAGMENT_NODE){var a=i.filter(re);if(a.length>1||o(i,ne))throw new f(f.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(1===a.length&&!ie(e,r))throw new f(f.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(re(t)&&!ie(e,r))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(te(t)){function c(e){return te(e)&&e!==r}if(o(n,c))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var s=o(n,re);if(r&&n.indexOf(s)<n.indexOf(r))throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function ce(e,t,r,n){(function(e,t,r){if(!function(e){return e&&(e.nodeType===V.DOCUMENT_NODE||e.nodeType===V.DOCUMENT_FRAGMENT_NODE||e.nodeType===V.ELEMENT_NODE)}(e))throw new f(f.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+e.nodeType);if(r&&r.parentNode!==e)throw new f(f.NOT_FOUND_ERR,"child not in parent");if(!function(e){return e&&(e.nodeType===V.CDATA_SECTION_NODE||e.nodeType===V.COMMENT_NODE||e.nodeType===V.DOCUMENT_FRAGMENT_NODE||e.nodeType===V.DOCUMENT_TYPE_NODE||e.nodeType===V.ELEMENT_NODE||e.nodeType===V.PROCESSING_INSTRUCTION_NODE||e.nodeType===V.TEXT_NODE)}(t)||te(t)&&e.nodeType!==V.DOCUMENT_NODE)throw new f(f.HIERARCHY_REQUEST_ERR,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)})(e,t,r),e.nodeType===V.DOCUMENT_NODE&&(n||ae)(e,t,r);var o=t.parentNode;if(o&&o.removeChild(t),t.nodeType===D){var i=t.firstChild;if(null==i)return t;var a=t.lastChild}else i=a=t;var s=r?r.previousSibling:e.lastChild;i.previousSibling=s,a.nextSibling=r,s?s.nextSibling=i:e.firstChild=i,null==r?e.lastChild=a:r.previousSibling=a;do{i.parentNode=e}while(i!==a&&(i=i.nextSibling));return J(e.ownerDocument||e,e,t),t.nodeType==D&&(t.firstChild=t.lastChild=null),t}function le(e){y(e),this._nsMap=Object.create(null)}function ue(e){y(e),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}function de(e){y(e)}function he(e){y(e)}function pe(e){y(e)}function fe(e){y(e)}function me(e){y(e)}function ge(e){y(e)}function ye(e){y(e)}function ve(e){y(e)}function we(e){y(e)}function be(e){y(e)}function Ae(){}function Ee(e){var t=[],r=this.nodeType===R&&this.documentElement||this,n=r.prefix,o=r.namespaceURI;if(o&&null==n&&null==(n=r.lookupPrefix(o)))var i=[{namespace:o,prefix:null}];return xe(this,t,e,i),t.join("")}function Ce(e,t,r){var n=e.prefix||"",o=e.namespaceURI;if(!o)return!1;if("xml"===n&&o===d.XML||o===d.XMLNS)return!1;for(var i=r.length;i--;){var a=r[i];if(a.prefix===n)return a.namespace!==o}return!0}function Te(e,t,r){e.push(" ",t,'="',r.replace(/[<>&"\t\n\r]/g,Y),'"')}function xe(e,t,r,n){n||(n=[]);var o="html"===(e.nodeType===R?e:e.ownerDocument).type;if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case k:var i=e.attributes,a=i.length,s=e.firstChild,u=e.tagName,h=u;if(!o&&!e.prefix&&e.namespaceURI){for(var p,f=0;f<i.length;f++)if("xmlns"===i.item(f).name){p=i.item(f).value;break}if(!p)for(var m=n.length-1;m>=0;m--)if(""===(y=n[m]).prefix&&y.namespace===e.namespaceURI){p=y.namespace;break}if(p!==e.namespaceURI)for(m=n.length-1;m>=0;m--){var y;if((y=n[m]).namespace===e.namespaceURI){y.prefix&&(h=y.prefix+":"+u);break}}}t.push("<",h);for(var v=0;v<a;v++)"xmlns"==(w=i.item(v)).prefix?n.push({prefix:w.localName,namespace:w.value}):"xmlns"==w.nodeName&&n.push({prefix:"",namespace:w.value});for(v=0;v<a;v++){var w,b,A;Ce(w=i.item(v),0,n)&&(Te(t,(b=w.prefix||"")?"xmlns:"+b:"xmlns",A=w.namespaceURI),n.push({prefix:b,namespace:A})),xe(w,t,r,n)}u===h&&Ce(e,0,n)&&(Te(t,(b=e.prefix||"")?"xmlns:"+b:"xmlns",A=e.namespaceURI),n.push({prefix:b,namespace:A}));var E=!s;if(E&&(o||e.namespaceURI===d.HTML)&&(E=l(u)),E)t.push("/>");else{if(t.push(">"),o&&c(u))for(;s;)s.data?t.push(s.data):xe(s,t,r,n.slice()),s=s.nextSibling;else for(;s;)xe(s,t,r,n.slice()),s=s.nextSibling;t.push("</",h,">")}return;case R:case D:for(s=e.firstChild;s;)xe(s,t,r,n.slice()),s=s.nextSibling;return;case I:return Te(t,e.name,e.value);case _:return t.push(e.data.replace(/[<&>]/g,Y));case S:return t.push(g.CDATA_START,e.data,g.CDATA_END);case O:return t.push(g.COMMENT_START,e.data,g.COMMENT_END);case M:var C=e.publicId,T=e.systemId;return t.push(g.DOCTYPE_DECL_START," ",e.name),C?(t.push(" ",g.PUBLIC," ",C),T&&"."!==T&&t.push(" ",T)):T&&"."!==T&&t.push(" ",g.SYSTEM," ",T),e.internalSubset&&t.push(" [",e.internalSubset,"]"),void t.push(">");case P:return t.push("<?",e.target," ",e.data,"?>");case L:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ke(e,t,r){var n;switch(t.nodeType){case k:(n=t.cloneNode(!1)).ownerDocument=e;case D:break;case I:r=!0}if(n||(n=t.cloneNode(!1)),n.ownerDocument=e,n.parentNode=null,r)for(var o=t.firstChild;o;)n.appendChild(ke(e,o,r)),o=o.nextSibling;return n}function Ie(e,t,r){var n=new t.constructor(h);for(var o in t)if(a(t,o)){var i=t[o];"object"!=typeof i&&i!=n[o]&&(n[o]=i)}switch(t.childNodes&&(n.childNodes=new F),n.ownerDocument=e,n.nodeType){case k:var s=t.attributes,c=n.attributes=new G,l=s.length;c._ownerElement=n;for(var u=0;u<l;u++)n.setAttributeNode(Ie(e,s.item(u),!0));break;case I:r=!0}if(r)for(var d=t.firstChild;d;)n.appendChild(Ie(e,d,r)),d=d.nextSibling;return n}function _e(e,t,r){e[t]=r}F.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e){for(var t=[],r=0;r<this.length;r++)xe(this[r],t,e);return t.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},F.prototype[Symbol.iterator]=function(){var e=this,t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0}},return:function(){return{done:!0}}}},z.prototype.item=function(e){return j(this),this[e]||null},T(z,F),G.prototype={length:0,item:F.prototype.item,getNamedItem:function(e){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase());for(var t=0;t<this.length;){var r=this[t];if(r.nodeName===e)return r;t++}return null},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!==this._ownerElement)throw new f(f.INUSE_ATTRIBUTE_ERR);var r=this.getNamedItemNS(e.namespaceURI,e.localName);return r===e?e:(function(e,t,r,n){if(n?t[W(t,n)]=r:(t[t.length]=r,t.length++),e){r.ownerElement=e;var o=e.ownerDocument;o&&(n&&Z(o,e,n),function(e,t,r){e&&e._inc++,r.namespaceURI===d.XMLNS&&(t._nsMap[r.prefix?r.localName:""]=r.value)}(o,e,r))}}(this._ownerElement,this,e,r),r)},setNamedItemNS:function(e){return this.setNamedItem(e)},removeNamedItem:function(e){var t=this.getNamedItem(e);if(!t)throw new f(f.NOT_FOUND_ERR,e);return K(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);if(!r)throw new f(f.NOT_FOUND_ERR,e?e+" : "+t:t);return K(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){e||(e=null);for(var r=0;r<this.length;){var n=this[r];if(n.localName===t&&n.namespaceURI===e)return n;r++}return null}},G.prototype[Symbol.iterator]=function(){var e=this,t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0}},return:function(){return{done:!0}}}},$.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,r){var n=u.XML_APPLICATION;e===d.HTML?n=u.XML_XHTML_APPLICATION:e===d.SVG&&(n=u.XML_SVG_IMAGE);var o=new X(h,{contentType:n});if(o.implementation=this,o.childNodes=new F,o.doctype=r||null,r&&o.appendChild(r),t){var i=o.createElementNS(e,t);o.appendChild(i)}return o},createDocumentType:function(e,t,r,n){A(e);var o=new me(h);return o.name=e,o.nodeName=e,o.publicId=t||"",o.systemId=r||"",o.internalSubset=n||"",o.childNodes=new F,o},createHTMLDocument:function(e){var t=new X(h,{contentType:u.HTML});if(t.implementation=this,t.childNodes=new F,!1!==e){t.doctype=this.createDocumentType("html"),t.doctype.ownerDocument=t,t.appendChild(t.doctype);var r=t.createElement("html");t.appendChild(r);var n=t.createElement("head");if(r.appendChild(n),"string"==typeof e){var o=t.createElement("title");o.appendChild(t.createTextNode(e)),n.appendChild(o)}r.appendChild(t.createElement("body"))}return t}},V.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var e=this.getRootNode();return e&&e.nodeType===e.DOCUMENT_NODE},contains:function(e){if(!e)return!1;var t=e;do{if(this===t)return!0;t=e.parentNode}while(t);return!1},getRootNode:function(e){var t=this;do{if(!t.parentNode)return t;t=t.parentNode}while(t)},isEqualNode:function(e){if(!e)return!1;if(this.nodeType!==e.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==e.name)return!1;if(this.publicId!==e.publicId)return!1;if(this.systemId!==e.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==e.namespaceURI)return!1;if(this.prefix!==e.prefix)return!1;if(this.localName!==e.localName)return!1;if(this.attributes.length!==e.attributes.length)return!1;for(var t=0;t<this.attributes.length;t++){var r=this.attributes.item(t);if(!r.isEqualNode(e.getAttributeNodeNS(r.namespaceURI,r.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==e.namespaceURI)return!1;if(this.localName!==e.localName)return!1;if(this.value!==e.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==e.target||this.data!==e.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==e.data)return!1}if(this.childNodes.length!==e.childNodes.length)return!1;for(t=0;t<this.childNodes.length;t++)if(!this.childNodes[t].isEqualNode(e.childNodes[t]))return!1;return!0},isSameNode:function(e){return this===e},insertBefore:function(e,t){return ce(this,e,t)},replaceChild:function(e,t){ce(this,e,t,se),t&&this.removeChild(t)},removeChild:function(e){return ee(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return Ie(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==_&&e.nodeType==_?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var n in r)if(a(r,n)&&r[n]===e)return n;t=t.nodeType==I?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&a(r,e))return r[e];t=t.nodeType==I?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)},compareDocumentPosition:function(e){if(this===e)return 0;var t=e,r=this,n=null,o=null;if(t instanceof ue&&(t=(n=t).ownerElement),r instanceof ue&&(r=(o=r).ownerElement,n&&t&&r===t))for(var i,a=0;i=r.attributes[a];a++){if(i===n)return q.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+q.DOCUMENT_POSITION_PRECEDING;if(i===o)return q.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+q.DOCUMENT_POSITION_FOLLOWING}if(!t||!r||r.ownerDocument!==t.ownerDocument)return q.DOCUMENT_POSITION_DISCONNECTED+q.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(H(r.ownerDocument)>H(t.ownerDocument)?q.DOCUMENT_POSITION_FOLLOWING:q.DOCUMENT_POSITION_PRECEDING);if(o&&t===r)return q.DOCUMENT_POSITION_CONTAINS+q.DOCUMENT_POSITION_PRECEDING;if(n&&t===r)return q.DOCUMENT_POSITION_CONTAINED_BY+q.DOCUMENT_POSITION_FOLLOWING;for(var s=[],c=t.parentNode;c;){if(!o&&c===r)return q.DOCUMENT_POSITION_CONTAINED_BY+q.DOCUMENT_POSITION_FOLLOWING;s.push(c),c=c.parentNode}s.reverse();for(var l=[],u=r.parentNode;u;){if(!n&&u===t)return q.DOCUMENT_POSITION_CONTAINS+q.DOCUMENT_POSITION_PRECEDING;l.push(u),u=u.parentNode}l.reverse();var d=B(s,l);for(var h in d.childNodes){var p=d.childNodes[h];if(p===r)return q.DOCUMENT_POSITION_FOLLOWING;if(p===t)return q.DOCUMENT_POSITION_PRECEDING;if(l.indexOf(p)>=0)return q.DOCUMENT_POSITION_FOLLOWING;if(s.indexOf(p)>=0)return q.DOCUMENT_POSITION_PRECEDING}return 0}},C(x,V),C(x,V.prototype),C(q,V),C(q,V.prototype),X.prototype={implementation:null,nodeName:"#document",nodeType:R,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType===D){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return ce(this,e,t),e.ownerDocument=this,null===this.documentElement&&e.nodeType===k&&(this.documentElement=e),e},removeChild:function(e){var t=ee(this,e);return t===this.documentElement&&(this.documentElement=null),t},replaceChild:function(e,t){ce(this,e,t,se),e.ownerDocument=this,t&&this.removeChild(t),re(e)&&(this.documentElement=e)},importNode:function(e,t){return ke(this,e,t)},getElementById:function(e){var t=null;return Q(this.documentElement,(function(r){if(r.nodeType==k&&r.getAttribute("id")==e)return t=r,!0})),t},createElement:function(e){var t=new le(h);return t.ownerDocument=this,"html"===this.type&&(e=e.toLowerCase()),i(this.contentType)&&(t.namespaceURI=d.HTML),t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new F,(t.attributes=new G)._ownerElement=t,t},createDocumentFragment:function(){var e=new we(h);return e.ownerDocument=this,e.childNodes=new F,e},createTextNode:function(e){var t=new he(h);return t.ownerDocument=this,t.childNodes=new F,t.appendData(e),t},createComment:function(e){var t=new pe(h);return t.ownerDocument=this,t.childNodes=new F,t.appendData(e),t},createCDATASection:function(e){var t=new fe(h);return t.ownerDocument=this,t.childNodes=new F,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new be(h);return r.ownerDocument=this,r.childNodes=new F,r.nodeName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){if(!g.QName_exact.test(e))throw new f(f.INVALID_CHARACTER_ERR,'invalid character in name "'+e+'"');return"html"===this.type&&(e=e.toLowerCase()),this._createAttribute(e)},_createAttribute:function(e){var t=new ue(h);return t.ownerDocument=this,t.childNodes=new F,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){if(!g.Name.test(e))throw new f(f.INVALID_CHARACTER_ERR,'not a valid xml name "'+e+'"');if("html"===this.type)throw new f("document is an html document",m.NotSupportedError);var t=new ve(h);return t.ownerDocument=this,t.childNodes=new F,t.nodeName=e,t},createElementNS:function(e,t){var r=E(e,t),n=new le(h),o=n.attributes=new G;return n.childNodes=new F,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],o._ownerElement=n,n},createAttributeNS:function(e,t){var r=E(e,t),n=new ue(h);return n.ownerDocument=this,n.childNodes=new F,n.nodeName=t,n.name=t,n.specified=!0,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],n}},T(X,V),le.prototype={nodeType:k,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return"html"===this.ownerDocument.type&&this.namespaceURI===d.HTML},hasAttributes:function(){return!(!this.attributes||!this.attributes.length)},hasAttribute:function(e){return!!this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t?t.value:null},getAttributeNode:function(e){return this._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase()),this.attributes.getNamedItem(e)},setAttribute:function(e,t){this._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase());var r=this.getAttributeNode(e);r?r.value=r.nodeValue=""+t:((r=this.ownerDocument._createAttribute(e)).value=r.nodeValue=""+t,this.setAttributeNode(r))},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r?r.value:null},setAttributeNS:function(e,t,r){var n=E(e,t)[2],o=this.getAttributeNodeNS(e,n);o?o.value=o.nodeValue=""+r:((o=this.ownerDocument.createAttributeNS(e,t)).value=o.nodeValue=""+r,this.setAttributeNode(o))},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByClassName:function(e){var t=b(e);return new z(this,(function(r){var n=[];return t.length>0&&Q(r,(function(o){if(o!==r&&o.nodeType===k){var i=o.getAttribute("class");if(i){var a=e===i;if(!a){var s=b(i);a=t.every((c=s,function(e){return c&&-1!==c.indexOf(e)}))}a&&n.push(o)}}var c})),n}))},getElementsByTagName:function(e){var t="html"===(this.nodeType===R?this:this.ownerDocument).type,r=e.toLowerCase();return new z(this,(function(n){var o=[];return Q(n,(function(i){i!==n&&i.nodeType===k&&("*"===e||i.getQualifiedName()===(t&&i.namespaceURI===d.HTML?r:e))&&o.push(i)})),o}))},getElementsByTagNameNS:function(e,t){return new z(this,(function(r){var n=[];return Q(r,(function(o){o===r||o.nodeType!==k||"*"!==e&&o.namespaceURI!==e||"*"!==t&&o.localName!=t||n.push(o)})),n}))}},X.prototype.getElementsByClassName=le.prototype.getElementsByClassName,X.prototype.getElementsByTagName=le.prototype.getElementsByTagName,X.prototype.getElementsByTagNameNS=le.prototype.getElementsByTagNameNS,T(le,V),ue.prototype.nodeType=I,T(ue,V),de.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){r=this.data.substring(0,e)+r+this.data.substring(e+t),this.nodeValue=this.data=r,this.length=r.length}},T(de,V),he.prototype={nodeName:"#text",nodeType:_,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},T(he,de),pe.prototype={nodeName:"#comment",nodeType:O},T(pe,de),fe.prototype={nodeName:"#cdata-section",nodeType:S},T(fe,he),me.prototype.nodeType=M,T(me,V),ge.prototype.nodeType=U,T(ge,V),ye.prototype.nodeType=N,T(ye,V),ve.prototype.nodeType=L,T(ve,V),we.prototype.nodeName="#document-fragment",we.prototype.nodeType=D,T(we,V),be.prototype.nodeType=P,T(be,de),Ae.prototype.serializeToString=function(e,t){return Ee.call(e,t)},V.prototype.toString=Ee;try{if(Object.defineProperty){function Se(e){switch(e.nodeType){case k:case D:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(Se(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}Object.defineProperty(z.prototype,"length",{get:function(){return j(this),this.$$length}}),Object.defineProperty(V.prototype,"textContent",{get:function(){return Se(this)},set:function(e){switch(this.nodeType){case k:case D:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),_e=function(e,t,r){e["$$"+t]=r}}}catch(Le){}t._updateLiveList=j,t.Attr=ue,t.CDATASection=fe,t.CharacterData=de,t.Comment=pe,t.Document=X,t.DocumentFragment=we,t.DocumentType=me,t.DOMImplementation=$,t.Element=le,t.Entity=ye,t.EntityReference=ve,t.LiveNodeList=z,t.NamedNodeMap=G,t.Node=V,t.NodeList=F,t.Notation=ge,t.Text=he,t.ProcessingInstruction=be,t.XMLSerializer=Ae},40277:function(e,t){"use strict";t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\b"},41113:function(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},45426:function(e,t,r){"use strict";var n=r(62566);t.assign=n.assign,t.hasDefaultHTMLNamespace=n.hasDefaultHTMLNamespace,t.isHTMLMimeType=n.isHTMLMimeType,t.isValidMimeType=n.isValidMimeType,t.MIME_TYPE=n.MIME_TYPE,t.NAMESPACE=n.NAMESPACE;var o=r(97191);t.DOMException=o.DOMException,t.DOMExceptionName=o.DOMExceptionName,t.ExceptionCode=o.ExceptionCode,t.ParseError=o.ParseError;var i=r(38450);t.Attr=i.Attr,t.CDATASection=i.CDATASection,t.CharacterData=i.CharacterData,t.Comment=i.Comment,t.Document=i.Document,t.DocumentFragment=i.DocumentFragment,t.DocumentType=i.DocumentType,t.DOMImplementation=i.DOMImplementation,t.Element=i.Element,t.Entity=i.Entity,t.EntityReference=i.EntityReference,t.LiveNodeList=i.LiveNodeList,t.NamedNodeMap=i.NamedNodeMap,t.Node=i.Node,t.NodeList=i.NodeList,t.Notation=i.Notation,t.ProcessingInstruction=i.ProcessingInstruction,t.Text=i.Text,t.XMLSerializer=i.XMLSerializer;var a=r(95624);t.DOMParser=a.DOMParser,t.normalizeLineEndings=a.normalizeLineEndings,t.onErrorStopParsing=a.onErrorStopParsing,t.onWarningStopParsing=a.onWarningStopParsing},45859:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var a=r(73323),s=r(62946),c=s.getScopeCompilationError,l=s.getCorruptCharactersException,u=r(62559),d=u.utf8ToWord,h=u.hasCorruptCharacters,p=u.removeCorruptCharacters,f=r(26548),m=f.settingsContentType,g=f.coreContentType,y=f.appContentType,v=f.customContentType,w={docx:"w",pptx:"a"},b=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Render",this.recordRun=!1,this.recordedRun=[]},t=[{key:"optionsTransformer",value:function(e,t){return this.parser=t.parser,this.fileType=t.fileType,e}},{key:"set",value:function(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:"getRenderedMap",value:function(e){var t=this;return Object.keys(this.compiled).reduce((function(e,r){return e[r]={from:r,data:t.data},e}),e)}},{key:"postparse",value:function(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n];if("placeholder"===o.type){var i=o.value;try{t.cachedParsers[o.lIndex]=this.parser(i,{tag:o})}catch(e){r.push(c({tag:i,rootError:e,offset:o.offset}))}}}return{postparsed:e,errors:r}}},{key:"render",value:function(e,t){var r=t.contentType,n=t.scopeManager,o=t.linebreaks,i=t.nullGetter,a=t.fileType,s=t.stripInvalidXMLChars;if(o&&-1!==[m,g,y,v].indexOf(r)&&(o=!1),o&&this.recordRuns(e),"placeholder"===e.type&&!e.module){var c;try{c=n.getValue(e.value,{part:e})}catch(e){return{errors:[e]}}if(null!=c||(c=i(e)),"string"==typeof c)if(s)c=p(c);else if(-1!==["docx","pptx","xlsx"].indexOf(a)&&h(c))return{errors:[l({tag:e.value,value:c,offset:e.offset})]};return"text"===a?{value:c}:{value:o&&"string"==typeof c?this.renderLineBreaks(c):d(c)}}}},{key:"recordRuns",value:function(e){e.tag==="".concat(w[this.fileType],":r")?this.recordedRun=[]:e.tag==="".concat(w[this.fileType],":rPr")?("start"===e.position&&(this.recordRun=!0,this.recordedRun=[e.value]),"end"!==e.position&&"selfclosing"!==e.position||(this.recordedRun.push(e.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(e.value)}},{key:"renderLineBreaks",value:function(e){var t=this,r=w[this.fileType],n="docx"===this.fileType?"<w:r><w:br/></w:r>":"<a:br/>",o=e.split("\n"),i=this.recordedRun.join("");return o.map((function(e){return d(e)})).reduce((function(e,a,s){return e.push(a),s<o.length-1&&e.push("</".concat(r,":t></").concat(r,":r>").concat(n,"<").concat(r,":r>").concat(i,"<").concat(r,":t").concat("docx"===t.fileType?' xml:space="preserve"':"",">")),e}),[])}}],t&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return a(new b)}},47120:function(e,t,r){"use strict";var n=r(62559),o=n.startsWith,i=n.endsWith,a=n.isStarting,s=n.isEnding,c=n.isWhiteSpace,l=r(67770);e.exports=function(e,t){var r=t.fileTypeConfig.tagShouldContain||[],n="",u=-1;-1!==l.docx.indexOf(t.contentType)&&(e=function(e){for(var t="",r=0,n=e.length;r<n;r++){var a=e[r];c(a)||o(a,"<w:bookmarkEnd")||(i(t,"</w:tbl>")&&(o(a,"<w:p")||o(a,"<w:tbl")||o(a,"<w:sectPr")||(a="<w:p/>".concat(a))),t=a,e[r]=a)}return e}(e));for(var d=-1,h=0,p=r.length;h<p;h++)for(var f=r[h],m=f.tag,g=f.shouldContain,y=f.value,v=f.drop,w=f.dropParent,b=0,A=e.length;b<A;b++){var E=e[b];if(u===h){if(s(E,m))if(u=-1,w){for(var C=-1,T=d;T>0;T--)if(a(e[T],w)){C=T;break}for(var x=C;x<=e.length;x++){if(s(e[x],w)){e[x]="";break}e[x]=""}}else{for(var k=d;k<=b;k++)e[k]="";v||(e[b]=n+y+E)}n+=E;for(var I=0,_=g.length;I<_;I++){var S=g[I];if(a(E,S)){u=-1;break}}}-1===u&&a(E,m)&&-1===E.substr(1).indexOf("<")&&("/"===E[E.length-2]?e[b]="":(d=b,u=h,n=E))}return e}},49289:function(e){"use strict";e.exports=function(e,t){return"number"==typeof e?Buffer.alloc(e):Buffer.from(e,t)},e.exports.test=function(e){return Buffer.isBuffer(e)}},49605:function(e,t,r){"use strict";e.exports=r.p+"assets/images/AM-icon.png"},53433:function(e,t,r){"use strict";var n=r(94758);function o(){this.data=[]}o.prototype={append:function(e){e=n.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},e.exports=o},55056:function(e,t,r){"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},55851:function(e,t){!function(e){"use strict";function t(e){for(var t=e.length;--t>=0;)e[t]=0}var r=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),n=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),o=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),i=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=new Array(576);t(a);var s=new Array(60);t(s);var c=new Array(512);t(c);var l=new Array(256);t(l);var u=new Array(29);t(u);var d,h,p,f=new Array(30);function m(e,t,r,n,o){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=o,this.has_stree=e&&e.length}function g(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(f);var y=function(e){return e<256?c[e]:c[256+(e>>>7)]},v=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},w=function(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,v(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},b=function(e,t,r){w(e,r[2*t],r[2*t+1])},A=function(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},E=function(e,t,r){var n,o,i=new Array(16),a=0;for(n=1;n<=15;n++)a=a+r[n-1]<<1,i[n]=a;for(o=0;o<=t;o++){var s=e[2*o+1];0!==s&&(e[2*o]=A(i[s]++,s))}},C=function(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},T=function(e){e.bi_valid>8?v(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},x=function(e,t,r,n){var o=2*t,i=2*r;return e[o]<e[i]||e[o]===e[i]&&n[t]<=n[r]},k=function(e,t,r){for(var n=e.heap[r],o=r<<1;o<=e.heap_len&&(o<e.heap_len&&x(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!x(t,n,e.heap[o],e.depth));)e.heap[r]=e.heap[o],r=o,o<<=1;e.heap[r]=n},I=function(e,t,o){var i,a,s,c,d=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+d++],i+=(255&e.pending_buf[e.sym_buf+d++])<<8,a=e.pending_buf[e.sym_buf+d++],0===i?b(e,a,t):(s=l[a],b(e,s+256+1,t),0!==(c=r[s])&&(a-=u[s],w(e,a,c)),i--,s=y(i),b(e,s,o),0!==(c=n[s])&&(i-=f[s],w(e,i,c)))}while(d<e.sym_next);b(e,256,t)},_=function(e,t){var r,n,o,i=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<c;r++)0!==i[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):i[2*r+1]=0;for(;e.heap_len<2;)i[2*(o=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=a[2*o+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)k(e,i,r);o=c;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],k(e,i,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,i[2*o]=i[2*r]+i[2*n],e.depth[o]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,i[2*r+1]=i[2*n+1]=o,e.heap[1]=o++,k(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,o,i,a,s,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,m=0;for(i=0;i<=15;i++)e.bl_count[i]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(i=c[2*c[2*(n=e.heap[r])+1]+1]+1)>f&&(i=f,m++),c[2*n+1]=i,n>l||(e.bl_count[i]++,a=0,n>=p&&(a=h[n-p]),s=c[2*n],e.opt_len+=s*(i+a),d&&(e.static_len+=s*(u[2*n+1]+a)));if(0!==m){do{for(i=f-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[f]--,m-=2}while(m>0);for(i=f;0!==i;i--)for(n=e.bl_count[i];0!==n;)(o=e.heap[--r])>l||(c[2*o+1]!==i&&(e.opt_len+=(i-c[2*o+1])*c[2*o],c[2*o+1]=i),n--)}}(e,t),E(i,l,e.bl_count)},S=function(e,t,r){var n,o,i=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)o=a,a=t[2*(n+1)+1],++s<c&&o===a||(s<l?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=o,0===a?(c=138,l=3):o===a?(c=6,l=3):(c=7,l=4))},L=function(e,t,r){var n,o,i=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),n=0;n<=r;n++)if(o=a,a=t[2*(n+1)+1],!(++s<c&&o===a)){if(s<l)do{b(e,o,e.bl_tree)}while(0!=--s);else 0!==o?(o!==i&&(b(e,o,e.bl_tree),s--),b(e,16,e.bl_tree),w(e,s-3,2)):s<=10?(b(e,17,e.bl_tree),w(e,s-3,3)):(b(e,18,e.bl_tree),w(e,s-11,7));s=0,i=o,0===a?(c=138,l=3):o===a?(c=6,l=3):(c=7,l=4)}},N=!1,P=function(e,t,r,n){w(e,0+(n?1:0),3),T(e),v(e,r),v(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},O=function(e){N||(function(){var e,t,i,g,y,v=new Array(16);for(i=0,g=0;g<28;g++)for(u[g]=i,e=0;e<1<<r[g];e++)l[i++]=g;for(l[i-1]=g,y=0,g=0;g<16;g++)for(f[g]=y,e=0;e<1<<n[g];e++)c[y++]=g;for(y>>=7;g<30;g++)for(f[g]=y<<7,e=0;e<1<<n[g]-7;e++)c[256+y++]=g;for(t=0;t<=15;t++)v[t]=0;for(e=0;e<=143;)a[2*e+1]=8,e++,v[8]++;for(;e<=255;)a[2*e+1]=9,e++,v[9]++;for(;e<=279;)a[2*e+1]=7,e++,v[7]++;for(;e<=287;)a[2*e+1]=8,e++,v[8]++;for(E(a,287,v),e=0;e<30;e++)s[2*e+1]=5,s[2*e]=A(e,5);d=new m(a,r,257,286,15),h=new m(s,n,0,30,15),p=new m(new Array(0),o,0,19,7)}(),N=!0),e.l_desc=new g(e.dyn_ltree,d),e.d_desc=new g(e.dyn_dtree,h),e.bl_desc=new g(e.bl_tree,p),e.bi_buf=0,e.bi_valid=0,C(e)},R=P,M=function(e,t,r,n){var o,c,l=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),_(e,e.l_desc),_(e,e.d_desc),l=function(e){var t;for(S(e,e.dyn_ltree,e.l_desc.max_code),S(e,e.dyn_dtree,e.d_desc.max_code),_(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*i[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(c=e.static_len+3+7>>>3)<=o&&(o=c)):o=c=r+5,r+4<=o&&-1!==t?P(e,t,r,n):4===e.strategy||c===o?(w(e,2+(n?1:0),3),I(e,a,s)):(w(e,4+(n?1:0),3),function(e,t,r,n){var o;for(w(e,t-257,5),w(e,r-1,5),w(e,n-4,4),o=0;o<n;o++)w(e,e.bl_tree[2*i[o]+1],3);L(e,e.dyn_ltree,t-1),L(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),I(e,e.dyn_ltree,e.dyn_dtree)),C(e),n&&T(e)},D=function(e,t,r){return e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(l[r]+256+1)]++,e.dyn_dtree[2*y(t)]++),e.sym_next===e.sym_end},U=function(e){w(e,2,3),b(e,256,a),function(e){16===e.bi_valid?(v(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)},q=function(e,t,r,n){for(var o=65535&e,i=e>>>16&65535,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{i=i+(o=o+t[n++]|0)|0}while(--a);o%=65521,i%=65521}return o|i<<16},B=new Uint32Array(function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}()),H=function(e,t,r,n){var o=B,i=n+r;e^=-1;for(var a=n;a<i;a++)e=e>>>8^o[255&(e^t[a])];return~e},F={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},z={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},j=O,G=R,W=M,K=D,$=U,V=z.Z_NO_FLUSH,Y=z.Z_PARTIAL_FLUSH,Q=z.Z_FULL_FLUSH,X=z.Z_FINISH,Z=z.Z_BLOCK,J=z.Z_OK,ee=z.Z_STREAM_END,te=z.Z_STREAM_ERROR,re=z.Z_DATA_ERROR,ne=z.Z_BUF_ERROR,oe=z.Z_DEFAULT_COMPRESSION,ie=z.Z_FILTERED,ae=z.Z_HUFFMAN_ONLY,se=z.Z_RLE,ce=z.Z_FIXED,le=z.Z_UNKNOWN,ue=z.Z_DEFLATED,de=258,he=262,pe=42,fe=113,me=666,ge=function(e,t){return e.msg=F[t],t},ye=function(e){return 2*e-(e>4?9:0)},ve=function(e){for(var t=e.length;--t>=0;)e[t]=0},we=function(e){var t,r,n,o=e.w_size;n=t=e.hash_size;do{r=e.head[--n],e.head[n]=r>=o?r-o:0}while(--t);n=t=o;do{r=e.prev[--n],e.prev[n]=r>=o?r-o:0}while(--t)},be=function(e,t,r){return(t<<e.hash_shift^r)&e.hash_mask},Ae=function(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},Ee=function(e,t){W(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Ae(e.strm)},Ce=function(e,t){e.pending_buf[e.pending++]=t},Te=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},xe=function(e,t,r,n){var o=e.avail_in;return o>n&&(o=n),0===o?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),r),1===e.state.wrap?e.adler=q(e.adler,t,o,r):2===e.state.wrap&&(e.adler=H(e.adler,t,o,r)),e.next_in+=o,e.total_in+=o,o)},ke=function(e,t){var r,n,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-he?e.strstart-(e.w_size-he):0,l=e.window,u=e.w_mask,d=e.prev,h=e.strstart+de,p=l[i+a-1],f=l[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(l[(r=t)+a]===f&&l[r+a-1]===p&&l[r]===l[i]&&l[++r]===l[i+1]){i+=2,r++;do{}while(l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&i<h);if(n=de-(h-i),i=h-de,n>a){if(e.match_start=t,a=n,n>=s)break;p=l[i+a-1],f=l[i+a]}}}while((t=d[t&u])>c&&0!=--o);return a<=e.lookahead?a:e.lookahead},Ie=function(e){var t,r,n,o=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-he)&&(e.window.set(e.window.subarray(o,o+o-r),0),e.match_start-=o,e.strstart-=o,e.block_start-=o,e.insert>e.strstart&&(e.insert=e.strstart),we(e),r+=o),0===e.strm.avail_in)break;if(t=xe(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=t,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=be(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=be(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<he&&0!==e.strm.avail_in)},_e=function(e,t){var r,n,o,i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(r=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o)break;if(o=e.strm.avail_out-o,r>(n=e.strstart-e.block_start)+e.strm.avail_in&&(r=n+e.strm.avail_in),r>o&&(r=o),r<i&&(0===r&&t!==X||t===V||r!==n+e.strm.avail_in))break;a=t===X&&r===n+e.strm.avail_in?1:0,G(e,0,0,a),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,Ae(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(xe(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===a);return(s-=e.strm.avail_in)&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==V&&t!==X&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(xe(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,i=(o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o)>e.w_size?e.w_size:o,((n=e.strstart-e.block_start)>=i||(n||t===X)&&t!==V&&0===e.strm.avail_in&&n<=o)&&(r=n>o?o:n,a=t===X&&0===e.strm.avail_in&&r===n?1:0,G(e,e.block_start,r,a),e.block_start+=r,Ae(e.strm)),a?3:1)},Se=function(e,t){for(var r,n;;){if(e.lookahead<he){if(Ie(e),e.lookahead<he&&t===V)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=be(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-he&&(e.match_length=ke(e,r)),e.match_length>=3)if(n=K(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=be(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=be(e,e.ins_h,e.window[e.strstart+1]);else n=K(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Ee(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===X?(Ee(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ee(e,!1),0===e.strm.avail_out)?1:2},Le=function(e,t){for(var r,n,o;;){if(e.lookahead<he){if(Ie(e),e.lookahead<he&&t===V)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=be(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-he&&(e.match_length=ke(e,r),e.match_length<=5&&(e.strategy===ie||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,n=K(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=be(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(Ee(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=K(e,0,e.window[e.strstart-1]))&&Ee(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=K(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===X?(Ee(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ee(e,!1),0===e.strm.avail_out)?1:2};function Ne(e,t,r,n,o){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=o}var Pe=[new Ne(0,0,0,0,_e),new Ne(4,4,8,4,Se),new Ne(4,5,16,8,Se),new Ne(4,6,32,32,Se),new Ne(4,4,16,16,Le),new Ne(8,16,32,32,Le),new Ne(8,16,128,128,Le),new Ne(8,32,128,256,Le),new Ne(32,128,258,1024,Le),new Ne(32,258,258,4096,Le)];function Oe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ue,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ve(this.dyn_ltree),ve(this.dyn_dtree),ve(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ve(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ve(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Re=function(e){if(!e)return 1;var t=e.state;return!t||t.strm!==e||t.status!==pe&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==fe&&t.status!==me?1:0},Me=function(e){if(Re(e))return ge(e,te);e.total_in=e.total_out=0,e.data_type=le;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?pe:fe,e.adler=2===t.wrap?0:1,t.last_flush=-2,j(t),J},De=function(e){var t,r=Me(e);return r===J&&((t=e.state).window_size=2*t.w_size,ve(t.head),t.max_lazy_match=Pe[t.level].max_lazy,t.good_match=Pe[t.level].good_length,t.nice_match=Pe[t.level].nice_length,t.max_chain_length=Pe[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r},Ue=function(e,t,r,n,o,i){if(!e)return te;var a=1;if(t===oe&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),o<1||o>9||r!==ue||n<8||n>15||t<0||t>9||i<0||i>ce||8===n&&1!==a)return ge(e,te);8===n&&(n=9);var s=new Oe;return e.state=s,s.strm=e,s.status=pe,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=i,s.method=r,De(e)},qe=Ue,Be=function(e,t){return Re(e)||2!==e.state.wrap?te:(e.state.gzhead=t,J)},He=function(e,t){if(Re(e)||t>Z||t<0)return e?ge(e,te):te;var r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===me&&t!==X)return ge(e,0===e.avail_out?ne:te);var n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(Ae(e),0===e.avail_out)return r.last_flush=-1,J}else if(0===e.avail_in&&ye(t)<=ye(n)&&t!==X)return ge(e,ne);if(r.status===me&&0!==e.avail_in)return ge(e,ne);if(r.status===pe&&0===r.wrap&&(r.status=fe),r.status===pe){var o=ue+(r.w_bits-8<<4)<<8;if(o|=(r.strategy>=ae||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(o|=32),Te(r,o+=31-o%31),0!==r.strstart&&(Te(r,e.adler>>>16),Te(r,65535&e.adler)),e.adler=1,r.status=fe,Ae(e),0!==r.pending)return r.last_flush=-1,J}if(57===r.status)if(e.adler=0,Ce(r,31),Ce(r,139),Ce(r,8),r.gzhead)Ce(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ce(r,255&r.gzhead.time),Ce(r,r.gzhead.time>>8&255),Ce(r,r.gzhead.time>>16&255),Ce(r,r.gzhead.time>>24&255),Ce(r,9===r.level?2:r.strategy>=ae||r.level<2?4:0),Ce(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Ce(r,255&r.gzhead.extra.length),Ce(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=H(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(Ce(r,0),Ce(r,0),Ce(r,0),Ce(r,0),Ce(r,0),Ce(r,9===r.level?2:r.strategy>=ae||r.level<2?4:0),Ce(r,3),r.status=fe,Ae(e),0!==r.pending)return r.last_flush=-1,J;if(69===r.status){if(r.gzhead.extra){for(var i=r.pending,a=(65535&r.gzhead.extra.length)-r.gzindex;r.pending+a>r.pending_buf_size;){var s=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+s),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>i&&(e.adler=H(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex+=s,Ae(e),0!==r.pending)return r.last_flush=-1,J;i=0,a-=s}var c=new Uint8Array(r.gzhead.extra);r.pending_buf.set(c.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending+=a,r.gzhead.hcrc&&r.pending>i&&(e.adler=H(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){var l,u=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>u&&(e.adler=H(e.adler,r.pending_buf,r.pending-u,u)),Ae(e),0!==r.pending)return r.last_flush=-1,J;u=0}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Ce(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>u&&(e.adler=H(e.adler,r.pending_buf,r.pending-u,u)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){var d,h=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>h&&(e.adler=H(e.adler,r.pending_buf,r.pending-h,h)),Ae(e),0!==r.pending)return r.last_flush=-1,J;h=0}d=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Ce(r,d)}while(0!==d);r.gzhead.hcrc&&r.pending>h&&(e.adler=H(e.adler,r.pending_buf,r.pending-h,h))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Ae(e),0!==r.pending))return r.last_flush=-1,J;Ce(r,255&e.adler),Ce(r,e.adler>>8&255),e.adler=0}if(r.status=fe,Ae(e),0!==r.pending)return r.last_flush=-1,J}if(0!==e.avail_in||0!==r.lookahead||t!==V&&r.status!==me){var p=0===r.level?_e(r,t):r.strategy===ae?function(e,t){for(var r;;){if(0===e.lookahead&&(Ie(e),0===e.lookahead)){if(t===V)return 1;break}if(e.match_length=0,r=K(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Ee(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===X?(Ee(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ee(e,!1),0===e.strm.avail_out)?1:2}(r,t):r.strategy===se?function(e,t){for(var r,n,o,i,a=e.window;;){if(e.lookahead<=de){if(Ie(e),e.lookahead<=de&&t===V)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=a[o=e.strstart-1])===a[++o]&&n===a[++o]&&n===a[++o]){i=e.strstart+de;do{}while(n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&o<i);e.match_length=de-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=K(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=K(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Ee(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===X?(Ee(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ee(e,!1),0===e.strm.avail_out)?1:2}(r,t):Pe[r.level].func(r,t);if(3!==p&&4!==p||(r.status=me),1===p||3===p)return 0===e.avail_out&&(r.last_flush=-1),J;if(2===p&&(t===Y?$(r):t!==Z&&(G(r,0,0,!1),t===Q&&(ve(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Ae(e),0===e.avail_out))return r.last_flush=-1,J}return t!==X?J:r.wrap<=0?ee:(2===r.wrap?(Ce(r,255&e.adler),Ce(r,e.adler>>8&255),Ce(r,e.adler>>16&255),Ce(r,e.adler>>24&255),Ce(r,255&e.total_in),Ce(r,e.total_in>>8&255),Ce(r,e.total_in>>16&255),Ce(r,e.total_in>>24&255)):(Te(r,e.adler>>>16),Te(r,65535&e.adler)),Ae(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?J:ee)},Fe=function(e){if(Re(e))return te;var t=e.state.status;return e.state=null,t===fe?ge(e,re):J},ze=function(e,t){var r=t.length;if(Re(e))return te;var n=e.state,o=n.wrap;if(2===o||1===o&&n.status!==pe||n.lookahead)return te;if(1===o&&(e.adler=q(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===o&&(ve(n.head),n.strstart=0,n.block_start=0,n.insert=0);var i=new Uint8Array(n.w_size);i.set(t.subarray(r-n.w_size,r),0),t=i,r=n.w_size}var a=e.avail_in,s=e.next_in,c=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Ie(n);n.lookahead>=3;){var l=n.strstart,u=n.lookahead-2;do{n.ins_h=be(n,n.ins_h,n.window[l+3-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++}while(--u);n.strstart=l,n.lookahead=2,Ie(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=s,e.input=c,e.avail_in=a,n.wrap=o,J};function je(e){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},je(e)}var Ge=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},We=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==je(r))throw new TypeError(r+"must be non-object");for(var n in r)Ge(r,n)&&(e[n]=r[n])}}return e},Ke=function(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=e[r].length;for(var o=new Uint8Array(t),i=0,a=0,s=e.length;i<s;i++){var c=e[i];o.set(c,a),a+=c.length}return o},$e=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){$e=!1}for(var Ve=new Uint8Array(256),Ye=0;Ye<256;Ye++)Ve[Ye]=Ye>=252?6:Ye>=248?5:Ye>=240?4:Ye>=224?3:Ye>=192?2:1;Ve[254]=Ve[254]=1;var Qe=function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,r,n,o,i,a=e.length,s=0;for(o=0;o<a;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),i=0,o=0;i<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|63&r):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|63&r):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|63&r);return t},Xe=function(e,t){var r,n,o=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var i=new Array(2*o);for(n=0,r=0;r<o;){var a=e[r++];if(a<128)i[n++]=a;else{var s=Ve[a];if(s>4)i[n++]=65533,r+=s-1;else{for(a&=2===s?31:3===s?15:7;s>1&&r<o;)a=a<<6|63&e[r++],s--;s>1?i[n++]=65533:a<65536?i[n++]=a:(a-=65536,i[n++]=55296|a>>10&1023,i[n++]=56320|1023&a)}}}return function(e,t){if(t<65534&&e.subarray&&$e)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}(i,n)},Ze=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Ve[e[r]]>t?r:t},Je=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},et=Object.prototype.toString,tt=z.Z_NO_FLUSH,rt=z.Z_SYNC_FLUSH,nt=z.Z_FULL_FLUSH,ot=z.Z_FINISH,it=z.Z_OK,at=z.Z_STREAM_END,st=z.Z_DEFAULT_COMPRESSION,ct=z.Z_DEFAULT_STRATEGY,lt=z.Z_DEFLATED;function ut(e){this.options=We({level:st,method:lt,chunkSize:16384,windowBits:15,memLevel:8,strategy:ct},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Je,this.strm.avail_out=0;var r=qe(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==it)throw new Error(F[r]);if(t.header&&Be(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?Qe(t.dictionary):"[object ArrayBuffer]"===et.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=ze(this.strm,n))!==it)throw new Error(F[r]);this._dict_set=!0}}function dt(e,t){var r=new ut(t);if(r.push(e,!0),r.err)throw r.msg||F[r.err];return r.result}ut.prototype.push=function(e,t){var r,n,o=this.strm,i=this.options.chunkSize;if(this.ended)return!1;for(n=t===~~t?t:!0===t?ot:tt,"string"==typeof e?o.input=Qe(e):"[object ArrayBuffer]"===et.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;;)if(0===o.avail_out&&(o.output=new Uint8Array(i),o.next_out=0,o.avail_out=i),(n===rt||n===nt)&&o.avail_out<=6)this.onData(o.output.subarray(0,o.next_out)),o.avail_out=0;else{if((r=He(o,n))===at)return o.next_out>0&&this.onData(o.output.subarray(0,o.next_out)),r=Fe(this.strm),this.onEnd(r),this.ended=!0,r===it;if(0!==o.avail_out){if(n>0&&o.next_out>0)this.onData(o.output.subarray(0,o.next_out)),o.avail_out=0;else if(0===o.avail_in)break}else this.onData(o.output)}return!0},ut.prototype.onData=function(e){this.chunks.push(e)},ut.prototype.onEnd=function(e){e===it&&(this.result=Ke(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ht=ut,pt=dt,ft=function(e,t){return(t=t||{}).raw=!0,dt(e,t)},mt=function(e,t){return(t=t||{}).gzip=!0,dt(e,t)},gt=16209,yt=function(e,t){var r,n,o,i,a,s,c,l,u,d,h,p,f,m,g,y,v,w,b,A,E,C,T,x,k=e.state;r=e.next_in,T=e.input,n=r+(e.avail_in-5),o=e.next_out,x=e.output,i=o-(t-e.avail_out),a=o+(e.avail_out-257),s=k.dmax,c=k.wsize,l=k.whave,u=k.wnext,d=k.window,h=k.hold,p=k.bits,f=k.lencode,m=k.distcode,g=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{p<15&&(h+=T[r++]<<p,p+=8,h+=T[r++]<<p,p+=8),v=f[h&g];t:for(;;){if(h>>>=w=v>>>24,p-=w,0==(w=v>>>16&255))x[o++]=65535&v;else{if(!(16&w)){if(!(64&w)){v=f[(65535&v)+(h&(1<<w)-1)];continue t}if(32&w){k.mode=16191;break e}e.msg="invalid literal/length code",k.mode=gt;break e}b=65535&v,(w&=15)&&(p<w&&(h+=T[r++]<<p,p+=8),b+=h&(1<<w)-1,h>>>=w,p-=w),p<15&&(h+=T[r++]<<p,p+=8,h+=T[r++]<<p,p+=8),v=m[h&y];r:for(;;){if(h>>>=w=v>>>24,p-=w,!(16&(w=v>>>16&255))){if(!(64&w)){v=m[(65535&v)+(h&(1<<w)-1)];continue r}e.msg="invalid distance code",k.mode=gt;break e}if(A=65535&v,p<(w&=15)&&(h+=T[r++]<<p,(p+=8)<w&&(h+=T[r++]<<p,p+=8)),(A+=h&(1<<w)-1)>s){e.msg="invalid distance too far back",k.mode=gt;break e}if(h>>>=w,p-=w,A>(w=o-i)){if((w=A-w)>l&&k.sane){e.msg="invalid distance too far back",k.mode=gt;break e}if(E=0,C=d,0===u){if(E+=c-w,w<b){b-=w;do{x[o++]=d[E++]}while(--w);E=o-A,C=x}}else if(u<w){if(E+=c+u-w,(w-=u)<b){b-=w;do{x[o++]=d[E++]}while(--w);if(E=0,u<b){b-=w=u;do{x[o++]=d[E++]}while(--w);E=o-A,C=x}}}else if(E+=u-w,w<b){b-=w;do{x[o++]=d[E++]}while(--w);E=o-A,C=x}for(;b>2;)x[o++]=C[E++],x[o++]=C[E++],x[o++]=C[E++],b-=3;b&&(x[o++]=C[E++],b>1&&(x[o++]=C[E++]))}else{E=o-A;do{x[o++]=x[E++],x[o++]=x[E++],x[o++]=x[E++],b-=3}while(b>2);b&&(x[o++]=x[E++],b>1&&(x[o++]=x[E++]))}break}}break}}while(r<n&&o<a);r-=b=p>>3,h&=(1<<(p-=b<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=o<a?a-o+257:257-(o-a),k.hold=h,k.bits=p},vt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),bt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),At=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Et=function(e,t,r,n,o,i,a,s){var c,l,u,d,h,p,f,m,g,y=s.bits,v=0,w=0,b=0,A=0,E=0,C=0,T=0,x=0,k=0,I=0,_=null,S=new Uint16Array(16),L=new Uint16Array(16),N=null;for(v=0;v<=15;v++)S[v]=0;for(w=0;w<n;w++)S[t[r+w]]++;for(E=y,A=15;A>=1&&0===S[A];A--);if(E>A&&(E=A),0===A)return o[i++]=20971520,o[i++]=20971520,s.bits=1,0;for(b=1;b<A&&0===S[b];b++);for(E<b&&(E=b),x=1,v=1;v<=15;v++)if(x<<=1,(x-=S[v])<0)return-1;if(x>0&&(0===e||1!==A))return-1;for(L[1]=0,v=1;v<15;v++)L[v+1]=L[v]+S[v];for(w=0;w<n;w++)0!==t[r+w]&&(a[L[t[r+w]]++]=w);if(0===e?(_=N=a,p=20):1===e?(_=vt,N=wt,p=257):(_=bt,N=At,p=0),I=0,w=0,v=b,h=i,C=E,T=0,u=-1,d=(k=1<<E)-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){f=v-T,a[w]+1<p?(m=0,g=a[w]):a[w]>=p?(m=N[a[w]-p],g=_[a[w]-p]):(m=96,g=0),c=1<<v-T,b=l=1<<C;do{o[h+(I>>T)+(l-=c)]=f<<24|m<<16|g}while(0!==l);for(c=1<<v-1;I&c;)c>>=1;if(0!==c?(I&=c-1,I+=c):I=0,w++,0==--S[v]){if(v===A)break;v=t[r+a[w]]}if(v>E&&(I&d)!==u){for(0===T&&(T=E),h+=b,x=1<<(C=v-T);C+T<A&&!((x-=S[C+T])<=0);)C++,x<<=1;if(k+=1<<C,1===e&&k>852||2===e&&k>592)return 1;o[u=I&d]=E<<24|C<<16|h-i}}return 0!==I&&(o[h+I]=v-T<<24|64<<16),s.bits=E,0},Ct=z.Z_FINISH,Tt=z.Z_BLOCK,xt=z.Z_TREES,kt=z.Z_OK,It=z.Z_STREAM_END,_t=z.Z_NEED_DICT,St=z.Z_STREAM_ERROR,Lt=z.Z_DATA_ERROR,Nt=z.Z_MEM_ERROR,Pt=z.Z_BUF_ERROR,Ot=z.Z_DEFLATED,Rt=16180,Mt=16190,Dt=16191,Ut=16192,qt=16194,Bt=16199,Ht=16200,Ft=16206,zt=16209,jt=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function Gt(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Wt,Kt,$t=function(e){if(!e)return 1;var t=e.state;return!t||t.strm!==e||t.mode<Rt||t.mode>16211?1:0},Vt=function(e){if($t(e))return St;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Rt,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,kt},Yt=function(e){if($t(e))return St;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Vt(e)},Qt=function(e,t){var r;if($t(e))return St;var n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?St:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Yt(e))},Xt=function(e,t){if(!e)return St;var r=new Gt;e.state=r,r.strm=e,r.window=null,r.mode=Rt;var n=Qt(e,t);return n!==kt&&(e.state=null),n},Zt=!0,Jt=function(e){if(Zt){Wt=new Int32Array(512),Kt=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Et(1,e.lens,0,288,Wt,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Et(2,e.lens,0,32,Kt,0,e.work,{bits:5}),Zt=!1}e.lencode=Wt,e.lenbits=9,e.distcode=Kt,e.distbits=5},er=function(e,t,r,n){var o,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):((o=i.wsize-i.wnext)>n&&(o=n),i.window.set(t.subarray(r-n,r-n+o),i.wnext),(n-=o)?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0},tr=Yt,rr=Xt,nr=function(e,t){var r,n,o,i,a,s,c,l,u,d,h,p,f,m,g,y,v,w,b,A,E,C,T,x,k=0,I=new Uint8Array(4),_=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($t(e)||!e.output||!e.input&&0!==e.avail_in)return St;(r=e.state).mode===Dt&&(r.mode=Ut),a=e.next_out,o=e.output,c=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,l=r.hold,u=r.bits,d=s,h=c,C=kt;e:for(;;)switch(r.mode){case Rt:if(0===r.wrap){r.mode=Ut;break}for(;u<16;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(2&r.wrap&&35615===l){0===r.wbits&&(r.wbits=15),r.check=0,I[0]=255&l,I[1]=l>>>8&255,r.check=H(r.check,I,2,0),l=0,u=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",r.mode=zt;break}if((15&l)!==Ot){e.msg="unknown compression method",r.mode=zt;break}if(u-=4,E=8+(15&(l>>>=4)),0===r.wbits&&(r.wbits=E),E>15||E>r.wbits){e.msg="invalid window size",r.mode=zt;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&l?16189:Dt,l=0,u=0;break;case 16181:for(;u<16;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(r.flags=l,(255&r.flags)!==Ot){e.msg="unknown compression method",r.mode=zt;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=zt;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&4&r.wrap&&(I[0]=255&l,I[1]=l>>>8&255,r.check=H(r.check,I,2,0)),l=0,u=0,r.mode=16182;case 16182:for(;u<32;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}r.head&&(r.head.time=l),512&r.flags&&4&r.wrap&&(I[0]=255&l,I[1]=l>>>8&255,I[2]=l>>>16&255,I[3]=l>>>24&255,r.check=H(r.check,I,4,0)),l=0,u=0,r.mode=16183;case 16183:for(;u<16;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&4&r.wrap&&(I[0]=255&l,I[1]=l>>>8&255,r.check=H(r.check,I,2,0)),l=0,u=0,r.mode=16184;case 16184:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&4&r.wrap&&(I[0]=255&l,I[1]=l>>>8&255,r.check=H(r.check,I,2,0)),l=0,u=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&((p=r.length)>s&&(p=s),p&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+p),E)),512&r.flags&&4&r.wrap&&(r.check=H(r.check,n,p,i)),s-=p,i+=p,r.length-=p),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===s)break e;p=0;do{E=n[i+p++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E))}while(E&&p<s);if(512&r.flags&&4&r.wrap&&(r.check=H(r.check,n,p,i)),s-=p,i+=p,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===s)break e;p=0;do{E=n[i+p++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E))}while(E&&p<s);if(512&r.flags&&4&r.wrap&&(r.check=H(r.check,n,p,i)),s-=p,i+=p,E)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(4&r.wrap&&l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=zt;break}l=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Dt;break;case 16189:for(;u<32;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}e.adler=r.check=jt(l),l=0,u=0,r.mode=Mt;case Mt:if(0===r.havedict)return e.next_out=a,e.avail_out=c,e.next_in=i,e.avail_in=s,r.hold=l,r.bits=u,_t;e.adler=r.check=1,r.mode=Dt;case Dt:if(t===Tt||t===xt)break e;case Ut:if(r.last){l>>>=7&u,u-=7&u,r.mode=Ft;break}for(;u<3;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}switch(r.last=1&l,u-=1,3&(l>>>=1)){case 0:r.mode=16193;break;case 1:if(Jt(r),r.mode=Bt,t===xt){l>>>=2,u-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=zt}l>>>=2,u-=2;break;case 16193:for(l>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=zt;break}if(r.length=65535&l,l=0,u=0,r.mode=qt,t===xt)break e;case qt:r.mode=16195;case 16195:if(p=r.length){if(p>s&&(p=s),p>c&&(p=c),0===p)break e;o.set(n.subarray(i,i+p),a),s-=p,i+=p,c-=p,a+=p,r.length-=p;break}r.mode=Dt;break;case 16196:for(;u<14;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(r.nlen=257+(31&l),l>>>=5,u-=5,r.ndist=1+(31&l),l>>>=5,u-=5,r.ncode=4+(15&l),l>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=zt;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}r.lens[_[r.have++]]=7&l,l>>>=3,u-=3}for(;r.have<19;)r.lens[_[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,T={bits:r.lenbits},C=Et(0,r.lens,0,19,r.lencode,0,r.work,T),r.lenbits=T.bits,C){e.msg="invalid code lengths set",r.mode=zt;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;y=(k=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,v=65535&k,!((g=k>>>24)<=u);){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(v<16)l>>>=g,u-=g,r.lens[r.have++]=v;else{if(16===v){for(x=g+2;u<x;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(l>>>=g,u-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=zt;break}E=r.lens[r.have-1],p=3+(3&l),l>>>=2,u-=2}else if(17===v){for(x=g+3;u<x;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}u-=g,E=0,p=3+(7&(l>>>=g)),l>>>=3,u-=3}else{for(x=g+7;u<x;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}u-=g,E=0,p=11+(127&(l>>>=g)),l>>>=7,u-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=zt;break}for(;p--;)r.lens[r.have++]=E}}if(r.mode===zt)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=zt;break}if(r.lenbits=9,T={bits:r.lenbits},C=Et(1,r.lens,0,r.nlen,r.lencode,0,r.work,T),r.lenbits=T.bits,C){e.msg="invalid literal/lengths set",r.mode=zt;break}if(r.distbits=6,r.distcode=r.distdyn,T={bits:r.distbits},C=Et(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,T),r.distbits=T.bits,C){e.msg="invalid distances set",r.mode=zt;break}if(r.mode=Bt,t===xt)break e;case Bt:r.mode=Ht;case Ht:if(s>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=i,e.avail_in=s,r.hold=l,r.bits=u,yt(e,h),a=e.next_out,o=e.output,c=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,l=r.hold,u=r.bits,r.mode===Dt&&(r.back=-1);break}for(r.back=0;y=(k=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,v=65535&k,!((g=k>>>24)<=u);){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(y&&!(240&y)){for(w=g,b=y,A=v;y=(k=r.lencode[A+((l&(1<<w+b)-1)>>w)])>>>16&255,v=65535&k,!(w+(g=k>>>24)<=u);){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}l>>>=w,u-=w,r.back+=w}if(l>>>=g,u-=g,r.back+=g,r.length=v,0===y){r.mode=16205;break}if(32&y){r.back=-1,r.mode=Dt;break}if(64&y){e.msg="invalid literal/length code",r.mode=zt;break}r.extra=15&y,r.mode=16201;case 16201:if(r.extra){for(x=r.extra;u<x;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;y=(k=r.distcode[l&(1<<r.distbits)-1])>>>16&255,v=65535&k,!((g=k>>>24)<=u);){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(!(240&y)){for(w=g,b=y,A=v;y=(k=r.distcode[A+((l&(1<<w+b)-1)>>w)])>>>16&255,v=65535&k,!(w+(g=k>>>24)<=u);){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}l>>>=w,u-=w,r.back+=w}if(l>>>=g,u-=g,r.back+=g,64&y){e.msg="invalid distance code",r.mode=zt;break}r.offset=v,r.extra=15&y,r.mode=16203;case 16203:if(r.extra){for(x=r.extra;u<x;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=zt;break}r.mode=16204;case 16204:if(0===c)break e;if(p=h-c,r.offset>p){if((p=r.offset-p)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=zt;break}p>r.wnext?(p-=r.wnext,f=r.wsize-p):f=r.wnext-p,p>r.length&&(p=r.length),m=r.window}else m=o,f=a-r.offset,p=r.length;p>c&&(p=c),c-=p,r.length-=p;do{o[a++]=m[f++]}while(--p);0===r.length&&(r.mode=Ht);break;case 16205:if(0===c)break e;o[a++]=r.length,c--,r.mode=Ht;break;case Ft:if(r.wrap){for(;u<32;){if(0===s)break e;s--,l|=n[i++]<<u,u+=8}if(h-=c,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?H(r.check,o,h,a-h):q(r.check,o,h,a-h)),h=c,4&r.wrap&&(r.flags?l:jt(l))!==r.check){e.msg="incorrect data check",r.mode=zt;break}l=0,u=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,l+=n[i++]<<u,u+=8}if(4&r.wrap&&l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=zt;break}l=0,u=0}r.mode=16208;case 16208:C=It;break e;case zt:C=Lt;break e;case 16210:return Nt;default:return St}return e.next_out=a,e.avail_out=c,e.next_in=i,e.avail_in=s,r.hold=l,r.bits=u,(r.wsize||h!==e.avail_out&&r.mode<zt&&(r.mode<Ft||t!==Ct))&&er(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?H(r.check,o,h,e.next_out-h):q(r.check,o,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Dt?128:0)+(r.mode===Bt||r.mode===qt?256:0),(0===d&&0===h||t===Ct)&&C===kt&&(C=Pt),C},or=function(e){if($t(e))return St;var t=e.state;return t.window&&(t.window=null),e.state=null,kt},ir=function(e,t){if($t(e))return St;var r=e.state;return 2&r.wrap?(r.head=t,t.done=!1,kt):St},ar=function(e,t){var r,n=t.length;return $t(e)||0!==(r=e.state).wrap&&r.mode!==Mt?St:r.mode===Mt&&q(1,t,n,0)!==r.check?Lt:er(e,t,n,n)?(r.mode=16210,Nt):(r.havedict=1,kt)},sr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},cr=Object.prototype.toString,lr=z.Z_NO_FLUSH,ur=z.Z_FINISH,dr=z.Z_OK,hr=z.Z_STREAM_END,pr=z.Z_NEED_DICT,fr=z.Z_STREAM_ERROR,mr=z.Z_DATA_ERROR,gr=z.Z_MEM_ERROR;function yr(e){this.options=We({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Je,this.strm.avail_out=0;var r=rr(this.strm,t.windowBits);if(r!==dr)throw new Error(F[r]);if(this.header=new sr,ir(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Qe(t.dictionary):"[object ArrayBuffer]"===cr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=ar(this.strm,t.dictionary))!==dr))throw new Error(F[r])}function vr(e,t){var r=new yr(t);if(r.push(e),r.err)throw r.msg||F[r.err];return r.result}yr.prototype.push=function(e,t){var r,n,o,i=this.strm,a=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?ur:lr,"[object ArrayBuffer]"===cr.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(r=nr(i,n))===pr&&s&&((r=ar(i,s))===dr?r=nr(i,n):r===mr&&(r=pr));i.avail_in>0&&r===hr&&i.state.wrap>0&&0!==e[i.next_in];)tr(i),r=nr(i,n);switch(r){case fr:case mr:case pr:case gr:return this.onEnd(r),this.ended=!0,!1}if(o=i.avail_out,i.next_out&&(0===i.avail_out||r===hr))if("string"===this.options.to){var c=Ze(i.output,i.next_out),l=i.next_out-c,u=Xe(i.output,c);i.next_out=l,i.avail_out=a-l,l&&i.output.set(i.output.subarray(c,c+l),0),this.onData(u)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(r!==dr||0!==o){if(r===hr)return r=or(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},yr.prototype.onData=function(e){this.chunks.push(e)},yr.prototype.onEnd=function(e){e===dr&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ke(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var wr=function(e,t){return(t=t||{}).raw=!0,vr(e,t)},br=ht,Ar=pt,Er=ft,Cr=mt,Tr=yr,xr=vr,kr=wr,Ir=vr,_r=z,Sr={Deflate:br,deflate:Ar,deflateRaw:Er,gzip:Cr,Inflate:Tr,inflate:xr,inflateRaw:kr,ungzip:Ir,constants:_r};e.Deflate=br,e.Inflate=Tr,e.constants=_r,e.default=Sr,e.deflate=Ar,e.deflateRaw=Er,e.gzip=Cr,e.inflate=xr,e.inflateRaw=kr,e.ungzip=Ir,Object.defineProperty(e,"__esModule",{value:!0})}(t)},55892:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var a=r(11680),s=r(62559).isContent,c=r(62946),l=c.throwRawTagShouldBeOnlyTextInParagraph,u=c.getInvalidRawXMLValueException,d=r(73323),h="rawxml";function p(e){for(var t=e.part,r=e.left,n=e.right,o=e.postparsed,i=e.index,a=o.slice(r+1,n),c=0,u=a.length;c<u;c++)if(c!==i-r-1){var d=a[c];s(d)&&l({paragraphParts:a,part:t})}return t}var f=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="RawXmlModule",this.prefix="@"},t=[{key:"optionsTransformer",value:function(e,t){return this.fileTypeConfig=t.fileTypeConfig,e}},{key:"matchers",value:function(){return[[this.prefix,h]]}},{key:"postparse",value:function(e){return a.expandToOne(e,{moduleName:h,getInner:p,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(e){return'The tag "'.concat(e.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(e,t){if(e.module!==h)return null;var r,n=[];try{null!=(r=t.scopeManager.getValue(e.value,{part:e}))||(r=t.nullGetter(e))}catch(e){return n.push(e),{errors:n}}return"string"==typeof(r=r||"")?{value:r}:{errors:[u({tag:e.value,value:r,offset:e.offset})]}}}],t&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return d(new f)}},56381:function(e,t,r){"use strict";var n=r(62946),o=n.throwUnimplementedTagType,i=n.XTScopeParserError,a=r(62559).pushArray,s=r(79814);e.exports=function(e){var t=e.baseNullGetter,r=e.compiled,n=e.scopeManager;e.nullGetter=function(e,r){return t(e,r||n)};var c=[],l=r.map((function(t,r){var n;e.index=r,e.resolvedId=s(t,e);try{n=function(e,t){for(var r=0,n=t.modules;r<n.length;r++){var o=n[r].render(e,t);if(o)return o}return!1}(t,e)}catch(e){if(e instanceof i)return c.push(e),t;throw e}return n?(n.errors&&Array.prototype.push.apply(c,n.errors),n):"content"===t.type||"tag"===t.type?t:void o(t,r)})).reduce((function(e,t){var r=t.value;return r instanceof Array?a(e,r):r&&e.push(r),e}),[]);return{errors:c,parts:l}}},56820:function(e,t,r){"use strict";var n=r(3276),o=r(94758),i=r(72324),a=r(40277),s=r(62261),c=r(95108),l=r(35872),u=r(61485),d=r(49289),h=r(85668),p=r(53433),f=r(31317);function m(e){if(e._data instanceof u&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===o.getTypeOf(e._data))){var t=e._data;e._data=new Uint8Array(t.length),0!==t.length&&e._data.set(t,0)}return e._data}function g(e){var t=m(e);return"string"===o.getTypeOf(t)?!e.options.binary&&n.nodebuffer?d(t,"utf-8"):e.asBinary():t}var y={load:function(){throw new Error("Load method is not defined. Is the file pizzip-load.js included ?")},filter:function(e){var t,r,n,i,a=[];for(t in this.files)this.files.hasOwnProperty(t)&&(i=new w((n=this.files[t]).name,n._data,o.extend(n.options)),r=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(r,i)&&a.push(i));return a},file:function(e,t,r){if(1===arguments.length){if(o.isRegExp(e)){var n=e;return this.filter((function(e,t){return!t.dir&&n.test(e)}))}return this.filter((function(t,r){return!r.dir&&t===e}))[0]||null}return e=this.root+e,A.call(this,e,t,r),this},folder:function(e){if(!e)return this;if(o.isRegExp(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=C.call(this,t),n=this.shallowClone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(e){e=o.extend(e||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:h.utf8encode}),o.checkSupport(e.type),"darwin"!==e.platform&&"freebsd"!==e.platform&&"linux"!==e.platform&&"sunos"!==e.platform||(e.platform="UNIX"),"win32"===e.platform&&(e.platform="DOS");var t,r,n,i=[],s=o.transformTo("string",e.encodeFileName(e.comment||this.comment||"")),u=0,d=0;for(var m in this.files)if(this.files.hasOwnProperty(m)){var g=this.files[m],y=g.options.compression||e.compression.toUpperCase(),v=l[y];if(!v)throw new Error(y+" is not a valid compression method !");var w=g.options.compressionOptions||e.compressionOptions||{},A=T.call(this,g,v,w),E=x.call(this,m,g,A,u,e.platform,e.encodeFileName);u+=E.fileRecord.length+A.compressedSize,d+=E.dirRecord.length,i.push(E)}n=a.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(i.length,2)+b(i.length,2)+b(d,4)+b(u,4)+b(s.length,2)+s;var C=e.type.toLowerCase();for(t="uint8array"===C||"arraybuffer"===C||"blob"===C||"nodebuffer"===C?new f(u+d+n.length):new p(u+d+n.length),r=0;r<i.length;r++)t.append(i[r].fileRecord),t.append(i[r].compressedObject.compressedContent);for(r=0;r<i.length;r++)t.append(i[r].dirRecord);t.append(n);var k=t.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return o.transformTo(e.type.toLowerCase(),k);case"blob":return o.arrayBuffer2Blob(o.transformTo("arraybuffer",k),e.mimeType);case"base64":return e.base64?c.encode(k):k;default:return k}},crc32:function(e,t){return i(e,t)},utf8encode:function(e){return o.transformTo("string",h.utf8encode(e))},utf8decode:function(e){return h.utf8decode(e)}};function v(e){var t=m(this);return null==t?"":(this.options.base64&&(t=c.decode(t)),t=e&&this.options.binary?y.utf8decode(t):o.transformTo("string",t),e||this.options.binary||(t=o.transformTo("string",y.utf8encode(t))),t)}function w(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}}function b(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function A(e,t,r){var n,i=o.getTypeOf(t);if("string"==typeof(r=function(e){return!0!==(e=e||{}).base64||null!==e.binary&&void 0!==e.binary||(e.binary=!0),(e=o.extend(e,s)).date=e.date||new Date,null!==e.compression&&(e.compression=e.compression.toUpperCase()),e}(r)).unixPermissions&&(r.unixPermissions=parseInt(r.unixPermissions,8)),r.unixPermissions&&16384&r.unixPermissions&&(r.dir=!0),r.dosPermissions&&16&r.dosPermissions&&(r.dir=!0),r.dir&&(e=E(e)),r.createFolders&&(n=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""}(e))&&C.call(this,n,!0),r.dir||null==t)r.base64=!1,r.binary=!1,t=null,i=null;else if("string"===i)r.binary&&!r.base64&&!0!==r.optimizedBinaryString&&(t=o.string2binary(t));else{if(r.base64=!1,r.binary=!0,!(i||t instanceof u))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===i&&(t=o.transformTo("uint8array",t))}var a=new w(e,t,r);return this.files[e]=a,a}function E(e){return"/"!==e.slice(-1)&&(e+="/"),e}function C(e,t){return t=void 0!==t&&t,e=E(e),this.files[e]||A.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]}function T(e,t,r){var n,a=new u;return e._data instanceof u?(a.uncompressedSize=e._data.uncompressedSize,a.crc32=e._data.crc32,0===a.uncompressedSize||e.dir?(t=l.STORE,a.compressedContent="",a.crc32=0):e._data.compressionMethod===t.magic?a.compressedContent=e._data.getCompressedContent():(n=e._data.getContent(),a.compressedContent=t.compress(o.transformTo(t.compressInputType,n),r))):((n=g(e))&&0!==n.length&&!e.dir||(t=l.STORE,n=""),a.uncompressedSize=n.length,a.crc32=i(n),a.compressedContent=t.compress(o.transformTo(t.compressInputType,n),r)),a.compressedSize=a.compressedContent.length,a.compressionMethod=t.magic,a}function x(e,t,r,n,s,c){var l,u,d,p,f=c!==h.utf8encode,m=o.transformTo("string",c(t.name)),g=o.transformTo("string",h.utf8encode(t.name)),y=t.comment||"",v=o.transformTo("string",c(y)),w=o.transformTo("string",h.utf8encode(y)),A=g.length!==t.name.length,E=w.length!==y.length,C=t.options,T="",x="",k="";d=t._initialMetadata.dir!==t.dir?t.dir:C.dir,p=t._initialMetadata.date!==t.date?t.date:C.date;var I,_,S=0,L=0;d&&(S|=16),"UNIX"===s?(L=798,S|=(_=I=t.unixPermissions,I||(_=d?16893:33204),(65535&_)<<16)):(L=20,S|=63&(t.dosPermissions||0)),l=p.getHours(),l<<=6,l|=p.getMinutes(),l<<=5,l|=p.getSeconds()/2,u=p.getFullYear()-1980,u<<=4,u|=p.getMonth()+1,u<<=5,u|=p.getDate(),A&&(x=b(1,1)+b(i(m),4)+g,T+="up"+b(x.length,2)+x),E&&(k=b(1,1)+b(this.crc32(v),4)+w,T+="uc"+b(k.length,2)+k);var N="";return N+="\n\0",N+=f||!A&&!E?"\0\0":"\0\b",N+=r.compressionMethod,N+=b(l,2),N+=b(u,2),N+=b(r.crc32,4),N+=b(r.compressedSize,4),N+=b(r.uncompressedSize,4),N+=b(m.length,2),N+=b(T.length,2),{fileRecord:a.LOCAL_FILE_HEADER+N+m+T,dirRecord:a.CENTRAL_FILE_HEADER+b(L,2)+N+b(v.length,2)+"\0\0\0\0"+b(S,4)+b(n,4)+m+T+v,compressedObject:r}}w.prototype={asText:function(){return v.call(this,!0)},asBinary:function(){return v.call(this,!1)},asNodeBuffer:function(){var e=g(this);return o.transformTo("nodebuffer",e)},asUint8Array:function(){var e=g(this);return o.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}},e.exports=y},57175:function(e){"use strict";function t(e){var t,r,n,o,i=0,a=e.length;for(n=0;n<a;n++)55296==(64512&(t=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(r=e.charCodeAt(n+1)))&&(t=65536+(t-55296<<10)+(r-56320),n++),i+=t<128?1:t<2048?2:t<65536?3:4;var s=new Uint8Array(i);for(o=0,n=0;o<i;n++)55296==(64512&(t=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(r=e.charCodeAt(n+1)))&&(t=65536+(t-55296<<10)+(r-56320),n++),t<128?s[o++]=t:t<2048?(s[o++]=192|t>>>6,s[o++]=128|63&t):t<65536?(s[o++]=224|t>>>12,s[o++]=128|t>>>6&63,s[o++]=128|63&t):(s[o++]=240|t>>>18,s[o++]=128|t>>>12&63,s[o++]=128|t>>>6&63,s[o++]=128|63&t);return s}e.exports=function(e,r){for(var n=0,o=r.modules;n<o.length;n++)e=o[n].postrender(e,r);for(var i=0,a=r.joinUncorrupt(e,r),s="",c=0,l=[],u=0,d=a.length;u<d;u++){var h=a[u];if(h.length+c>65536){var p=t(s);i+=p.length,l.push(p),s=""}s+=h,c+=h.length,delete a[u]}var f=t(s);i+=f.length,l.push(f);for(var m=new Uint8Array(i),g=0,y=0;y<l.length;y++){for(var v=l[y],w=0;w<v.length;++w)m[w+g]=v[w];g+=v.length}return m}},57817:function(e,t,r){"use strict";var n=r(63265);function o(e){e&&(this.data=e,this.length=this.data.length,this.index=0,this.zero=0)}o.prototype=new n,o.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=o},58134:function(e){"use strict";function t(e,t){for(var r=-1,n=0,o=e.length;n<o;n++)t[n]>=e[n].length||(-1===r||e[n][t[n]].offset<e[r][t[r]].offset)&&(r=n);return r}e.exports=function(e){var r=e.reduce((function(e,t){return e+t.length}),0);e=e.filter((function(e){return e.length>0}));for(var n=new Array(r),o=e.map((function(){return 0})),i=0;i<r;i++){var a=t(e,o);n[i]=e[a][o[a]],o[a]++}return n}},58491:function(e,t){"use strict";function r(e){try{"function"!=typeof e&&(e=RegExp);var t=new e("𝌆","u").exec("𝌆");return!!t&&2===t[0].length}catch(e){}return!1}var n=r();function o(e){if("["!==e.source[0])throw new Error(e+" can not be used with chars");return e.source.slice(1,e.source.lastIndexOf("]"))}function i(e,t){if("["!==e.source[0])throw new Error("/"+e.source+"/ can not be used with chars_without");if(!t||"string"!=typeof t)throw new Error(JSON.stringify(t)+" is not a valid search");if(-1===e.source.indexOf(t))throw new Error('"'+t+'" is not is /'+e.source+"/");if("-"===t&&1!==e.source.indexOf(t))throw new Error('"'+t+'" is not at the first postion of /'+e.source+"/");return new RegExp(e.source.replace(t,""),n?"u":"")}function a(e){var t=this;return new RegExp(Array.prototype.slice.call(arguments).map((function(e){var r="string"==typeof e;if(r&&void 0===t&&"|"===e)throw new Error("use regg instead of reg to wrap expressions with `|`!");return r?e:e.source})).join(""),n?"mu":"m")}function s(e){if(0===arguments.length)throw new Error("no parameters provided");return a.apply(s,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var c=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;n&&(c=a("[",o(c),"\\u{10000}-\\u{10FFFF}","]"));var l=/[\x20\x09\x0D\x0A]/,u=o(l),d=a(l,"+"),h=a(l,"*"),p=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;n&&(p=a("[",o(p),"\\u{10000}-\\u{10FFFF}","]"));var f=a("[",o(p),o(/[-.0-9\xB7]/),o(/[\u0300-\u036F\u203F-\u2040]/),"]"),m=a(p,f,"*"),g=a(f,"+"),y=a("&",m,";"),v=s(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),w=s(y,"|",v),b=a("%",m,";"),A=s(a('"',s(/[^%&"]/,"|",b,"|",w),"*",'"'),"|",a("'",s(/[^%&']/,"|",b,"|",w),"*","'")),E=s('"',s(/[^<&"]/,"|",w),"*",'"',"|","'",s(/[^<&']/,"|",w),"*","'"),C=a(i(p,":"),i(f,":"),"*"),T=a(C,s(":",C),"?"),x=a("^",T,"$"),k=a("(",T,")"),I=s(/"[^"]*"|'[^']*'/),_=a(/^<\?/,"(",m,")",s(d,"(",c,"*?)"),"?",/\?>/),S=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,L=s('"',S,'*"',"|","'",i(S,"'"),"*'"),N="\x3c!--",P=a(N,s(i(c,"-"),"|",a("-",i(c,"-"))),"*","--\x3e"),O="#PCDATA",R=s(a(/\(/,h,O,s(h,/\|/,h,T),"*",h,/\)\*/),"|",a(/\(/,h,O,h,/\)/)),M=s("EMPTY","|","ANY","|",R,"|",a(/\([^>]+\)/,/[?*+]?/)),D=a("<!ELEMENT",d,s(T,"|",b),d,s(M,"|",b),h,">"),U=a("NOTATION",d,/\(/,h,m,s(h,/\|/,h,m),"*",h,/\)/),q=a(/\(/,h,g,s(h,/\|/,h,g),"*",h,/\)/),B=s(U,"|",q),H=s(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",B),F=s(/#REQUIRED|#IMPLIED/,"|",s(s("#FIXED",d),"?",E)),z=a("<!ATTLIST",d,m,s(d,m,d,H,d,F),"*",h,">"),j="about:legacy-compat",G=s('"'+j+'"',"|","'"+j+"'"),W="SYSTEM",K="PUBLIC",$=s(s(W,d,I),"|",s(K,d,L,d,I)),V=a("^",s(s(W,d,"(?<SystemLiteralOnly>",I,")"),"|",s(K,d,"(?<PubidLiteral>",L,")",d,"(?<SystemLiteral>",I,")"))),Y=s(d,"NDATA",d,m),Q="<!ENTITY",X=a(Q,d,m,d,s(A,"|",s($,Y,"?")),h,">"),Z=s(A,"|",$),J=s(X,"|",a(Q,d,"%",d,m,d,Z,h,">")),ee=a(K,d,L),te=a("<!NOTATION",d,m,d,s($,"|",ee),h,">"),re=a(h,"=",h),ne=/1[.]\d+/,oe=a(d,"version",re,s("'",ne,"'","|",'"',ne,'"')),ie=/[A-Za-z][-A-Za-z0-9._]*/,ae=a(/^<\?xml/,oe,s(d,"encoding",re,s('"',ie,'"',"|","'",ie,"'")),"?",s(d,"standalone",re,s("'",s("yes","|","no"),"'","|",'"',s("yes","|","no"),'"')),"?",h,/\?>/),se=a(c,"*?",/\]\]>/),ce=a(/<!\[CDATA\[/,se);t.chars=o,t.chars_without=i,t.detectUnicodeSupport=r,t.reg=a,t.regg=s,t.ABOUT_LEGACY_COMPAT=j,t.ABOUT_LEGACY_COMPAT_SystemLiteral=G,t.AttlistDecl=z,t.CDATA_START="<![CDATA[",t.CDATA_END="]]>",t.CDSect=ce,t.Char=c,t.Comment=P,t.COMMENT_START=N,t.COMMENT_END="--\x3e",t.DOCTYPE_DECL_START="<!DOCTYPE",t.elementdecl=D,t.EntityDecl=J,t.EntityValue=A,t.ExternalID=$,t.ExternalID_match=V,t.Name=m,t.NotationDecl=te,t.Reference=w,t.PEReference=b,t.PI=_,t.PUBLIC=K,t.PubidLiteral=L,t.QName=T,t.QName_exact=x,t.QName_group=k,t.S=d,t.SChar_s=u,t.S_OPT=h,t.SYSTEM=W,t.SystemLiteral=I,t.UNICODE_REPLACEMENT_CHARACTER="�",t.UNICODE_SUPPORT=n,t.XMLDecl=ae},58883:function(e){"use strict";e.exports=function(e,t,r){for(var n={},o=0;o<e.length;o++){var i=e[o],a=i.getAttribute("ContentType"),s=i.getAttribute("PartName").substr(1);n[s]=a}for(var c=function(){var e=t[l],o=e.getAttribute("ContentType"),i=e.getAttribute("Extension");r.file(/./).map((function(e){var t=e.name;t.slice(t.length-i.length)!==i||n[t]||"[Content_Types].xml"===t||(n[t]=o)}))},l=0;l<t.length;l++)c();return n}},61485:function(e){"use strict";function t(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}t.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=t},61970:function(e,t,r){"use strict";var n=r(94758);t.string2binary=function(e){return n.string2binary(e)},t.string2Uint8Array=function(e){return n.transformTo("uint8array",e)},t.uint8Array2String=function(e){return n.transformTo("string",e)},t.string2Blob=function(e){var t=n.transformTo("arraybuffer",e);return n.arrayBuffer2Blob(t)},t.arrayBuffer2Blob=function(e){return n.arrayBuffer2Blob(e)},t.transformTo=function(e,t){return n.transformTo(e,t)},t.getTypeOf=function(e){return n.getTypeOf(e)},t.checkSupport=function(e){return n.checkSupport(e)},t.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS,t.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS,t.pretty=function(e){return n.pretty(e)},t.findCompression=function(e){return n.findCompression(e)},t.isRegExp=function(e){return n.isRegExp(e)}},62261:function(e,t){"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!1,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},62559:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var o=r(45426),i=o.DOMParser,a=o.XMLSerializer,s=r(62946).throwXmlTagNotFound,c=r(93560),l=c.last,u=c.first;function d(e){return{get:function(t){return"."===e?t:t?t[e]:t}}}var h={},p=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]],f=p.map((function(e){var t,r,o=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(t,r)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];return{rstart:new RegExp(a,"g"),rend:new RegExp(i,"g"),start:a,end:i}})),m=new RegExp(String.fromCharCode(160),"g");function g(e,t){return e==="</"+t+">"}function y(e,t){return 0===e.indexOf("<"+t)&&-1!==[">"," ","/"].indexOf(e[t.length+1])}function v(e,t,r){"string"==typeof t&&(t=[t]);for(var n=1,o=r,i=e.length;o<i;o++)for(var a=e[o],s=0,c=t;s<c.length;s++){var l=c[s];if(g(a.value,l)&&n--,y(a.value,l)&&n++,0===n)return o}return null}function w(e,t,r){"string"==typeof t&&(t=[t]);for(var n=1,o=r;o>=0;o--)for(var i=e[o],a=0,s=t;a<s.length;a++){var c=s[a];if(y(i.value,c)&&n--,g(i.value,c)&&n++,0===n)return o}return null}var b=/[\x00-\x08\x0B\x0C\x0E-\x1F]/;e.exports={endsWith:function(e,t){return-1!==e.indexOf(t,e.length-t.length)},startsWith:function(e,t){return e.substring(0,t.length)===t},isContent:function(e){var t=e.type,r=e.position;return"placeholder"===t||"content"===t&&"insidetag"===r},isParagraphStart:function(e){var t=e.type,r=e.tag,n=e.position;return-1!==["w:p","a:p"].indexOf(r)&&"tag"===t&&"start"===n},isParagraphEnd:function(e){var t=e.type,r=e.tag,n=e.position;return-1!==["w:p","a:p"].indexOf(r)&&"tag"===t&&"end"===n},isTagStart:function(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&("start"===o||"selfclosing"===o)},isTagEnd:function(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&"end"===o},isTextStart:function(e){var t=e.type,r=e.position;return e.text&&"tag"===t&&"start"===r},isTextEnd:function(e){var t=e.type,r=e.position;return e.text&&"tag"===t&&"end"===r},isStarting:y,isEnding:g,isModule:function(e,t){var r=e.module,n=e.type;return t instanceof Array||(t=[t]),"placeholder"===n&&-1!==t.indexOf(r)},uniq:function(e){for(var t={},r=[],n=0,o=e.length;n<o;++n)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r},getDuplicates:function(e){for(var t=[],r={},n=[],o=0,i=e.length;o<i;++o)r[e[o]]?t.push(e[o]):(r[e[o]]=!0,n.push(e[o]));return t},chunkBy:function(e,t){for(var r=[[]],n=0;n<e.length;n++){var o=e[n],i=r[r.length-1],a=t(o);"start"===a?r.push([o]):"end"===a?(i.push(o),r.push([])):i.push(o)}for(var s=[],c=0;c<r.length;c++){var l=r[c];l.length>0&&s.push(l)}return s},last:l,first:u,xml2str:function(e){return(new a).serializeToString(e).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function(e){return 65279===e.charCodeAt(0)&&(e=e.substr(1)),(new i).parseFromString(e,"text/xml")},getRightOrNull:v,getRight:function(e,t,r){var n=v(e,t,r);if(null!==n)return n;s({position:"right",element:t,parsed:e,index:r})},getLeftOrNull:w,getLeft:function(e,t,r){var n=w(e,t,r);if(null!==n)return n;s({position:"left",element:t,parsed:e,index:r})},pregMatchAll:function(e,t){for(var r,n=[];null!=(r=e.exec(t));)n.push({array:r,offset:r.index});return n},convertSpaces:function(e){return e.replace(m," ")},charMapRegexes:f,hasCorruptCharacters:function(e){return b.test(e)},removeCorruptCharacters:function(e){return"string"!=typeof e&&(e=String(e)),e.replace(b,"")},getDefaults:function(){return{errorLogging:"json",stripInvalidXMLChars:!1,paragraphLoop:!1,nullGetter:function(e){return e.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:d,linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"},syntax:{changeDelimiterPrefix:"="}}},wordToUtf8:function(e){for(var t=f.length-1;t>=0;t--){var r=f[t];e=e.replace(r.rstart,r.end)}return e},utf8ToWord:function(e){var t;e=e.toString();for(var r=0,n=f.length;r<n;r++)t=f[r],e=e.replace(t.rend,t.start);return e},concatArrays:function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],o=0;o<n.length;o++){var i=n[o];t.push(i)}return t},pushArray:function(e,t){if(!t)return e;for(var r=0,n=t.length;r<n;r++)e.push(t[r]);return e},invertMap:function(e){var t={};for(var r in e){var n=e[r];t[n]||(t[n]=[]),t[n].push(r)}return t},charMap:p,getSingleAttribute:function(e,t){var r=e.indexOf(" ".concat(t,'="'));if(-1===r)return null;var n=e.substr(r).search(/["']/)+r,o=e.substr(n+1).search(/["']/)+n;return e.substr(n+1,o-n)},setSingleAttribute:function(e,t,r){var n;if(h[t]?n=h[t]:(n=new RegExp("(<.* ".concat(t,'=")([^"]*)(".*)$')),h[t]=n),n.test(e))return e.replace(n,"$1".concat(r,"$3"));var o=e.lastIndexOf("/>");return-1===o&&(o=e.lastIndexOf(">")),e.substr(0,o)+" ".concat(t,'="').concat(r,'"')+e.substr(o)},isWhiteSpace:function(e){return/^[ \n\r\t]+$/.test(e)},stableSort:function(e,t){return e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item}))}}},62566:function(e,t){"use strict";function r(e,t){return void 0===t&&(t=Object),t&&"function"==typeof t.getOwnPropertyDescriptors&&(e=t.create(null,t.getOwnPropertyDescriptors(e))),t&&"function"==typeof t.freeze?t.freeze(e):e}function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var o=r({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0}),i=r({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),a=r({script:!1,style:!1,textarea:!0,title:!0});function s(e){return e===c.HTML}var c=r({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),l=Object.keys(c).map((function(e){return c[e]})),u=r({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.assign=function(e,t){if(null===e||"object"!=typeof e)throw new TypeError("target is not an object");for(var r in t)n(t,r)&&(e[r]=t[r]);return e},t.find=function(e,t,r){if(void 0===r&&(r=Array.prototype),e&&"function"==typeof r.find)return r.find.call(e,t);for(var o=0;o<e.length;o++)if(n(e,o)){var i=e[o];if(t.call(void 0,i,o,e))return i}},t.freeze=r,t.HTML_BOOLEAN_ATTRIBUTES=o,t.HTML_RAW_TEXT_ELEMENTS=a,t.HTML_VOID_ELEMENTS=i,t.hasDefaultHTMLNamespace=function(e){return s(e)||e===c.XML_XHTML_APPLICATION},t.hasOwn=n,t.isHTMLBooleanAttribute=function(e){return n(o,e.toLowerCase())},t.isHTMLRawTextElement=function(e){var t=e.toLowerCase();return n(a,t)&&!a[t]},t.isHTMLEscapableRawTextElement=function(e){var t=e.toLowerCase();return n(a,t)&&a[t]},t.isHTMLMimeType=s,t.isHTMLVoidElement=function(e){return n(i,e.toLowerCase())},t.isValidMimeType=function(e){return l.indexOf(e)>-1},t.MIME_TYPE=c,t.NAMESPACE=u},62946:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(93560),s=a.last,c=a.first;function l(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}function u(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}function d(e){this.name="RenderingError",this.message=e,this.stack=new Error(e).stack}function h(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}function p(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}function f(e){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=e,this.stack=new Error(e).stack}l.prototype=Error.prototype,u.prototype=new l,d.prototype=new l,h.prototype=new l,p.prototype=new l,f.prototype=new l,e.exports={XTError:l,XTTemplateError:u,XTInternalError:p,XTScopeParserError:h,XTAPIVersionError:f,RenderingError:d,XTRenderingError:d,getClosingTagNotMatchOpeningTag:function(e){var t=e.tags,r=new u("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(t[0].value,'" is closed by the tag "').concat(t[1].value,'"'),openingtag:c(t).value,offset:[c(t).offset,s(t).offset],closingtag:s(t).value},r},getLoopPositionProducesInvalidXMLError:function(e){var t=e.tag,r=e.offset,n=new u('The position of the loop tags "'.concat(t,'" would produce invalid XML'));return n.properties={xtag:t,id:"loop_position_invalid",explanation:'The tags "'.concat(t,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:r},n},getScopeCompilationError:function(e){var t=e.tag,r=e.rootError,n=e.offset,o=new h("Scope parser compilation failed");return o.properties={id:"scopeparser_compilation_failed",offset:n,xtag:t,explanation:'The scope parser for the tag "'.concat(t,'" failed to compile'),rootError:r},o},getScopeParserExecutionError:function(e){var t=e.tag,r=e.scope,n=e.error,o=e.offset,i=new h("Scope parser execution failed");return i.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(t," failed to execute"),scope:r,offset:o,xtag:t,rootError:n},i},getUnclosedTagException:function(e){var t=new u("Unclosed tag");return t.properties={xtag:c(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unclosed')},t},getUnopenedTagException:function(e){var t=new u("Unopened tag");return t.properties={xtag:s(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unopened')},t},getUnmatchedLoopException:function(e){var t=e.location,r=e.offset,n=e.square,o="start"===t?"unclosed":"unopened",i=new u("".concat("start"===t?"Unclosed":"Unopened"," loop")),a=e.value;return i.properties={id:"".concat(o,"_loop"),explanation:'The loop with tag "'.concat(a,'" is ').concat(o),xtag:a,offset:r},n&&(i.properties.square=n),i},getDuplicateCloseTagException:function(e){var t=new u("Duplicate close tag, expected one close tag");return t.properties={xtag:c(e.xtag.split(" ")),id:"duplicate_close_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag ending with "'.concat(e.xtag.substr(0,10),'" has duplicate close tags')},t},getDuplicateOpenTagException:function(e){var t=new u("Duplicate open tag, expected one open tag");return t.properties={xtag:c(e.xtag.split(" ")),id:"duplicate_open_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" has duplicate open tags')},t},getCorruptCharactersException:function(e){var t=e.tag,r=e.value,n=e.offset,o=new d("There are some XML corrupt characters");return o.properties={id:"invalid_xml_characters",xtag:t,value:r,offset:n,explanation:"There are some corrupt characters for the field ".concat(t)},o},getInvalidRawXMLValueException:function(e){var t=e.tag,r=e.value,n=e.offset,o=new d("Non string values are not allowed for rawXML tags");return o.properties={id:"invalid_raw_xml_value",xtag:t,value:r,offset:n,explanation:"The value of the raw tag : '".concat(t,"' is not a string")},o},getUnbalancedLoopException:function(e,t){var r=new u("Unbalanced loop tag"),n=t[0].part.value,o=t[1].part.value,i=e[0].part.value,a=e[1].part.value;return r.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(n,"}{/").concat(o,"}{#").concat(i,"}{/").concat(a,"}"),offset:[t[0].part.offset,e[1].part.offset],lastPair:{left:t[0].part.value,right:t[1].part.value},pair:{left:e[0].part.value,right:e[1].part.value}},r},throwApiVersionError:function(e,t){var r=new f(e);throw r.properties=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:"api_version_error"},t),r},throwFileTypeNotHandled:function(e){var t=new p('The filetype "'.concat(e,'" is not handled by docxtemplater'));throw t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(e,'", but only docx and pptx formats are handled'),fileType:e},t},throwFileTypeNotIdentified:function(e){var t,r=Object.keys(e.files).slice(0,10);t=0===r.length?"Empty zip file":"Zip file contains : ".concat(r.join(","));var n=new p("The filetype for this file could not be identified, is this file corrupted ? ".concat(t));throw n.properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ? ".concat(t)},n},throwMalformedXml:function(){var e=new p("Malformed xml");throw e.properties={explanation:"The template contains malformed xml",id:"malformed_xml"},e},throwMultiError:function(e){var t=new u("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t},throwExpandNotFound:function(e){var t=e.part,r=t.value,n=t.offset,o=e.id,i=void 0===o?"raw_tag_outerxml_invalid":o,a=e.message,s=void 0===a?"Raw tag not in paragraph":a,c=e.part,l=e.explanation,d=void 0===l?'The tag "'.concat(r,'" is not inside a paragraph'):l;"function"==typeof d&&(d=d(c));var h=new u(s);throw h.properties={id:i,explanation:d,rootError:e.rootError,xtag:r,offset:n,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},h},throwRawTagShouldBeOnlyTextInParagraph:function(e){var t=new u("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(r,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:r,offset:e.part.offset,paragraphParts:e.paragraphParts},t},throwUnimplementedTagType:function(e,t){var r='Unimplemented tag type "'.concat(e.type,'"');e.module&&(r+=' "'.concat(e.module,'"'));var n=new u(r);throw n.properties={part:e,index:t,id:"unimplemented_tag_type"},n},throwXmlTagNotFound:function(e){var t=new u('No tag "'.concat(e.element,'" was found at the ').concat(e.position)),r=e.parsed[e.index];throw t.properties={id:"no_xml_tag_found_at_".concat(e.position),explanation:'No tag "'.concat(e.element,'" was found at the ').concat(e.position),offset:r.offset,part:r,parsed:e.parsed,index:e.index,element:e.element},t},throwXmlInvalid:function(e,t){var r=new u("An XML file has invalid xml");throw r.properties={id:"file_has_invalid_xml",content:e,offset:t,explanation:"The docx contains invalid XML, it is most likely corrupt"},r},throwResolveBeforeCompile:function(){var e=new p("You must run `.compile()` before running `.resolveData()`");throw e.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"},e},throwRenderInvalidTemplate:function(){var e=new p("You should not call .render on a document that had compilation errors");throw e.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"},e},throwRenderTwice:function(){var e=new p("You should not call .render twice on the same docxtemplater instance");throw e.properties={id:"render_twice",explanation:"You should not call .render twice on the same docxtemplater instance"},e}}},63265:function(e,t,r){"use strict";var n=r(66144);function o(e){if(e){this.data=e,this.length=this.data.length,this.index=0,this.zero=0;for(var t=0;t<this.data.length;t++)e[t]&=e[t]}}o.prototype=new n,o.prototype.byteAt=function(e){return this.data[this.zero+e]},o.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),o=e.charCodeAt(3),i=this.length-4;i>=0;--i)if(this.data[i]===t&&this.data[i+1]===r&&this.data[i+2]===n&&this.data[i+3]===o)return i-this.zero;return-1},o.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=o},64365:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return(t=u(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var d=r(62559),h=d.chunkBy,p=d.last,f=d.isParagraphStart,m=d.isModule,g=d.pushArray,y=d.isParagraphEnd,v=d.isContent,w=d.startsWith,b=d.isTagEnd,A=d.isTagStart,E=d.getSingleAttribute,C=d.setSingleAttribute,T=r(67770),x=r(73323),k="loop";function I(e){var t=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("content"!==r.type)return r}return null}(e.subparsed);return null!=t&&"w:t"!==t.tag}function _(e){return e.hasPageBreak&&I(e)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':""}function S(e){return e.some((function(e){return v(e)}))?0:e.length}function L(e){var t=e.parts.length-1;"</w:p>"===e.parts[t]?e.parts.splice(t,0,'<w:r><w:br w:type="page"/></w:r>'):e.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function N(e){return e.some((function(e){return"w:br"===e.tag&&-1!==e.value.indexOf('w:type="page"')}))}function P(e){return e.some((function(e){return"w:drawing"===e.tag}))}var O=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="LoopModule",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}},t=[{key:"optionsTransformer",value:function(e,t){return this.docxtemplater=t,e}},{key:"preparse",value:function(e,t){var r=t.contentType;-1!==T.main.indexOf(r)&&(this.sects=function(e){for(var t=!1,r=[],n=0;n<e.length;n++){var o=e[n];A("w:sectPr",o)&&(r.push([]),t=!0),t&&r[r.length-1].push(o),b("w:sectPr",o)&&(t=!1)}return r}(e))}},{key:"matchers",value:function(){var e=k;return[[this.prefix.start,e,{expandTo:"auto",location:"start",inverted:!1}],[this.prefix.inverted,e,{expandTo:"auto",location:"start",inverted:!0}],[this.prefix.end,e,{location:"end"}],[this.prefix.dash,e,function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,3);return{location:"start",inverted:!1,expandTo:t[1],value:t[2]}}]]}},{key:"getTraits",value:function(e,t){if("expandPair"===e)return t.reduce((function(e,t,r){return m(t,k)&&null==t.subparsed&&e.push({part:t,offset:r}),e}),[])}},{key:"postparse",value:function(e,t){var r=t.basePart;if(r&&"docx"===this.docxtemplater.fileType&&e.length>0){r.sectPrCount=function(e){for(var t=!1,r=0,n=0;n<e.length;n++){var o=e[n];A("w:sectPr",o)&&(t=!0),t&&("w:headerReference"!==o.tag&&"w:footerReference"!==o.tag||(r++,t=!1)),b("w:sectPr",o)&&(t=!1)}return r}(e),this.totalSectPr+=r.sectPrCount;var n=this.sects;n.some((function(t,o){return r.lIndex<t[0].lIndex?(o+1<n.length&&n[o+1].some((function(e){return A("w:type",e)&&-1!==e.value.indexOf("continuous")}))&&(r.addContinuousType=!0),!0):e[0].lIndex<t[0].lIndex&&t[0].lIndex<r.lIndex?(n[o].some((function(e){return A("w:type",e)&&-1!==e.value.indexOf('w:val="nextPage"')}))&&(r.addNextPage={index:o}),!0):void 0})),r.lastParagrapSectPr=function(e){for(var t=[],r=!1,n=e.length-1;n>=0;n--){var o=e[n];if(b("w:sectPr",o)&&(r=!0),A("w:sectPr",o)&&(t.unshift(o.value),r=!1),r&&t.unshift(o.value),f(o)){if(t.length>0)return t.join("");break}}return""}(e)}if(!r||"auto"!==r.expandTo||r.module!==k||!function(e){return e.length&&f(e[0])&&y(p(e))}(e))return e;r.paragraphLoop=!0;var o=0,i=h(e,(function(e){return f(e)&&1==++o?"start":y(e)&&0==--o?"end":null})),a=i[0],s=p(i),c=S(a),l=S(s);return r.hasPageBreakBeginning=N(a),r.hasPageBreak=N(s),P(a)&&(c=0),P(s)&&(l=0),e.slice(c,e.length-l)}},{key:"resolve",value:function(e,t){if(!m(e,k))return null;var r=t.scopeManager,n=r.getValueAsync(e.value,{part:e}),o=[];function a(n,a,s){var c=r.createSubScopeManager(n,e.value,a,e,s);o.push(t.resolve(i(i({},t),{},{compiled:e.subparsed,tags:{},scopeManager:c})))}var l=[];return n.then((function(t){return new Promise((function(e){t instanceof Array?Promise.all(t).then(e):e(t)})).then((function(t){return r.loopOverValue(t,a,e.inverted),Promise.all(o).then((function(e){return e.map((function(e){var t=e.resolved,r=e.errors;return l.push.apply(l,function(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r)),t}))})).then((function(e){if(l.length>0)throw l;return e}))}))}))}},{key:"render",value:function(e,t){if("p:xfrm"===e.tag&&(this.inXfrm="start"===e.position),"a:ext"===e.tag&&this.inXfrm)return this.lastExt=e,e;if(!m(e,k))return null;var r=[],n=[],o=0,a=this,s=e.subparsed[0],c=0;"a:tr"===(null==s?void 0:s.tag)&&(c=+E(s.value,"h")),o-=c;var l=0,u=I(e);if(!1===t.scopeManager.loopOver(e.value,(function(s,d,h){o+=c;for(var p=t.scopeManager.createSubScopeManager(s,e.value,d,e,h),f=0,m=e.subparsed;f<m.length;f++){var y=m[f];if(A("a16:rowId",y)){var v=+E(y.value,"val")+l;l=1,y.value=C(y.value,"val",v)}}var b,T,x,k=t.render(i(i({},t),{},{compiled:e.subparsed,tags:{},scopeManager:p}));e.hasPageBreak&&d===h-1&&u&&L(k),p.scopePathItem.some((function(e){return 0!==e}))?(1===e.sectPrCount&&(k.parts=k.parts.filter((function(e){return!w(e,"<w:headerReference")&&!w(e,"<w:footerReference")}))),e.addContinuousType&&(k.parts=(b=k.parts,T=!1,x=!1,b.reduce((function(e,t){return!1===T&&w(t,"<w:sectPr")&&(x=!0),x&&(w(t,"<w:type")&&(T=!0),!1===T&&w(t,"</w:sectPr")&&e.push('<w:type w:val="continuous"/>')),e.push(t),e}),[])))):e.addNextPage&&(k.parts=function(e,t){return g(["<w:p><w:pPr>".concat(t.map((function(e){return e.value})).join(""),"</w:pPr></w:p>")],e)}(k.parts,a.sects[e.addNextPage.index])),e.addNextPage&&L(k),e.hasPageBreakBeginning&&u&&function(e){e.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(k);for(var I=0,_=k.parts;I<_.length;I++){var S=_[I];r.push(S)}Array.prototype.push.apply(n,k.errors)}),e.inverted,{part:e}))return e.lastParagrapSectPr?e.paragraphLoop?{value:"<w:p><w:pPr>".concat(e.lastParagrapSectPr,"</w:pPr></w:p>")}:{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(e.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}:{value:_(e)||"",errors:n};if(0!==o){var d=+E(this.lastExt.value,"cy");this.lastExt.value=C(this.lastExt.value,"cy",d+o)}return{value:t.joinUncorrupt(r,i(i({},t),{},{basePart:e})),errors:n}}}],t&&l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return x(new O)}},64759:function(e,t,r){"use strict";var n=r(62559).pregMatchAll;e.exports=function(e,t){var r={content:e},o=t.join("|"),i=new RegExp("(?:(<(?:".concat(o,")[^>]*>)([^<>]*)</(?:").concat(o,")>)|(<(?:").concat(o,")[^>]*/>)"),"g");return r.matches=n(i,r.content),r}},64983:function(e){"use strict";function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function n(e){return"placeholder"===e.type}e.exports={getTags:function(e){var r={},o=[{items:e.filter(n),parents:[],path:[]}];function i(e,r,n){n.length&&o.push({items:n,parents:[].concat(t(r.parents),[e]),path:!1===e.dataBound||e.attrParsed||!e.value||e.attrParsed?t(r.path):[].concat(t(r.path),[e.value])})}function a(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length,n=e,o=0;o<r;o++)n=n[t[o]];return n}function s(e,t){return t.reduce((function(t,r){return("number"==typeof r.lIndex?r.lIndex:parseInt(r.lIndex.split("-")[0],10))>e.lIndex?t-1:t}),t.length)}for(;o.length>0;)for(var c=o.pop(),l=a(r,c.path),u=0,d=c.items;u<d.length;u++){var h,p,f,m,g=d[u];if(g.attrParsed)for(var y in g.attrParsed)i(g,c,g.attrParsed[y].filter(n));else if(g.subparsed)!1!==g.dataBound&&((f=l)[m=g.value]||(f[m]={})),i(g,c,g.subparsed.filter(n));else if(g.cellParsed)for(var v=0,w=g.cellPostParsed;v<w.length;v++){var b=w[v];if("placeholder"===b.type){if("pro-xml-templating/xls-module-loop"===b.module)continue;if(b.subparsed){var A,E;(A=l)[E=b.value]||(A[E]={}),i(b,c,b.subparsed.filter(n))}else{var C,T,x=s(g,c.parents);(C=l=a(r,c.path,x))[T=b.value]||(C[T]={})}}}else!1!==g.dataBound&&((h=l)[p=g.value]||(h[p]={}))}return r},isPlaceholder:n}},65606:function(e){var t,r,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var s,c=[],l=!1,u=-1;function d(){l&&s&&(l=!1,s.length?c=s.concat(c):u=-1,c.length&&h())}function h(){if(!l){var e=a(d);l=!0;for(var t=c.length;t;){for(s=c,c=[];++u<t;)s&&s[u].run();u=-1,t=c.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||l||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},66144:function(e,t,r){"use strict";var n=r(94758);function o(){this.data=null,this.length=0,this.index=0,this.zero=0}o.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},e.exports=o},67770:function(e){"use strict";var t=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml","application/vnd.ms-word.template.macroEnabledTemplate.main+xml"],r={main:t,docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"].concat(t,["application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml"]),pptx:["application/vnd.openxmlformats-officedocument.presentationml.slide+xml","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"],xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml","application/vnd.ms-excel.sheet.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]};e.exports=r},71354:function(e){"use strict";e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(o," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},71362:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var a=r(62559),s=a.pushArray,c=a.wordToUtf8,l=a.convertSpaces,u=r(64759),d=r(31751),h=r(71458),p=r(56381),f=r(57175),m=r(15153),g=r(47120);e.exports=function(){return e=function e(t,r){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cachedParsers={},this.content=t,r)this[n]=r[n];this.setModules({inspect:{filePath:r.filePath}})},t=[{key:"resolveTags",value:function(e){var t=this;this.tags=e;var r=this.getOptions(),n=this.filePath;r.scopeManager=this.scopeManager,r.resolve=m;var o=[];return Promise.all(this.modules.map((function(e){return Promise.resolve(e.preResolve(r)).catch((function(e){o.push(e)}))}))).then((function(){if(0!==o.length)throw o;return m(r).then((function(e){var o=e.resolved,i=e.errors;if(0!==(i=i.map((function(e){var t;return e instanceof Error||(e=new Error(e)),(t=e).properties||(t.properties={}),e.properties.file=n,e}))).length)throw i;return Promise.all(o).then((function(e){return r.scopeManager.root.finishedResolving=!0,r.scopeManager.resolved=e,t.setModules({inspect:{resolved:e,filePath:n}}),e}))})).catch((function(e){throw t.errorChecker(e),e}))}))}},{key:"getFullText",value:function(){return e=this.content,t=this.fileTypeConfig.tagsXmlTextArray,r=u(e,t).matches.map((function(e){return e.array[2]})),c(l(r.join("")));var e,t,r}},{key:"setModules",value:function(e){for(var t=0,r=this.modules;t<r.length;t++)r[t].set(e)}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=d.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{filePath:this.filePath,xmllexed:this.xmllexed}});var e=d.parse(this.xmllexed,this.delimiters,this.syntax,this.fileType),t=e.lexed,r=e.errors;s(this.allErrors,r),this.lexed=t,this.setModules({inspect:{filePath:this.filePath,lexed:this.lexed}});var n=this.getOptions();this.lexed=h.preparse(this.lexed,this.modules,n)}},{key:"parse",value:function(){this.setModules({inspect:{filePath:this.filePath}});var e=this.getOptions();this.parsed=h.parse(this.lexed,this.modules,e),this.setModules({inspect:{filePath:this.filePath,parsed:this.parsed}});var t=h.postparse(this.parsed,this.modules,e),r=t.postparsed,n=t.errors;return this.postparsed=r,this.setModules({inspect:{filePath:this.filePath,postparsed:this.postparsed}}),s(this.allErrors,n),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];n.properties||(n.properties={}),n.properties.file=this.filePath}for(var o=0,i=this.modules;o<i.length;o++)e=i[o].errorsTransformer(e)}},{key:"baseNullGetter",value:function(e,t){var r=this,n=this.modules.reduce((function(n,o){return null!=n?n:o.nullGetter(e,t,r)}),null);return null!=n?n:this.nullGetter(e,t)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,relsType:this.relsType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks,stripInvalidXMLChars:this.stripInvalidXMLChars}}},{key:"render",value:function(e){this.filePath=e;var t=this.getOptions();t.resolved=this.scopeManager.resolved,t.scopeManager=this.scopeManager,t.render=p,t.joinUncorrupt=g;var r=p(t),n=r.errors,o=r.parts;return n.length>0?(this.allErrors=n,this.errorChecker(n),this):(this.content=f(o,t),this.setModules({inspect:{filePath:this.filePath,content:this.content}}),this)}}],t&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},71458:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var u=r(62559).wordToUtf8,d=r(86154),h=d.match,p=d.getValue,f=d.getValues;var m={preparse:function(e,t,r){return function(e,r){for(var n=0;n<t.length;n++)e=t[n].preparse(e,r)||e;return e}(e,r)},parse:function(e,t,r){var n,o=!1,a="",d=[],m=r.fileTypeConfig.droppedTagsInsidePlaceholder||[];return e.reduce((function(e,g){return"delimiter"===g.type?(o="start"===g.position,"end"===g.position&&(r.parse=function(e){return function(e,t){var r,n=t.modules,o=t.startOffset,a=t.lIndex;t.offset=o,t.match=h,t.getValue=p,t.getValues=f;var u=function(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n];if(o.matchers){var i=o.matchers(t);if(!(i instanceof Array))throw new Error("module matcher returns a non array");r.push.apply(r,function(e){if(Array.isArray(e))return l(e)}(a=i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||c(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}var a;return r}(n,t),d=function(e,t,r){for(var n=[],o=0;o<e.length;o++){var a=e[o],c=s(a,2),l=c[0],u=c[1],d=a[2]||{};if(r.match(l,t)){var h=r.getValues(l,t);if("function"==typeof d&&(d=d(h)),!d.value){var p=s(h,2);d.value=p[1]}n.push(i({type:"placeholder",prefix:l,module:u,onMatch:d.onMatch,priority:d.priority},d))}}return n}(u,e,t);if(d.length>0){for(var m=null,g=0;g<d.length;g++){var y=d[g];y.priority||(y.priority=-y.value.length),(!m||y.priority>m.priority)&&(m=y)}return m.offset=o,delete m.priority,m.endLindex=a,m.lIndex=a,m.raw=e,m.onMatch&&m.onMatch(m),delete m.onMatch,delete m.prefix,m}for(var v=0;v<n.length;v++)if(r=n[v].parse(e,t))return r.offset=o,r.endLindex=a,r.lIndex=a,r.raw=e,r;return{type:"placeholder",value:e,offset:o,endLindex:a,lIndex:a}}(e,i(i(i({},r),g),{},{startOffset:n,modules:t}))},e.push(r.parse(u(a))),Array.prototype.push.apply(e,d),d=[]),"start"===g.position&&(d=[],n=g.offset),a="",e):o?"content"!==g.type||"insidetag"!==g.position?(-1!==m.indexOf(g.tag)||d.push(g),e):(a+=g.value,e):(e.push(g),e)}),[])},postparse:function(e,t,r){function n(e,r){return t.map((function(t){return t.getTraits(e,r)}))}var o=[];return{postparsed:function e(r,a){return t.reduce((function(t,r){var s=r.postparse(t,i(i({},a),{},{postparse:function(t,r){return e(t,i(i({},a),r))},getTraits:n}));return null==s?t:s.errors?(Array.prototype.push.apply(o,s.errors),s.postparsed):s}),r)}(e,r),errors:o}}};e.exports=m},72324:function(e,t,r){"use strict";var n=r(94758),o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(e,t){if(void 0===e||!e.length)return 0;var r="string"!==n.getTypeOf(e);void 0===t&&(t=0);var i=0;t^=-1;for(var a=0,s=e.length;a<s;a++)i=r?e[a]:e.charCodeAt(a),t=t>>>8^o[255&(t^i)];return~t}},73323:function(e,t,r){"use strict";var n=r(62946).XTInternalError;function o(){}function i(e){return e}e.exports=function(e){var t={set:o,matchers:function(){return[]},parse:o,render:o,getTraits:o,getFileType:o,nullGetter:o,optionsTransformer:i,postrender:i,errorsTransformer:i,getRenderedMap:i,preparse:i,postparse:i,on:o,resolve:o,preResolve:o};if(Object.keys(t).every((function(t){return!e[t]}))){var r=new n("This module cannot be wrapped, because it doesn't define any of the necessary functions");throw r.properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"},r}for(var a in t)e[a]||(e[a]=t[a]);return e}},73666:function(e,t,r){"use strict";var n=r(57817);function o(e){this.data=e,this.length=this.data.length,this.index=0,this.zero=0}o.prototype=new n,o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=o},76314:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);n&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},77659:function(e){"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},79814:function(e){"use strict";e.exports=function(e,t){if(null==e.lIndex)return null;var r=t.scopeManager.scopePathItem;return e.parentPart&&(r=r.slice(0,r.length-1)),t.filePath+"@"+e.lIndex.toString()+"-"+r.join("-")}},80683:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var a=r(62946).getScopeParserExecutionError,s=r(93560).last,c=r(62559).concatArrays;function l(e,t){for(var r,n=e.length>>>0,o=0;o<n;o++)if(r=e[o],t.call(this,r,o,e))return r}function u(e,t,r){var n,o,i=this,s=this.scopeList[r];if(this.root.finishedResolving){for(var c=this.resolved,d=function(){var e=i.scopeLindex[h];c=(c=l(c,(function(t){return t.lIndex===e}))).value[i.scopePathItem[h]]},h=this.resolveOffset,p=this.scopePath.length;h<p;h++)d();return l(c,(function(e){return t.part.lIndex===e.lIndex})).value}o=this.cachedParsers&&t.part?this.cachedParsers[t.part.lIndex]?this.cachedParsers[t.part.lIndex]:this.cachedParsers[t.part.lIndex]=this.parser(e,{tag:t.part,scopePath:this.scopePath}):this.parser(e,{tag:t.part,scopePath:this.scopePath});try{n=o.get(s,this.getContext(t,r))}catch(r){throw a({tag:e,scope:s,error:r,offset:t.part.offset})}return null==n&&r>0?u.call(this,e,t,r-1):n}function d(e,t,r){var n,o=this,i=this.scopeList[r];return n=this.cachedParsers&&t.part?this.cachedParsers[t.part.lIndex]?this.cachedParsers[t.part.lIndex]:this.cachedParsers[t.part.lIndex]=this.parser(e,{tag:t.part,scopePath:this.scopePath}):this.parser(e,{tag:t.part,scopePath:this.scopePath}),Promise.resolve().then((function(){return n.get(i,o.getContext(t,r))})).catch((function(r){throw a({tag:e,scope:i,error:r,offset:t.part.offset})})).then((function(n){return null==n&&r>0?d.call(o,e,t,r-1):n}))}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root=t.root||this,this.resolveOffset=t.resolveOffset||0,this.scopePath=t.scopePath,this.scopePathItem=t.scopePathItem,this.scopePathLength=t.scopePathLength,this.scopeList=t.scopeList,this.scopeType="",this.scopeTypes=t.scopeTypes,this.scopeLindex=t.scopeLindex,this.parser=t.parser,this.resolved=t.resolved,this.cachedParsers=t.cachedParsers}return t=e,(r=[{key:"loopOver",value:function(e,t,r,n){return this.loopOverValue(this.getValue(e,n),t,r)}},{key:"functorIfInverted",value:function(e,t,r,n,o){return e&&t(r,n,o),e}},{key:"isValueFalsy",value:function(e,t){return null==e||!e||"[object Array]"===t&&0===e.length}},{key:"loopOverValue",value:function(e,t,r){this.root.finishedResolving&&(r=!1);var n=Object.prototype.toString.call(e);if(this.isValueFalsy(e,n))return this.scopeType=!1,this.functorIfInverted(r,t,s(this.scopeList),0,1);if("[object Array]"===n){this.scopeType="array";for(var o=0;o<e.length;o++)this.functorIfInverted(!r,t,e[o],o,e.length);return!0}return"[object Object]"===n?(this.scopeType="object",this.functorIfInverted(!r,t,e,0,1)):this.functorIfInverted(!r,t,s(this.scopeList),0,1)}},{key:"getValue",value:function(e,t){var r=u.call(this,e,t,this.scopeList.length-1);return"function"==typeof r?r(this.scopeList[this.scopeList.length-1],this):r}},{key:"getValueAsync",value:function(e,t){var r=this;return d.call(this,e,t,this.scopeList.length-1).then((function(e){return"function"==typeof e?e(r.scopeList[r.scopeList.length-1],r):e}))}},{key:"getContext",value:function(e,t){return{num:t,meta:e,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopeTypes:this.scopeTypes,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(t,r,n,o,i){return new e({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeTypes:c([this.scopeTypes,[this.scopeType]]),scopeList:c([this.scopeList,[t]]),scopePath:c([this.scopePath,[r]]),scopePathItem:c([this.scopePathItem,[n]]),scopePathLength:c([this.scopePathLength,[i]]),scopeLindex:c([this.scopeLindex,[o.lIndex]])})}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();e.exports=function(e){return e.scopePath=[],e.scopePathItem=[],e.scopePathLength=[],e.scopeTypes=[],e.scopeLindex=[],e.scopeList=[e.tags],new h(e)}},80777:function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,o=r(55851);t.uncompressInputType=n?"uint8array":"array",t.compressInputType=n?"uint8array":"array",t.magic="\b\0",t.compress=function(e,t){return o.deflateRaw(e,{level:t.level||-1})},t.uncompress=function(e){return o.inflateRaw(e)}},82810:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var a=r(73323),s=r(62559),c=s.isTextStart,l=s.isTextEnd,u=s.endsWith,d=s.startsWith;function h(e,t){var r=e[t].value;return"</w:t>"===e[t+1].value||-1!==r.indexOf('xml:space="preserve"')?r:r.substr(0,r.length-1)+' xml:space="preserve">'}var p=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="SpacePreserveModule"},(t=[{key:"postparse",value:function(e,t){var r=[],n=!1,o=0,i=0,a=e.reduce((function(e,a){return function(e){return c(e)&&"w:t"===e.tag}(a)&&(n=!0,i=r.length),n?(r.push(a),function(e,t){return e&&e.basePart&&t.length>1}(t,r)&&(o=t.basePart.endLindex,r[0].value=h(r,0)),function(e,t){return"placeholder"===e.type&&t.length>1}(a,r)&&(r[i].value=h(r,i),o=a.endLindex),l(a)&&a.lIndex>o&&(0!==o&&(r[i].value=h(r,i)),Array.prototype.push.apply(e,r),r=[],n=!1,o=0,i=0),e):(e.push(a),e)}),[]);return Array.prototype.push.apply(a,r),a}},{key:"postrender",value:function(e){for(var t="",r=0,n=0,o=e.length;n<o;n++){var i=e[n];""!==i&&(u(t,'<w:t xml:space="preserve">')&&d(i,"</w:t>")&&(e[r]=t.substr(0,t.length-26)+"<w:t/>",i=i.substr(6)),t=i,r=n,e[n]=i)}return e}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return a(new p)}},83315:function(e){"use strict";e.exports="data:,"},84626:function(e,t,r){"use strict";var n=r(28205),o=r(94758),i=r(61485),a=r(56820),s=r(3276);function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},prepareCompressedContent:function(e,t,r){return function(){var n=e.index;e.setIndex(t);var o=e.readData(r);return e.setIndex(n),o}},prepareContent:function(e,t,r,n,i){return function(){var e=o.transformTo(n.uncompressInputType,this.getCompressedContent()),t=n.uncompress(e);if(t.length!==i)throw new Error("Bug : uncompressed data size mismatch");return t}},readLocalPart:function(e){e.skip(22),this.fileNameLength=e.readInt(2);var t=e.readInt(2);if(this.fileName=e.readData(this.fileNameLength),e.skip(t),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");var r=o.findCompression(this.compressionMethod);if(null===r)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");if(this.decompressed=new i,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,r),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,r,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),a.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readInt(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readData(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=new n(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,o=e.index;for(this.extraFields=this.extraFields||{};e.index<o+this.extraFieldsLength;)t=e.readInt(2),r=e.readInt(2),n=e.readString(r),this.extraFields[t]={id:t,length:r,value:n}},handleUTF8:function(){var e=s.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=o.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=o.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new n(e.value);return 1!==t.readInt(1)||a.crc32(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new n(e.value);return 1!==t.readInt(1)||a.crc32(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))}return null}},e.exports=c},85072:function(e){"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],l=n.base?c[0]+n.base:c[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var h=r(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=o(p,n);n.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}a.push(d)}return a}function o(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,o){var i=n(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=r(i[a]);t[s].references--}for(var c=n(e,o),l=0;l<i.length;l++){var u=r(i[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},85668:function(e,t,r){"use strict";for(var n=r(94758),o=r(3276),i=r(49289),a=new Array(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function c(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}function l(e){var t,r,o,i,s=e.length,c=new Array(2*s);for(r=0,t=0;t<s;)if((o=e[t++])<128)c[r++]=o;else if((i=a[o])>4)c[r++]=65533,t+=i-1;else{for(o&=2===i?31:3===i?15:7;i>1&&t<s;)o=o<<6|63&e[t++],i--;i>1?c[r++]=65533:o<65536?c[r++]=o:(o-=65536,c[r++]=55296|o>>10&1023,c[r++]=56320|1023&o)}return c.length!==r&&(c.subarray?c=c.subarray(0,r):c.length=r),n.applyFromCharCode(c)}a[254]=a[254]=1,t.utf8encode=function(e){return o.nodebuffer?i(e,"utf-8"):function(e){var t,r,n,i,a,s=0,c=e.length;for(i=0;i<c;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<c&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=o.uint8array?new Uint8Array(s):new Array(s),a=0,i=0;a<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<c&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t}(e)},t.utf8decode=function(e){if(o.nodebuffer)return n.transformTo("nodebuffer",e).toString("utf-8");for(var t=[],r=(e=n.transformTo(o.uint8array?"uint8array":"array",e)).length,i=0;i<r;){var a=c(e,Math.min(i+65536,r));o.uint8array?t.push(l(e.subarray(i,a))):t.push(l(e.slice(i,a))),i=a}return t.join("")}},86154:function(e){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=new RegExp(String.fromCharCode(160),"g");function n(e){return e.replace(r," ")}e.exports={match:function(e,r){var o=t(e);return"string"===o?n(r.substr(0,e.length))===e:e instanceof RegExp?e.test(n(r)):"function"===o?!!e(r):void 0},getValue:function(e,r){var o=t(e);return"string"===o?n(r).substr(e.length):e instanceof RegExp?n(r).match(e)[1]:"function"===o?e(r):void 0},getValues:function(e,r){var o=t(e);return"string"===o?[r,n(r).substr(e.length)]:e instanceof RegExp?n(r).match(e):"function"===o?[r,e(r)]:void 0}}},87399:function(e,t,r){"use strict";var n=r(64365),o=r(82810),i=r(55892),a=r(93889),s=r(45859);e.exports={docx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(e){return e.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","cp:contentStatus","w:t","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:tbl","w:body","w:document","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sdt","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference","w:bookmarkStart","w:bookmarkEnd","w:commentRangeStart","w:commentRangeEnd","w:commentReference"],droppedTagsInsidePlaceholder:["w:p","w:br","w:bookmarkStart","w:bookmarkEnd"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",baseModules:[n,o,a,i,s],tagShouldContain:[{tag:"w:sdtContent",shouldContain:["w:p","w:r","w:commentRangeStart","w:sdt"],value:"<w:p></w:p>"},{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:tr",shouldContain:["w:tc"],drop:!0},{tag:"w:tbl",shouldContain:["w:tr"],drop:!0}]}},pptx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(e){return e.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:tbl","a:graphicData","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId","a:endParaRPr"],droppedTagsInsidePlaceholder:["a:p","a:endParaRPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",baseModules:[n,a,i,s],tagShouldContain:[{tag:"a:tbl",shouldContain:["a:tr"],dropParent:"p:graphicFrame"},{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}}},93560:function(e){"use strict";e.exports={last:function(e){return e[e.length-1]},first:function(e){return e[0]}}},93889:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var a=r(58134),s=r(62559),c=s.getLeft,l=s.getRight,u=s.pushArray,d=r(73323),h=r(11680).getExpandToDefault,p=r(62946),f=p.getUnmatchedLoopException,m=p.getClosingTagNotMatchOpeningTag,g=p.getUnbalancedLoopException;function y(e){switch(e.location){case"start":return 1;case"end":return-1}}function v(e,t){return null!=e&&null!=t&&("start"===e.part.location&&"end"===t.part.location&&e.part.value===t.part.value||""===t.part.value)}function w(e){for(var t=0,r=[];t<e.length;){var n=e[t].part;if("end"===n.location){if(0===t)return e.splice(0,1),r.push(f(n)),{traits:e,errors:r};var o=t,i=t-1,a=1;if(v(e[i],e[o]))return e.splice(o,1),e.splice(i,1),{errors:r,traits:e};for(;a<50;){var s=e[i-a],c=e[o+a];if(v(s,e[o]))return e.splice(o,1),e.splice(i-a,1),{errors:r,traits:e};if(v(e[i],c))return e.splice(o+a,1),e.splice(i,1),{errors:r,traits:e};a++}return r.push(m({tags:[e[i].part,e[o].part]})),e.splice(o,1),e.splice(i,1),{traits:e,errors:r}}t++}for(var l=0;l<e.length;l++){var u=e[l].part;r.push(f(u))}return{traits:[],errors:r}}var b=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="ExpandPairTrait"},t=[{key:"optionsTransformer",value:function(e,t){return t.options.paragraphLoop&&u(t.fileTypeConfig.expandTags,t.fileTypeConfig.onParagraphLoop),this.expandTags=t.fileTypeConfig.expandTags,e}},{key:"postparse",value:function(e,t){var r=this,n=t.getTraits,o=t.postparse,i=t.fileType,s=n("expandPair",e);s=s.map((function(e){return e||[]}));var d=function(e){var t={},r=[],n=[],o=[];for(u(o,e);o.length>0;){var i=w(o);u(r,i.errors),o=i.traits}if(r.length>0)return{pairs:n,errors:r};for(var a=0,s=0;s<e.length;s++){var c=e[s],l=y(c.part);if(a+=l,1===l)t[a]=c;else{var d=t[a+1];0===a&&n.push([d,c])}a=a>=0?a:0}return{pairs:n,errors:r}}(s=a(s)),p=d.pairs,f=d.errors,m=0,v=null,b=p.map((function(t){var n,o,a=t[0].part.expandTo;if("auto"===a&&"text"!==i){var s=h(e,t,r.expandTags);s.error&&f.push(s.error),a=s.value}if(!a||"text"===i){var u=t[0].offset,d=t[1].offset;return u<m&&!r.docxtemplater.options.syntax.allowUnbalancedLoops&&f.push(g(t,v)),v=t,m=d,[u,d]}try{n=c(e,a,t[0].offset)}catch(e){f.push(e)}try{o=l(e,a,t[1].offset)}catch(e){f.push(e)}return n<m&&!r.docxtemplater.options.syntax.allowUnbalancedLoops&&f.push(g(t,v)),m=o,v=t,[n,o]}));if(f.length>0)return{postparsed:e,errors:f};var A,E=0;return{postparsed:e.reduce((function(t,r,n){var i=E<p.length&&b[E][0]<=n&&n<=b[E][1],a=p[E],s=b[E];if(!i)return t.push(r),t;if(s[0]===n&&(A=[]),a[0].offset!==n&&a[1].offset!==n&&A.push(r),s[1]===n){var c=e[a[0].offset];c.subparsed=o(A,{basePart:c}),c.endLindex=a[1].part.lIndex,delete c.location,delete c.expandTo,t.push(c),E++;for(var l=b[E];l&&l[0]<n;)E++,l=b[E]}return t}),[]),errors:f}}}],t&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return d(new b)}},94758:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var o=r(3276),i=r(35872),a=r(49289);function s(e){return e}function c(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}function l(e){var r=65536,n=[],o=e.length,i=t.getTypeOf(e),s=0,c=!0;try{switch(i){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,a(0))}}catch(e){c=!1}if(!c){for(var l="",u=0;u<e.length;u++)l+=String.fromCharCode(e[u]);return l}for(;s<o&&r>1;)try{"array"===i||"nodebuffer"===i?n.push(String.fromCharCode.apply(null,e.slice(s,Math.min(s+r,o)))):n.push(String.fromCharCode.apply(null,e.subarray(s,Math.min(s+r,o)))),s+=r}catch(e){r=Math.floor(r/2)}return n.join("")}function u(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}t.string2binary=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(255&e.charCodeAt(r));return t},t.arrayBuffer2Blob=function(e,r){t.checkSupport("blob"),r=r||"application/zip";try{return new Blob([e],{type:r})}catch(t){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return n.append(e),n.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}},t.applyFromCharCode=l;var d={};d.string={string:s,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,a(e.length))}},d.array={string:l,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a(e)}},d.arraybuffer={string:function(e){return l(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a(new Uint8Array(e))}},d.uint8array={string:l,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a(e)}},d.nodebuffer={string:l,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:s},t.transformTo=function(e,r){if(r||(r=""),!e)return r;t.checkSupport(e);var n=t.getTypeOf(r);return d[n][e](r)},t.getTypeOf=function(e){if(null!=e){if("string"==typeof e)return"string";var t=Object.prototype.toString.call(e);if("[object Array]"===t)return"array";if(o.nodebuffer&&a.test(e))return"nodebuffer";if(o.uint8array&&"[object Uint8Array]"===t)return"uint8array";if(o.arraybuffer&&"[object ArrayBuffer]"===t)return"arraybuffer";if("[object Promise]"===t)throw new Error("Cannot read data from a promise, you probably are running new PizZip(data) with a promise");if("object"===n(e)&&"function"==typeof e.file)throw new Error("Cannot read data from a pizzip instance, you probably are running new PizZip(zip) with a zipinstance");if("[object Date]"===t)throw new Error("Cannot read data from a Date, you probably are running new PizZip(data) with a date");if("object"===n(e)&&null==e.crc32)throw new Error("Unsupported data given to new PizZip(data) (object given)")}},t.checkSupport=function(e){if(!o[e.toLowerCase()])throw new Error(e+" is not supported by this browser")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},t.findCompression=function(e){for(var t in i)if(i.hasOwnProperty(t)&&i[t].magic===e)return i[t];return null},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r}},95108:function(e,t){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(e){for(var t,n,o,i,a,s,c,l="",u=0;u<e.length;)i=(t=e.charCodeAt(u++))>>2,a=(3&t)<<4|(n=e.charCodeAt(u++))>>4,s=(15&n)<<2|(o=e.charCodeAt(u++))>>6,c=63&o,isNaN(n)?s=c=64:isNaN(o)&&(c=64),l=l+r.charAt(i)+r.charAt(a)+r.charAt(s)+r.charAt(c);return l},t.decode=function(e){var t,n,o,i,a,s,c="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=r.indexOf(e.charAt(l++))<<2|(i=r.indexOf(e.charAt(l++)))>>4,n=(15&i)<<4|(a=r.indexOf(e.charAt(l++)))>>2,o=(3&a)<<6|(s=r.indexOf(e.charAt(l++))),c+=String.fromCharCode(t),64!==a&&(c+=String.fromCharCode(n)),64!==s&&(c+=String.fromCharCode(o));return c}},95624:function(e,t,r){"use strict";var n=r(62566),o=r(38450),i=r(97191),a=r(6479),s=r(15474),c=o.DOMImplementation,l=n.hasDefaultHTMLNamespace,u=n.isHTMLMimeType,d=n.isValidMimeType,h=n.MIME_TYPE,p=n.NAMESPACE,f=i.ParseError,m=s.XMLReader;function g(e){return e.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028\u2029]/g,"\n")}function y(e){if(void 0===(e=e||{}).locator&&(e.locator=!0),this.assign=e.assign||n.assign,this.domHandler=e.domHandler||v,this.onError=e.onError||e.errorHandler,e.errorHandler&&"function"!=typeof e.errorHandler)throw new TypeError("errorHandler object is no longer supported, switch to onError!");e.errorHandler&&e.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=e.normalizeLineEndings||g,this.locator=!!e.locator,this.xmlns=this.assign(Object.create(null),e.xmlns)}function v(e){var t=e||{};this.mimeType=t.mimeType||h.XML_APPLICATION,this.defaultNamespace=t.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=t.onError}function w(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function b(e,t,r){return"string"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}function A(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}y.prototype.parseFromString=function(e,t){if(!d(t))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+t+'" is not valid.');var r=this.assign(Object.create(null),this.xmlns),o=a.XML_ENTITIES,i=r[""]||null;l(t)?(o=a.HTML_ENTITIES,i=p.HTML):t===h.XML_SVG_IMAGE&&(i=p.SVG),r[""]=i,r.xml=r.xml||p.XML;var s=new this.domHandler({mimeType:t,defaultNamespace:i,onError:this.onError}),c=this.locator?{}:void 0;this.locator&&s.setDocumentLocator(c);var u=new m;return u.errorHandler=s,u.domBuilder=s,!n.isHTMLMimeType(t)&&"string"!=typeof e&&u.errorHandler.fatalError("source is not a string"),u.parse(this.normalizeLineEndings(String(e)),r,o),s.doc.documentElement||u.errorHandler.fatalError("missing root element"),s.doc},v.prototype={startDocument:function(){var e=new c;this.doc=u(this.mimeType)?e.createHTMLDocument(!1):e.createDocument(this.defaultNamespace,"")},startElement:function(e,t,r,n){var o=this.doc,i=o.createElementNS(e,r||t),a=n.length;A(this,i),this.currentElement=i,this.locator&&w(this.locator,i);for(var s=0;s<a;s++){e=n.getURI(s);var c=n.getValue(s),l=(r=n.getQName(s),o.createAttributeNS(e,r));this.locator&&w(n.getLocator(s),l),l.value=l.nodeValue=c,i.setAttributeNode(l)}},endElement:function(e,t,r){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&w(this.locator,r),A(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=b.apply(this,arguments)){if(this.cdata)var n=this.doc.createCDATASection(e);else n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&w(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){e&&(e.lineNumber=0),this.locator=e},comment:function(e,t,r){e=b.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&w(this.locator,n),A(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r,n){var o=this.doc.implementation;if(o&&o.createDocumentType){var i=o.createDocumentType(e,t,r,n);this.locator&&w(this.locator,i),A(this,i),this.doc.doctype=i}},reportError:function(e,t){if("function"==typeof this.onError)try{this.onError(e,t,this)}catch(r){throw new f("Reporting "+e+' "'+t+'" caused '+r,this.locator)}else console.error("[xmldom "+e+"]\t"+t,function(e){if(e)return"\n@#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}(this.locator))},warning:function(e){this.reportError("warning",e)},error:function(e){this.reportError("error",e)},fatalError:function(e){throw this.reportError("fatalError",e),new f(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){v.prototype[e]=function(){return null}})),t.__DOMHandler=v,t.DOMParser=y,t.normalizeLineEndings=g,t.onErrorStopParsing=function(e){if("error"===e)throw"onErrorStopParsing"},t.onWarningStopParsing=function(){throw"onWarningStopParsing"}},97191:function(e,t,r){"use strict";function n(e,t){e.prototype=Object.create(Error.prototype,{constructor:{value:e},name:{value:e.name,enumerable:!0,writable:t}})}var o=r(62566).freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),i=Object.keys(o);function a(e){return"number"==typeof e&&e>=1&&e<=25}function s(e,t){var r;a(e)?(this.name=i[e],this.message=t||""):(this.message=e,this.name="string"==typeof(r=t)&&r.substring(r.length-o.Error.length)===o.Error?t:o.Error),Error.captureStackTrace&&Error.captureStackTrace(this,s)}n(s,!0),Object.defineProperties(s.prototype,{code:{enumerable:!0,get:function(){var e=i.indexOf(this.name);return a(e)?e:0}}});for(var c={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},l=Object.entries(c),u=0;u<l.length;u++)s[l[u][0]]=l[u][1];function d(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,d)}n(d),t.DOMException=s,t.DOMExceptionName=o,t.ExceptionCode=c,t.ParseError=d},97825:function(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},97950:function(e,t,r){"use strict";var n=r(28205),o=r(73666),i=r(57817),a=r(63265),s=r(94758),c=r(40277),l=r(84626),u=r(3276);function d(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}d.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(t)+", expected "+s.pretty(e)+")")},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=u.uint8array?"uint8array":"array",r=s.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===c.CENTRAL_FILE_HEADER;)(e=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip : can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ?");this.reader.setIndex(e);var t=e;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(n>0)this.isSignature(t,c.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){var t=s.getTypeOf(e);if(s.checkSupport(t),"string"!==t||u.uint8array)if("nodebuffer"===t)this.reader=new o(e);else if(u.uint8array)this.reader=new i(s.transformTo("uint8array",e));else{if(!u.array)throw new Error("Unexpected error: unsupported type '"+t+"'");this.reader=new a(s.transformTo("array",e))}else this.reader=new n(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=d}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.m=e,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://michel-bodje.github.io/automate/",r.b=document.baseURI||self.location.href,r.nc=void 0,function(){"use strict";var e="word-contract-page",t="schedule-menu-btn",n="conf-menu-btn",o="contract-menu-btn",i="reply-menu-btn",a="user-manual-btn",s="word-contract-menu-btn",c="schedule-lawyer-id",l="conf-lawyer-id",u="contract-lawyer-id",d="reply-lawyer-id",h="schedule-location",p="conf-location",f="schedule-client-language",m="conf-client-language",g="contract-client-language",y="reply-client-language",v="word-client-language",w="schedule-mode",b="manual-date",A="manual-time",E="word-contract-title",C="custom-contract-title",T="case-type",x="case-details",k="other-party-name";function I(e){return{start:new Date(e.getFullYear(),e.getMonth(),e.getDate(),13,0,0,0),end:new Date(e.getFullYear(),e.getMonth(),e.getDate(),14,0,0,0)}}const _={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},S=[_.OPENID_SCOPE,_.PROFILE_SCOPE,_.OFFLINE_ACCESS_SCOPE],L=[...S,_.EMAIL_SCOPE],N="Content-Type",P="Retry-After",O="X-AnchorMailbox",R="x-ms-request-id",M="x-ms-httpver",D="active-account-filters",U="common",q="organizations",B="consumers",H="access_token",F={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},z={PLAIN:"plain",S256:"S256"},j="query",G="Generic",W="-",K={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},$="appmetadata",V="1",Y="authority-metadata",Q="config",X="cache",Z="network",J="hardcoded_values",ee={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},te={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},re="throttling";var ne;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(ne||(ne={}));class oe{constructor(e,t,r){this.level=ne.Info;const n=e||oe.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:ne.Info,this.correlationId=n.correlationId||_.EMPTY_STRING,this.packageName=t||_.EMPTY_STRING,this.packageVersion=r||_.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:ne.Info}}clone(e,t,r){return new oe({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${ne[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:ne.Error,containsPii:!1,correlationId:t||_.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:ne.Error,containsPii:!0,correlationId:t||_.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:ne.Warning,containsPii:!1,correlationId:t||_.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:ne.Warning,containsPii:!0,correlationId:t||_.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:ne.Info,containsPii:!1,correlationId:t||_.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:ne.Info,containsPii:!0,correlationId:t||_.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:ne.Verbose,containsPii:!1,correlationId:t||_.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:ne.Verbose,containsPii:!0,correlationId:t||_.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:ne.Trace,containsPii:!1,correlationId:t||_.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:ne.Trace,containsPii:!0,correlationId:t||_.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const ie="OIDC",ae="EAR",se="none",ce="unexpected_error",le="post_request_failed",ue={[ce]:"Unexpected error in authentication.",[le]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class de extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,de.prototype),this.errorCode=e||_.EMPTY_STRING,this.errorMessage=t||_.EMPTY_STRING,this.subError=r||_.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function he(e,t){return new de(e,t?`${ue[e]} ${t}`:ue[e])}const pe="client_info_decoding_error",fe="client_info_empty_error",me="token_parsing_error",ge="null_or_empty_token",ye="endpoints_resolution_error",ve="network_error",we="openid_config_error",be="hash_not_deserialized",Ae="invalid_state",Ee="state_mismatch",Ce="state_not_found",Te="nonce_mismatch",xe="auth_time_not_found",ke="max_age_transpired",Ie="multiple_matching_tokens",_e="multiple_matching_accounts",Se="multiple_matching_appMetadata",Le="request_cannot_be_made",Ne="cannot_remove_empty_scope",Pe="cannot_append_scopeset",Oe="empty_input_scopeset",Re="device_code_polling_cancelled",Me="device_code_expired",De="device_code_unknown_error",Ue="no_account_in_silent_request",qe="invalid_cache_record",Be="invalid_cache_environment",He="no_account_found",Fe="no_crypto_object",ze="unexpected_credential_type",je="invalid_assertion",Ge="invalid_client_credential",We="token_refresh_required",Ke="user_timeout_reached",$e="token_claims_cnf_required_for_signedjwt",Ve="authorization_code_missing_from_server_response",Ye="binding_key_not_removed",Qe="end_session_endpoint_not_supported",Xe="key_id_missing",Ze="no_network_connectivity",Je="user_canceled",et="missing_tenant_id_error",tt="method_not_implemented",rt="nested_app_auth_bridge_disabled",nt={[pe]:"The client info could not be parsed/decoded correctly",[fe]:"The client info was empty",[me]:"Token cannot be parsed",[ge]:"The token is null or empty",[ye]:"Endpoints cannot be resolved",[ve]:"Network request failed",[we]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[be]:"The hash parameters could not be deserialized",[Ae]:"State was not the expected format",[Ee]:"State mismatch error",[Ce]:"State not found",[Te]:"Nonce mismatch error",[xe]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[ke]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Ie]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[_e]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Se]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Le]:"Token request cannot be made without authorization code or refresh token.",[Ne]:"Cannot remove null or empty scope from ScopeSet",[Pe]:"Cannot append ScopeSet",[Oe]:"Empty input ScopeSet cannot be processed",[Re]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Me]:"Device code is expired.",[De]:"Device code stopped polling for unknown reasons.",[Ue]:"Please pass an account object, silent flow is not supported without account information",[qe]:"Cache record object was null or undefined.",[Be]:"Invalid environment when attempting to create cache entry",[He]:"No account found in cache for given key.",[Fe]:"No crypto object detected.",[ze]:"Unexpected credential type.",[je]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Ge]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[We]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Ke]:"User defined timeout for device code polling reached",[$e]:"Cannot generate a POP jwt if the token_claims are not populated",[Ve]:"Server response does not contain an authorization code to proceed",[Ye]:"Could not remove the credential's binding key from storage.",[Qe]:"The provided authority does not support logout",[Xe]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Ze]:"No network connectivity. Check your internet connection.",[Je]:"User cancelled the flow.",[et]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[tt]:"This method has not been implemented",[rt]:"The nested app auth bridge is disabled"};class ot extends de{constructor(e,t){super(e,t?`${nt[e]}: ${t}`:nt[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,ot.prototype)}}function it(e,t){return new ot(e,t)}const at={createNewGuid:()=>{throw it(tt)},base64Decode:()=>{throw it(tt)},base64Encode:()=>{throw it(tt)},base64UrlEncode:()=>{throw it(tt)},encodeKid:()=>{throw it(tt)},async getPublicKeyThumbprint(){throw it(tt)},async removeTokenBindingKey(){throw it(tt)},async clearKeystore(){throw it(tt)},async signJwt(){throw it(tt)},async hashString(){throw it(tt)}},st="@azure/msal-common",ct="15.4.0";function lt(e,t){const r=function(e){if(!e)throw it(ge);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw it(me);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(e){throw it(me)}}function ut(e,t){if(0===t||Date.now()-3e5>e+t)throw it(ke)}function dt(){return Math.round((new Date).getTime()/1e3)}function ht(e){return e.getTime()/1e3}function pt(e){return e?new Date(1e3*Number(e)):new Date}function ft(e,t){const r=Number(e)||0;return dt()+t>r}function mt(e){return[bt(e),At(e),Et(e),Ct(e),Tt(e)].join(W).toLowerCase()}function gt(e,t,r,n,o){return{credentialType:K.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:o}}function yt(e,t,r,n,o,i,a,s,c,l,u,d,h,p,f){const m={homeAccountId:e,credentialType:K.ACCESS_TOKEN,secret:r,cachedAt:dt().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:o,target:i,tokenType:u||te.BEARER};if(d&&(m.userAssertionHash=d),l&&(m.refreshOn=l.toString()),p&&(m.requestedClaims=p,m.requestedClaimsHash=f),m.tokenType?.toLowerCase()!==te.BEARER.toLowerCase())switch(m.credentialType=K.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case te.POP:const e=lt(r,c);if(!e?.cnf?.kid)throw it($e);m.keyId=e.cnf.kid;break;case te.SSH:m.keyId=h}return m}function vt(e,t,r,n,o,i,a){const s={credentialType:K.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function wt(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function bt(e){return[e.homeAccountId,e.environment].join(W).toLowerCase()}function At(e){const t=e.credentialType===K.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(W).toLowerCase()}function Et(e){return(e.target||"").toLowerCase()}function Ct(e){return(e.requestedClaimsHash||"").toLowerCase()}function Tt(e){return e.tokenType&&e.tokenType.toLowerCase()!==te.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function xt(){return dt()+86400}function kt(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function It(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function _t(e){return e.expiresAt<=dt()}const St="redirect_uri_empty",Lt="claims_request_parsing_error",Nt="authority_uri_insecure",Pt="url_parse_error",Ot="empty_url_error",Rt="empty_input_scopes_error",Mt="invalid_prompt_value",Dt="invalid_claims",Ut="token_request_empty",qt="logout_request_empty",Bt="invalid_code_challenge_method",Ht="pkce_params_missing",Ft="invalid_cloud_discovery_metadata",zt="invalid_authority_metadata",jt="untrusted_authority",Gt="missing_ssh_jwk",Wt="missing_ssh_kid",Kt="missing_nonce_authentication_header",$t="invalid_authentication_header",Vt="cannot_set_OIDCOptions",Yt="cannot_allow_platform_broker",Qt="authority_mismatch",Xt={[St]:"A redirect URI is required for all calls, and none has been set.",[Lt]:"Could not parse the given claims request object.",[Nt]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Pt]:"URL could not be parsed into appropriate segments.",[Ot]:"URL was empty or null.",[Rt]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Mt]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Dt]:"Given claims parameter must be a stringified JSON object.",[Ut]:"Token request was empty and not found in cache.",[qt]:"The logout request was null or undefined.",[Bt]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Ht]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Ft]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[zt]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[jt]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Gt]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Wt]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Kt]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[$t]:"Invalid authentication header provided",[Vt]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Yt]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Qt]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Zt extends de{constructor(e){super(e,Xt[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Zt.prototype)}}function Jt(e){return new Zt(e)}class er{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach((e=>{if(e.trim()){const[r,o]=e.split(/=(.+)/g,2);r&&o&&(t[n(r)]=n(o))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class tr{constructor(e){const t=e?er.trimArrayEntries([...e]):[],r=t?er.removeEmptyStringsFromArray(t):[];if(!r||!r.length)throw Jt(Rt);this.scopes=new Set,r.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||_.EMPTY_STRING).split(" ");return new tr(t)}static createSearchScopes(e){const t=new tr(e);return t.containsOnlyOIDCScopes()?t.removeScope(_.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new tr(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return L.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(e){throw it(Pe)}}removeScope(e){if(!e)throw it(Ne);this.scopes.delete(e.trim())}removeOIDCScopes(){L.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw it(Oe);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw it(Oe);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){return this.scopes?this.asArray().join(" "):_.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function rr(e,t){if(!e)throw it(fe);try{const r=t(e);return JSON.parse(r)}catch(e){throw it(pe)}}function nr(e){if(!e)throw it(pe);const t=e.split(".",2);return{uid:t[0],utid:t.length<2?_.EMPTY_STRING:t[1]}}function or(e,t){return!!e&&!!t&&e===t.split(".")[1]}function ir(e,t,r,n){if(n){const{oid:t,sub:r,tid:o,name:i,tfp:a,acr:s}=n,c=o||a||s||"";return{tenantId:c,localAccountId:t||r||"",name:i,isHomeTenant:or(c,e)}}return{tenantId:r,localAccountId:t,isHomeTenant:or(r,e)}}function ar(e,t,r,n){let o=e;if(t){const{isHomeTenant:r,...n}=t;o={...e,...n}}if(r){const{isHomeTenant:t,...i}=ir(e.homeAccountId,e.localAccountId,e.tenantId,r);return o={...o,...i,idTokenClaims:r,idToken:n},o}return o}function sr(e){return e&&(e.tid||e.tfp||e.acr)||null}class cr{generateAccountId(){return[this.homeAccountId,this.environment].join(W).toLowerCase()}generateAccountKey(){return cr.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((e=>[e.tenantId,e])))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(W).toLowerCase()}static createAccount(e,t,r){const n=new cr;let o;1===t.authorityType?n.authorityType="ADFS":t.protocolMode===ie?n.authorityType=G:n.authorityType="MSSTS",e.clientInfo&&r&&(o=rr(e.clientInfo,r)),n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const i=e.environment||t&&t.getPreferredCache();if(!i)throw it(Be);n.environment=i,n.realm=o?.utid||sr(e.idTokenClaims)||"",n.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(n.username=a||s||"",n.name=e.idTokenClaims?.name||"",n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,e.tenantProfiles)n.tenantProfiles=e.tenantProfiles;else{const t=ir(e.homeAccountId,n.localAccountId,n.realm,e.idTokenClaims);n.tenantProfiles=[t]}return n}static createFromAccountInfo(e,t,r){const n=new cr;return n.authorityType=e.authorityType||G,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,o){if(1!==t&&2!==t){if(e)try{const t=rr(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},o=t.idTokenClaims||{};n=r.iat===o.iat&&r.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function lr(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function ur(e){if(!e||e.indexOf("=")<0)return null;try{const t=lr(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch(e){throw it(be)}return null}function dr(e){const t=new Array;return e.forEach(((e,r)=>{t.push(`${r}=${encodeURIComponent(e)}`)})),t.join("&")}class hr{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Jt(Ot);e.includes("#")||(this._urlString=hr.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return er.endsWith(t,"?")?t=t.slice(0,-1):er.endsWith(t,"?/")&&(t=t.slice(0,-2)),er.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw Jt(Pt)}if(!e.HostNameAndPort||!e.PathSegments)throw Jt(Pt);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Jt(Nt)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return hr.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==U&&r[0]!==q||(r[0]=e),hr.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Jt(Pt);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let n=r.AbsolutePath.split("/");return n=n.filter((e=>e&&e.length>0)),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Jt(Pt);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===_.FORWARD_SLASH){const r=new hr(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new hr(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!ur(e)}}const pr={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},fr={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},mr=new Set;function gr(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){const o=yr(t,e);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function yr(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}fr.metadata.forEach((e=>{e.aliases.forEach((e=>{mr.add(e)}))}));const vr="cache_quota_exceeded",wr="cache_error_unknown",br={[vr]:"Exceeded cache storage capacity.",[wr]:"Unexpected error occurred when using cache storage."};class Ar extends Error{constructor(e,t){const r=t||(br[e]?br[e]:br[wr]);super(`${e}: ${r}`),Object.setPrototypeOf(this,Ar.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}class Er{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(st,ct),this.staticAuthorityOptions=n}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort((e=>e.idTokenClaims?-1:1))[0]:1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap((e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t)))}getTenantedAccountInfoByFilter(e,t,r,n){let o,i=null;if(n&&!this.tenantProfileMatchesFilter(r,n))return null;const a=this.getIdToken(e,t,r.tenantId);return a&&(o=lt(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,n))?null:(i=ar(e,r,o,a?.secret),i)}getTenantProfilesFromAccountEntity(e,t,r){const n=e.getAccountInfo();let o=n.tenantProfiles||new Map;const i=this.getTokenKeys();if(t){const e=o.get(t);if(!e)return[];o=new Map([[t,e]])}const a=[];return o.forEach((e=>{const t=this.getTenantedAccountInfoByFilter(n,i,e,r);t&&a.push(t)})),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||void 0!==t.isHomeTenant&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,r){if(!e)throw it(qe);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==r?.idToken&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==r?.accessToken&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==r?.refreshToken&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e.message}`,t),"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new Ar(vr)):new Ar(e.name,e.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e}`,t),new Ar(wr))}}async saveAccessToken(e,t){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=tr.fromString(e.target),i=[];n.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,r)&&tr.fromString(t.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(e))})),await Promise.all(i),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId))return;const n=this.getAccount(t,this.commonLogger);if(!n)return;if(e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId))return;if(e.username&&!this.matchUsername(n.username,e.username))return;if(e.environment&&!this.matchEnvironment(n,e.environment))return;if(e.realm&&!this.matchRealm(n,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(n,e.authorityType))return;const o={localAccountId:e?.localAccountId,name:e?.name},i=n.tenantProfiles?.filter((e=>this.tenantProfileMatchesFilter(e,o)));i&&0===i.length||r.push(n)})),r}isAccountKey(e,t,r){return!(e.split(W).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(W).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(K.ID_TOKEN.toLowerCase())&&-1===t.indexOf(K.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(K.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(K.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(K.REFRESH_TOKEN.toLowerCase())>-1){const e=`${K.REFRESH_TOKEN}${W}${this.clientId}${W}`,r=`${K.REFRESH_TOKEN}${W}${V}${W}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===K.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===te.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach((t=>{if(!this.isAppMetadata(t))return;const n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))})),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)})),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach((e=>{0===e.indexOf(r)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)})),await Promise.all(n)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===K.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===te.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(e){throw it(Ye)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readAccountFromCache(e){const t=cr.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:K.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(i,t),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let t=a;if(!r){const r=new Map;a.forEach(((t,n)=>{t.realm===e.tenantId&&r.set(n,t)}));const n=r.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),r.values().next().value;t=r}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach(((e,t)=>{this.removeIdToken(t)})),n&&o&&n.addFields({multiMatchedID:a.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,n=new Map;return r.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.set(t,r)})),n}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,n,o,i){this.commonLogger.trace("CacheManager - getAccessToken called");const a=tr.createSearchScopes(t.scopes),s=t.authenticationScheme||te.BEARER,c=s&&s.toLowerCase()!==te.BEARER.toLowerCase()?K.ACCESS_TOKEN_WITH_AUTH_SCHEME:K.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:n||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=r&&r.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,l)&&d.push(t)}}));const h=d.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach((e=>{this.removeAccessToken(mt(e))})),o&&i&&o.addFields({multiMatchedAT:d.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)})),r}getRefreshToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?V:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:K.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];s.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,a)&&c.push(t)}}));const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&n&&o&&n.addFields({multiMatchedRT:l},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&-1===r.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((e=>r[e])),o=n.length;if(o<1)return null;if(o>1)throw it(Se);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==V)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!=typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=function(e,t){let r;const n=e.canonicalAuthority;if(n){const o=new hr(n).getUrlComponents().HostNameAndPort;r=gr(o,e.cloudDiscoveryMetadata?.metadata,Q,t)||gr(o,fr.metadata,J,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){return!(e.credentialType!==K.ACCESS_TOKEN&&e.credentialType!==K.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&tr.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf($)}isAuthorityMetadata(e){return-1!==e.indexOf(Y)}generateAuthorityMetadataCacheKey(e){return`${Y}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class Cr extends Er{async setAccount(){throw it(tt)}getAccount(){throw it(tt)}async setIdTokenCredential(){throw it(tt)}getIdTokenCredential(){throw it(tt)}async setAccessTokenCredential(){throw it(tt)}getAccessTokenCredential(){throw it(tt)}async setRefreshTokenCredential(){throw it(tt)}getRefreshTokenCredential(){throw it(tt)}setAppMetadata(){throw it(tt)}getAppMetadata(){throw it(tt)}setServerTelemetry(){throw it(tt)}getServerTelemetry(){throw it(tt)}setAuthorityMetadata(){throw it(tt)}getAuthorityMetadata(){throw it(tt)}getAuthorityMetadataKeys(){throw it(tt)}setThrottlingCache(){throw it(tt)}getThrottlingCache(){throw it(tt)}removeItem(){throw it(tt)}getKeys(){throw it(tt)}getAccountKeys(){throw it(tt)}getTokenKeys(){throw it(tt)}}const Tr={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},xr={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:ne.Info,correlationId:_.EMPTY_STRING},kr={claimsBasedCachingEnabled:!1},Ir={async sendGetRequestAsync(){throw it(tt)},async sendPostRequestAsync(){throw it(tt)}},_r={sku:_.SKU,version:ct,cpu:_.EMPTY_STRING,os:_.EMPTY_STRING},Sr={clientSecret:_.EMPTY_STRING,clientAssertion:void 0},Lr={azureCloudInstance:se,tenant:`${_.DEFAULT_COMMON_TENANT}`},Nr={application:{appName:"",appVersion:""}};function Pr(e){return e.authOptions.authority.options.protocolMode===ie}const Or={sendGetRequestAsync:()=>Promise.reject(it(tt)),sendPostRequestAsync:()=>Promise.reject(it(tt))},Rr="acquireTokenByCode",Mr="acquireTokenByRefreshToken",Dr="acquireTokenSilent",Ur="acquireTokenSilentAsync",qr="acquireTokenPopup",Br="acquireTokenRedirect",Hr="cryptoOptsGetPublicKeyThumbprint",Fr="cryptoOptsSignJwt",zr="silentCacheClientAcquireToken",jr="silentIframeClientAcquireToken",Gr="silentRefreshClientAcquireToken",Wr="ssoSilent",Kr="standardInteractionClientGetDiscoveredAuthority",$r="nativeInteractionClientAcquireToken",Vr="networkClientSendPostRequestAsync",Yr="refreshTokenClientExecutePostToTokenEndpoint",Qr="authorizationCodeClientExecutePostToTokenEndpoint",Xr="refreshTokenClientExecuteTokenRequest",Zr="refreshTokenClientAcquireToken",Jr="refreshTokenClientAcquireTokenWithCachedRefreshToken",en="refreshTokenClientAcquireTokenByRefreshToken",tn="refreshTokenClientCreateTokenRequestBody",rn="acquireTokenFromCache",nn="silentFlowClientAcquireCachedToken",on="silentFlowClientGenerateResultFromCacheRecord",an="acquireTokenBySilentIframe",sn="initializeBaseRequest",cn="initializeSilentRequest",ln="initializeClientApplication",un="initializeCache",dn="silentIframeClientTokenHelper",hn="silentHandlerInitiateAuthRequest",pn="silentHandlerMonitorIframeForHash",fn="silentHandlerLoadFrame",mn="silentHandlerLoadFrameSync",gn="standardInteractionClientCreateAuthCodeClient",yn="standardInteractionClientGetClientConfiguration",vn="standardInteractionClientInitializeAuthorizationRequest",wn="getAuthCodeUrl",bn="handleCodeResponseFromServer",An="handleCodeResponse",En="handleResponseEar",Cn="handleResponsePlatformBroker",Tn="handleResponseCode",xn="updateTokenEndpointAuthority",kn="authClientAcquireToken",In="authClientExecuteTokenRequest",_n="authClientCreateTokenRequestBody",Sn="popTokenGenerateCnf",Ln="popTokenGenerateKid",Nn="handleServerTokenResponse",Pn="deserializeResponse",On="authorityFactoryCreateDiscoveredInstance",Rn="authorityResolveEndpointsAsync",Mn="authorityGetCloudDiscoveryMetadataFromNetwork",Dn="authorityUpdateCloudDiscoveryMetadata",Un="authorityGetEndpointMetadataFromNetwork",qn="authorityUpdateEndpointMetadata",Bn="authorityUpdateMetadataWithRegionalInformation",Hn="regionDiscoveryDetectRegion",Fn="regionDiscoveryGetRegionFromIMDS",zn="regionDiscoveryGetCurrentVersion",jn="acquireTokenByCodeAsync",Gn="handleRedirectPromise",Wn="handleNativeRedirectPromise",Kn="nativeMessageHandlerHandshake",$n="removeHiddenIframe",Vn="clearTokensAndKeysWithClaims",Yn="cacheManagerGetRefreshToken",Qn="importExistingCache",Xn="setUserData",Zn="localStorageUpdated",Jn="generatePkceCodes",eo="generateCodeVerifier",to="generateCodeChallengeFromVerifier",ro="sha256Digest",no="getRandomValues",oo="generateHKDF",io="generateBaseKey",ao="base64Decode",so="urlEncodeArr",co="encrypt",lo="decrypt",uo="generateEarKey",ho="decryptEarResponse",po=(new Map([[Rr,"ATByCode"],[Mr,"ATByRT"],[Dr,"ATS"],[Ur,"ATSAsync"],[qr,"ATPopup"],[Br,"ATRedirect"],[Hr,"CryptoGetPKThumb"],[Fr,"CryptoSignJwt"],[zr,"SltCacheClientAT"],[jr,"SltIframeClientAT"],[Gr,"SltRClientAT"],[Wr,"SsoSlt"],[Kr,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[$r,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Vr,"NetClientSendPost"],[Yr,"RTClientExecPost"],[Qr,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[Xr,"RTClientExecTReq"],[Zr,"RTClientAT"],[Jr,"RTClientATWithCachedRT"],[en,"RTClientATByRT"],[tn,"RTClientCreateTReqBody"],[rn,"ATFromCache"],[nn,"SltFlowClientATCached"],[on,"SltFlowClientGenResFromCache"],[an,"ATBySltIframe"],[sn,"InitBaseReq"],[cn,"InitSltReq"],[ln,"InitClientApplication"],[un,"InitCache"],[Qn,"importCache"],[Xn,"setUserData"],[Zn,"localStorageUpdated"],[dn,"SIClientTHelper"],[hn,"SHandlerInitAuthReq"],[pn,"SltHandlerMonitorIframeForHash"],[fn,"SHandlerLoadFrame"],[mn,"SHandlerLoadFrameSync"],[gn,"StdIntClientCreateAuthCodeClient"],[yn,"StdIntClientGetClientConf"],[vn,"StdIntClientInitAuthReq"],[wn,"GetAuthCodeUrl"],[bn,"HandleCodeResFromServer"],[An,"HandleCodeResp"],[En,"HandleRespEar"],[Tn,"HandleRespCode"],[Cn,"HandleRespPlatBroker"],[xn,"UpdTEndpointAuth"],[kn,"AuthClientAT"],[In,"AuthClientExecTReq"],[_n,"AuthClientCreateTReqBody"],[Sn,"PopTGenCnf"],[Ln,"PopTGenKid"],[Nn,"HandleServerTRes"],[Pn,"DeserializeRes"],[On,"AuthFactCreateDiscInst"],[Rn,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[Mn,"AuthGetCDMetaFromNet"],[Dn,"AuthUpdCDMeta"],[Un,"AuthUpdCDMetaFromNet"],[qn,"AuthUpdEndpointMeta"],[Bn,"AuthUpdMetaWithRegInfo"],[Hn,"RegDiscDetectReg"],[Fn,"RegDiscGetRegFromIMDS"],[zn,"RegDiscGetCurrentVer"],[jn,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[Gn,"HandleRedirectPromise"],[Wn,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[Kn,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[$n,"RemoveHiddenIframe"],[Vn,"ClearTAndKeysWithClaims"],[Yn,"CacheManagerGetRT"],[Jn,"GenPkceCodes"],[eo,"GenCodeVerifier"],[to,"GenCodeChallengeFromVerifier"],[ro,"Sha256Digest"],[no,"GetRandomValues"],[oo,"genHKDF"],[io,"genBaseKey"],[ao,"b64Decode"],[so,"urlEncArr"],[co,"encrypt"],[lo,"decrypt"],[uo,"genEarKey"],[ho,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount"]);class fo{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class mo{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:po,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new fo}}startPerformanceMeasurement(){return new fo}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const go="invalid_grant",yo="msal",vo="msal.js.browser",wo="53ee284d-920a-4b59-9d30-a60315b26836",bo="ppnbnpeolgkicgegkbkbjmhlideopiji",Ao="Handshake",Eo="GetToken",Co="localStorage",To="sessionStorage",xo="memoryStorage",ko="request.origin",Io="urlHash",_o="request.params",So="code.verifier",Lo="interaction.status",No="request.native",Po="msal.account.keys",Oo="msal.token.keys",Ro="wrapper.sku",Mo="wrapper.version",Do=861,Uo=862;var qo;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(qo||(qo={}));const Bo={scopes:S},Ho="msal.db",Fo=`${Ho}.keys`,zo=[0,5,4];class jo{navigateInternal(e,t){return jo.defaultNavigateWindow(e,t)}navigateExternal(e,t){return jo.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}class Go extends de{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Go.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function Wo(e,t,r){return new Go(e,t,r)}const Ko="pkce_not_created",$o="ear_jwk_empty",Vo="ear_jwe_empty",Yo="crypto_nonexistent",Qo="empty_navigate_uri",Xo="hash_empty_error",Zo="no_state_in_hash",Jo="hash_does_not_contain_known_properties",ei="unable_to_parse_state",ti="state_interaction_type_mismatch",ri="interaction_in_progress",ni="popup_window_error",oi="empty_window_error",ii="user_cancelled",ai="monitor_popup_timeout",si="monitor_window_timeout",ci="redirect_in_iframe",li="block_iframe_reload",ui="block_nested_popups",di="iframe_closed_prematurely",hi="silent_logout_unsupported",pi="no_account_error",fi="silent_prompt_value_error",mi="no_token_request_cache_error",gi="unable_to_parse_token_request_cache_error",yi="auth_request_not_set_error",vi="invalid_cache_type",wi="non_browser_environment",bi="database_not_open",Ai="no_network_connectivity",Ei="post_request_failed",Ci="get_request_failed",Ti="failed_to_parse_response",xi="unable_to_load_token",ki="crypto_key_not_found",Ii="auth_code_required",_i="auth_code_or_nativeAccountId_required",Si="spa_code_and_nativeAccountId_present",Li="database_unavailable",Ni="unable_to_acquire_token_from_native_platform",Pi="native_handshake_timeout",Oi="native_extension_not_installed",Ri="native_connection_not_established",Mi="uninitialized_public_client_application",Di="native_prompt_not_supported",Ui="invalid_base64_string",qi="invalid_pop_token_request",Bi="failed_to_build_headers",Hi="failed_to_parse_headers",Fi="failed_to_decrypt_ear_response",zi="For more visit: aka.ms/msaljs/browser-errors",ji={[Ko]:"The PKCE code challenge and verifier could not be generated.",[$o]:"No EAR encryption key provided. This is unexpected.",[Vo]:"Server response does not contain ear_jwe property. This is unexpected.",[Yo]:"The crypto object or function is not available.",[Qo]:"Navigation URI is empty. Please check stack trace for more info.",[Xo]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${zi}`,[Zo]:"Hash does not contain state. Please verify that the request originated from msal.",[Jo]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${zi}`,[ei]:"Unable to parse state. Please verify that the request originated from msal.",[ti]:"Hash contains state but the interaction type does not match the caller.",[ri]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${zi}`,[ni]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[oi]:"window.open returned null or undefined window object.",[ii]:"User cancelled the flow.",[ai]:`Token acquisition in popup failed due to timeout.  ${zi}`,[si]:`Token acquisition in iframe failed due to timeout.  ${zi}`,[ci]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[li]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${zi}`,[ui]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[di]:"The iframe being monitored was closed prematurely.",[hi]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[pi]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[fi]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[mi]:"No token request found in cache.",[gi]:"The cached token request could not be parsed.",[yi]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[vi]:"Invalid cache type",[wi]:"Login and token requests are not supported in non-browser environments.",[bi]:"Database is not open!",[Ai]:"No network connectivity. Check your internet connection.",[Ei]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Ci]:"Network request failed. Please check the network trace to determine root cause.",[Ti]:"Failed to parse network response. Check network trace.",[xi]:"Error loading token to cache.",[ki]:"Cryptographic Key or Keypair not found in browser storage.",[Ii]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[_i]:"An authorization code or nativeAccountId must be provided to this flow.",[Si]:"Request cannot contain both spa code and native account id.",[Li]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Ni]:`Unable to acquire token from native platform.  ${zi}`,[Pi]:"Timed out while attempting to establish connection to browser extension",[Oi]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Ri]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${zi}`,[Mi]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${zi}`,[Di]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Ui]:"Invalid base64 encoded string.",[qi]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Bi]:"Failed to build request headers object.",[Hi]:"Failed to parse response headers",[Fi]:"Failed to decrypt ear response"};class Gi extends de{constructor(e,t){super(e,ji[e],t),Object.setPrototypeOf(this,Gi.prototype),this.name="BrowserAuthError"}}function Wi(e,t){return new Gi(e,t)}class Ki{async sendGetRequestAsync(e,t){let r,n={},o=0;const i=$i(t);try{r=await fetch(e,{method:"GET",headers:i})}catch(e){throw Wi(window.navigator.onLine?Ci:Ai)}n=Vi(r.headers);try{return o=r.status,{headers:n,body:await r.json(),status:o}}catch(e){throw Wo(Wi(Ti),o,n)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",n=$i(t);let o,i=0,a={};try{o=await fetch(e,{method:"POST",headers:n,body:r})}catch(e){throw Wi(window.navigator.onLine?Ei:Ai)}a=Vi(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(e){throw Wo(Wi(Ti),i,a)}}}function $i(e){try{const t=new Headers;if(!e||!e.headers)return t;const r=e.headers;return Object.entries(r).forEach((([e,r])=>{t.append(e,r)})),t}catch(e){throw Wi(Bi)}}function Vi(e){try{const t={};return e.forEach(((e,r)=>{t[r]=e})),t}catch(e){throw Wi(Hi)}}function Yi(e){return encodeURIComponent(Xi(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Qi(e){return Zi(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Xi(e){return Zi((new TextEncoder).encode(e))}function Zi(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}function Ji(e){return(new TextDecoder).decode(ea(e))}function ea(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Wi(Ui)}const r=atob(t);return Uint8Array.from(r,(e=>e.codePointAt(0)||0))}const ta="AES-GCM",ra="HKDF",na="SHA-256",oa=new Uint8Array([1,0,1]),ia="0123456789abcdef",aa=new Uint32Array(1),sa="raw",ca="encrypt",la="decrypt",ua={name:"RSASSA-PKCS1-v1_5",hash:na,modulusLength:2048,publicExponent:oa};async function da(e,t,r){t?.addQueueMeasurement(ro,r);const n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(na,n)}function ha(e){return window.crypto.getRandomValues(e)}function pa(){return window.crypto.getRandomValues(aa),aa[0]}function fa(){const e=Date.now(),t=1024*pa()+(1023&pa()),r=new Uint8Array(16),n=Math.trunc(t/2**30),o=t&2**30-1,i=pa();r[0]=e/2**40,r[1]=e/2**32,r[2]=e/2**24,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let a="";for(let e=0;e<r.length;e++)a+=ia.charAt(r[e]>>>4),a+=ia.charAt(15&r[e]),3!==e&&5!==e&&7!==e&&9!==e||(a+="-");return a}async function ma(e){return window.crypto.subtle.exportKey("jwk",e)}async function ga(){const e=await va(),t={alg:"dir",kty:"oct",k:Qi(new Uint8Array(e))};return Xi(JSON.stringify(t))}async function ya(e,t){const r=t.split(".");if(5!==r.length)throw Wi(Fi,"jwe_length");const n=await async function(e){const t=Ji(e),r=ea(JSON.parse(t).k);return window.crypto.subtle.importKey(sa,r,ta,!1,[la])}(e).catch((()=>{throw Wi(Fi,"import_key")}));try{const e=(new TextEncoder).encode(r[0]),t=ea(r[2]),o=ea(r[3]),i=ea(r[4]),a=8*i.byteLength,s=new Uint8Array(o.length+i.length);s.set(o),s.set(i,o.length);const c=await window.crypto.subtle.decrypt({name:ta,iv:t,tagLength:a,additionalData:e},n,s);return(new TextDecoder).decode(c)}catch(e){throw Wi(Fi,"decrypt")}}async function va(){const e=await window.crypto.subtle.generateKey({name:ta,length:256},!0,[ca,la]);return window.crypto.subtle.exportKey(sa,e)}async function wa(e){return window.crypto.subtle.importKey(sa,e,ra,!1,["deriveKey"])}async function ba(e,t,r){return window.crypto.subtle.deriveKey({name:ra,salt:t,hash:na,info:(new TextEncoder).encode(r)},e,{name:ta,length:256},!1,[ca,la])}async function Aa(e,t,r){const n=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await ba(e,o,r),a=await window.crypto.subtle.encrypt({name:ta,iv:new Uint8Array(12)},i,n);return{data:Qi(new Uint8Array(a)),nonce:Qi(o)}}async function Ea(e,t,r,n){const o=ea(n),i=await ba(e,ea(t),r),a=await window.crypto.subtle.decrypt({name:ta,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)}async function Ca(e){const t=await da(e);return Qi(new Uint8Array(t))}const Ta="storage_not_supported",xa="stubbed_public_client_application_called",ka="in_mem_redirect_unavailable",Ia={[Ta]:"Given storage configuration option was not supported.",[xa]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[ka]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class _a extends de{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,_a.prototype)}}function Sa(e){return new _a(e,Ia[e])}function La(){return window.parent!==window}function Na(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Pa(){if("undefined"==typeof window)throw Wi(wi)}function Oa(e){if(!e)throw Wi(Mi)}function Ra(e){Pa(),function(){if(hr.hashContainsKnownProperties(window.location.hash)&&La())throw Wi(li)}(),function(){if("undefined"!=typeof window&&window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${yo}.`))throw Wi(ui)}(),Oa(e)}function Ma(e,t){if(Ra(e),function(e){if(La()&&!e)throw Wi(ci)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===xo&&!t.cache.storeAuthStateInCookie)throw Sa(ka)}function Da(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((()=>{try{document.head.removeChild(t)}catch{}}),1e4)}const Ua="4.9.1";class qa{static loggerCallback(e,t){switch(e){case ne.Error:return void console.error(t);case ne.Info:return void console.info(t);case ne.Verbose:return void console.debug(t);case ne.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){let t;this.browserEnvironment="undefined"!=typeof window,this.config=function({auth:e,cache:t,system:r,telemetry:n},o){const i={clientId:_.EMPTY_STRING,authority:`${_.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:_.EMPTY_STRING,authorityMetadata:_.EMPTY_STRING,redirectUri:"undefined"!=typeof window?Na():"",postLogoutRedirectUri:_.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:"AAD",OIDCOptions:{serverResponseType:"fragment",defaultScopes:[_.OPENID_SCOPE,_.PROFILE_SCOPE,_.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:se,tenant:_.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},a={cacheLocation:To,temporaryCacheLocation:To,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!t||t.cacheLocation!==Co),claimsBasedCachingEnabled:!1},s={loggerCallback:()=>{},logLevel:ne.Info,piiLoggingEnabled:!1},c={...{...Tr,loggerOptions:s,networkClient:o?new Ki:Or,navigationClient:new jo,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||6e4,iframeHashTimeout:r?.loadFrameTimeout||1e4,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:30},...r,loggerOptions:r?.loggerOptions||s},l={application:{appName:_.EMPTY_STRING,appVersion:_.EMPTY_STRING},client:new mo};if(e?.protocolMode!==ie&&e?.OIDCOptions&&new oe(c.loggerOptions).warning(JSON.stringify(Jt(Vt))),e?.protocolMode&&e.protocolMode===ie&&c?.allowPlatformBroker)throw Jt(Yt);return{auth:{...i,...e,OIDCOptions:{...i.OIDCOptions,...e?.OIDCOptions}},cache:{...a,...t},system:c,telemetry:{...l,...n}}}(e,this.browserEnvironment);try{t=window[To]}catch(e){}const r=t?.getItem("msal.browser.log.level"),n=t?.getItem("msal.browser.log.pii")?.toLowerCase(),o="true"===n||"false"!==n&&void 0,i={...this.config.system.loggerOptions},a=r&&Object.keys(ne).includes(r)?ne[r]:void 0;a&&(i.loggerCallback=qa.loggerCallback,i.logLevel=a),void 0!==o&&(i.piiLoggingEnabled=o),this.logger=new oe(i,"@azure/msal-browser",Ua),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class Ba extends qa{getModuleName(){return Ba.MODULE_NAME}getId(){return Ba.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}Ba.MODULE_NAME="",Ba.ID="StandardOperatingContext";const Ha="missing_kid_error",Fa="missing_alg_error",za={[Ha]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Fa]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class ja extends de{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,ja.prototype)}}function Ga(e){return new ja(e,za[e])}class Wa{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Ga(Ha);if(!e.alg)throw Ga(Fa);const t=new Wa({typ:e.typ||"pop",kid:e.kid,alg:e.alg});return JSON.stringify(t)}}class Ka{constructor(){this.dbName=Ho,this.version=1,this.tableName=Fo,this.dbOpen=!1}async open(){return new Promise(((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),r.addEventListener("success",(t=>{const r=t;this.db=r.target.result,this.dbOpen=!0,e()})),r.addEventListener("error",(()=>t(Wi(Li))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Wi(bi));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new Promise(((r,n)=>{if(!this.db)return n(Wi(bi));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",(()=>{this.closeConnection(),r()})),o.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Wi(bi));const n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",(()=>{this.closeConnection(),t()})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Promise(((e,t)=>{if(!this.db)return t(Wi(bi));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",(t=>{const r=t;this.closeConnection(),e(r.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r(Wi(bi));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(1===r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise(((e,t)=>{const r=window.indexedDB.deleteDatabase(Ho),n=setTimeout((()=>t(!1)),200);r.addEventListener("success",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("blocked",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("error",(()=>(clearTimeout(n),t(!1))))}))}}class $a{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,r)=>{e.push(r)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class Va{constructor(e){this.inMemoryCache=new $a,this.indexedDBCache=new Ka,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof Gi&&e.errorCode===Li))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class Ya{constructor(e,t,r){this.logger=e,function(e){if(!window)throw Wi(wi);if(!window.crypto)throw Wi(Yo);if(!e&&!window.crypto.subtle)throw Wi(Yo,"crypto_subtle_undefined")}(r??!1),this.cache=new Va(this.logger),this.performanceClient=t}createNewGuid(){return fa()}base64Encode(e){return Xi(e)}base64Decode(e){return Ji(e)}base64UrlEncode(e){return Yi(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(Hr,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(ua,e,t)}(Ya.EXTRACTABLE,Ya.POP_KEY_USAGES),n=await ma(r.publicKey),o=Qa({e:n.e,kty:n.kty,n:n.n}),i=await this.hashString(o),a=await ma(r.privateKey),s=await async function(e){return window.crypto.subtle.importKey("jwk",e,ua,!1,["sign"])}(a);return await this.cache.setItem(i,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){const o=this.performanceClient?.startMeasurement(Fr,n),i=await this.cache.getItem(t);if(!i)throw Wi(ki);const a=await ma(i.publicKey),s=Qa(a),c=Yi(JSON.stringify({kid:t})),l=Yi(Wa.getShrHeaderString({...r?.header,alg:a.alg,kid:c}));e.cnf={jwk:JSON.parse(s)};const u=`${l}.${Yi(JSON.stringify(e))}`,d=(new TextEncoder).encode(u),h=await async function(e,t){return window.crypto.subtle.sign(ua,e,t)}(i.privateKey,d),p=`${u}.${Qi(new Uint8Array(h))}`;return o&&o.end({success:!0}),p}async hashString(e){return Ca(e)}}function Qa(e){return JSON.stringify(e,Object.keys(e).sort())}Ya.POP_KEY_USAGES=["sign","verify"],Ya.EXTRACTABLE=!0;const Xa=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}try{const n=e(...i);return a?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(e){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}},Za=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}return n?.setPreQueueTime(t,o),e(...i).then((e=>(r.trace(`Returning result from ${t}`),a?.end({success:!0}),e))).catch((e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}))};class Ja{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(Hn,this.correlationId);let r=e;if(r)t.region_source="3";else{const e=Ja.IMDS_OPTIONS;try{const n=await Za(this.getRegionFromIMDS.bind(this),Fn,this.logger,this.performanceClient,this.correlationId)(_.IMDS_VERSION,e);if(200===n.status&&(r=n.body,t.region_source="4"),400===n.status){const n=await Za(this.getCurrentVersion.bind(this),zn,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source="1",null;const o=await Za(this.getRegionFromIMDS.bind(this),Fn,this.logger,this.performanceClient,this.correlationId)(n,e);200===o.status&&(r=o.body,t.region_source="4")}}catch(e){return t.region_source="1",null}}return r||(t.region_source="1"),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(Fn,this.correlationId),this.networkInterface.sendGetRequestAsync(`${_.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,_.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(zn,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${_.IMDS_ENDPOINT}?format=json`,e);return 400===t.status&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(e){return null}}}Ja.IMDS_OPTIONS={headers:{Metadata:"true"}};class es{constructor(e,t,r,n,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new Ja(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(_.CIAM_AUTH_URL))return 3;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case _.ADFS:return 1;case _.DSTS:return 2}return 0}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new hr(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw it(ye)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw it(ye)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw it(ye)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw it(Qe);return this.replacePath(this.metadata.end_session_endpoint)}throw it(ye)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw it(ye)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw it(ye)}canReplaceTenant(e){return 1===e.PathSegments.length&&!es.reservedTenantDomains.has(e.PathSegments[0])&&0===this.getAuthorityType(e)&&this.protocolMode!==ie}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new hr(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,o)=>{let i=n[o];if(0===o&&this.canReplaceTenant(r)){const e=new hr(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||this.protocolMode===ie&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(Rn,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await Za(this.updateCloudDiscoveryMetadata.bind(this),Dn,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await Za(this.updateEndpointMetadata.bind(this),qn,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:xt(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==X&&r?.source!==X&&(e.expiresAt=xt(),e.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(qn,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t)return t.source===J&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata&&(kt(e,await Za(this.updateMetadataWithRegionalInformation.bind(this),Bn,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority),t.source;let r=await Za(this.getEndpointMetadataFromNetwork.bind(this),Un,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await Za(this.updateMetadataWithRegionalInformation.bind(this),Bn,this.logger,this.performanceClient,this.correlationId)(r)),kt(e,r,!0),Z;throw it(we,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),kt(e,t,!1),{source:Q};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return kt(e,t,!1),{source:J,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=_t(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:X}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new hr(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Jt(zt)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Un,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const r=await this.networkInterface.sendGetRequestAsync(t,e),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(r.body);return n?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in pr?pr[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(Bn,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==_.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome="2",this.regionDiscoveryMetadata.region_used=t,es.replaceWithRegionalInformation(e,t);const r=await Za(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Hn,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome="4",this.regionDiscoveryMetadata.region_used=r,es.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome="5"}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(Dn,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await Za(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Mn,this.logger,this.performanceClient,this.correlationId)();if(r)return It(e,r,!0),Z;throw Jt(jt)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||_.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||_.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||_.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),It(e,t,!1),Q;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(r=this.hostnameAndPort,yr(fr.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),It(e,t,!1),J;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var r;const n=_t(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),X):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),es.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=yr(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Jt(Ft)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),es.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Mn,this.correlationId);const e=`${_.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const n=await this.networkInterface.sendGetRequestAsync(e,t);let o,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body))o=n.body,i=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(n.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${n.status}`),o=n.body,o.error===_.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=yr(i,this.hostnameAndPort)}catch(e){if(e instanceof de)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=es.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>e&&hr.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==se){const e=t.tenant?t.tenant:_.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return _.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw it(ye)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return mr.has(e)}static isPublicCloudAuthority(e){return _.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const n=new hr(e);n.validateAsUri();const o=n.getUrlComponents();let i=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=`${t}.${_.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=hr.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:i}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=es.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=es.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=es.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const r=new hr(e).getUrlComponents();return 0===r.PathSegments.length&&r.HostNameAndPort.endsWith(_.CIAM_AUTH_URL)&&(t=`${t}${r.HostNameAndPort.split(".")[0]}${_.AAD_TENANT_DOMAIN_SUFFIX}`),t}}function ts(e){return e.endsWith(_.FORWARD_SLASH)?e:`${e}${_.FORWARD_SLASH}`}es.reservedTenantDomains=new Set(["{tenant}","{tenantid}",U,B,q]);const rs="no_tokens_found",ns="native_account_unavailable",os="refresh_token_expired",is="bad_token",as=["interaction_required","consent_required","login_required",is],ss=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],cs={[rs]:"No refresh token found in the cache. Please sign-in.",[ns]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[os]:"Refresh token has expired.",[is]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class ls extends de{constructor(e,t,r,n,o,i,a,s){super(e,t,r),Object.setPrototypeOf(this,ls.prototype),this.timestamp=n||_.EMPTY_STRING,this.traceId=o||_.EMPTY_STRING,this.correlationId=i||_.EMPTY_STRING,this.claims=a||_.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=s}}function us(e,t,r){const n=!!e&&as.indexOf(e)>-1,o=!!r&&ss.indexOf(r)>-1,i=!!t&&as.some((e=>t.indexOf(e)>-1));return n||i||o}function ds(e){return new ls(e,cs[e])}function hs(e,t,r){return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:r,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}const ps="None";class fs{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){const n=r[e],[o,...i]=decodeURIComponent(n).trim().split("="),a=i.join("=");if(o===t)return a}return""}getUserData(){throw it(tt)}setItem(e,t,r,n=!0,o="Lax"){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${o};`;if(r){const e=function(e){const t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()}(r);i+=`expires=${e};`}(n||o===ps)&&(i+="Secure;"),document.cookie=i}async setUserData(){return Promise.reject(it(tt))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach((e=>{const r=decodeURIComponent(e).trim().split("=");t.push(r[0])})),t}containsKey(e){return this.getKeys().includes(e)}}function ms(e){const t=e.getItem(Po);return t?JSON.parse(t):[]}function gs(e,t){const r=t.getItem(`${Oo}.${e}`);if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}const ys="msal.cache.encryption";class vs{constructor(e,t,r){if(!window.localStorage)throw Sa(Ta);this.memoryStorage=new $a,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){this.initialized=!0;const t=new fs,r=t.getItem(ys);let n={key:"",id:""};if(r)try{n=JSON.parse(r)}catch(e){}if(n.key&&n.id){const t=Xa(ea,ao,this.logger,this.performanceClient,e)(n.key);this.encryptionCookie={id:n.id,key:await Za(wa,oo,this.logger,this.performanceClient,e)(t)},await Za(this.importExistingCache.bind(this),Qn,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=fa(),n=await Za(va,io,this.logger,this.performanceClient,e)(),o=Xa(Qi,so,this.logger,this.performanceClient,e)(new Uint8Array(n));this.encryptionCookie={id:r,key:await Za(wa,oo,this.logger,this.performanceClient,e)(n)};const i={id:r,key:o};t.setItem(ys,JSON.stringify(i),0,!0,ps)}this.broadcast.addEventListener("message",this.updateCache.bind(this))}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Wi(Mi);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,r){if(!this.initialized||!this.encryptionCookie)throw Wi(Mi);const{data:n,nonce:o}=await Za(Aa,co,this.logger,this.performanceClient,r)(this.encryptionCookie.key,t,this.getContext(e)),i={id:this.encryptionCookie.id,nonce:o,data:n};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(i)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),ms(this).forEach((e=>this.removeItem(e)));const e=gs(this.clientId,this);e.idToken.forEach((e=>this.removeItem(e))),e.accessToken.forEach((e=>this.removeItem(e))),e.refreshToken.forEach((e=>this.removeItem(e))),this.getKeys().forEach((e=>{(e.startsWith(_.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)}))}async importExistingCache(e){if(!this.encryptionCookie)return;let t=ms(this);t=await this.importArray(t,e),this.setItem(Po,JSON.stringify(t));const r=gs(this.clientId,this);r.idToken=await this.importArray(r.idToken,e),r.accessToken=await this.importArray(r.accessToken,e),r.refreshToken=await this.importArray(r.refreshToken,e),this.setItem(`${Oo}.${this.clientId}`,JSON.stringify(r))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const r=this.getItem(e);if(!r)return null;let n;try{n=JSON.parse(r)}catch(e){return null}return n.id&&n.nonce&&n.data?n.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):Za(Ea,lo,this.logger,this.performanceClient,t)(this.encryptionCookie.key,n.nonce,this.getContext(e),n.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null)}async importArray(e,t){const r=[],n=[];return e.forEach((e=>{const o=this.getItemFromEncryptedCache(e,t).then((t=>{t?(this.memoryStorage.setItem(e,t),r.push(e)):this.removeItem(e)}));n.push(o)})),await Promise.all(n),r}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(Zn);t.add({isBackground:!0});const{key:r,value:n,context:o}=e.data;return r?o&&o!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${o}`),void t.end({success:!1,errorCode:"contextMismatch"})):(n?(this.memoryStorage.setItem(r,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class ws{constructor(){if(!window.sessionStorage)throw Sa(Ta)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}const bs="msal:initializeEnd",As="msal:accountAdded",Es="msal:accountRemoved",Cs="msal:activeAccountChanged",Ts="msal:loginStart",xs="msal:loginSuccess",ks="msal:loginFailure",Is="msal:acquireTokenStart",_s="msal:acquireTokenSuccess",Ss="msal:acquireTokenFailure",Ls="msal:acquireTokenByCodeFailure",Ns="msal:handleRedirectEnd",Ps="msal:popupOpened",Os="msal:logoutStart",Rs="msal:logoutSuccess",Ms="msal:logoutFailure",Ds="msal:logoutEnd";class Us extends Er{constructor(e,t,r,n,o,i,a){super(e,r,n,a),this.cacheConfig=t,this.logger=n,this.internalStorage=new $a,this.browserStorage=qs(e,t.cacheLocation,n,o),this.temporaryCacheStorage=qs(e,t.temporaryCacheLocation,n,o),this.cookieStorage=new fs,this.performanceClient=o,this.eventHandler=i}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return r&&cr.isAccountEntity(r)?Er.toObject(new cr,r):(this.removeAccountKeyFromMap(e),null)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const r=e.generateAccountKey();await Za(this.browserStorage.setUserData.bind(this.browserStorage),Xn,this.logger,this.performanceClient)(r,JSON.stringify(e),t);const n=this.addAccountKeyToMap(r);this.cacheConfig.cacheLocation===Co&&n&&this.eventHandler.emitEvent(As,void 0,e.getAccountInfo())}getAccountKeys(){return ms(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();return-1===t.indexOf(e)?(t.push(e),this.browserStorage.setItem(Po,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.browserStorage.setItem(Po,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===Co&&this.eventHandler.emitEvent(Es,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,K.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,K.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,K.REFRESH_TOKEN)}getTokenKeys(){return gs(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case K.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case K.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case K.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),it(ze)}this.browserStorage.setItem(`${Oo}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case K.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case K.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case K.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),it(ze)}this.browserStorage.setItem(`${Oo}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,K.ID_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&wt(n)&&n.hasOwnProperty("realm")&&n.credentialType===K.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,K.ID_TOKEN),null);var n}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=mt(e);await Za(this.browserStorage.setUserData.bind(this.browserStorage),Xn,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,K.ID_TOKEN)}getAccessTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,K.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&wt(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===K.ACCESS_TOKEN||n.credentialType===K.ACCESS_TOKEN_WITH_AUTH_SCHEME)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,K.ACCESS_TOKEN),null);var n}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=mt(e);await Za(this.browserStorage.setUserData.bind(this.browserStorage),Xn,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,K.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,K.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&wt(n)&&n.credentialType===K.REFRESH_TOKEN?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,K.REFRESH_TOKEN),null);var n}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=mt(e);await Za(this.browserStorage.setUserData.bind(this.browserStorage),Xn,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,K.REFRESH_TOKEN)}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&((n=r)&&0===e.indexOf($)&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var n}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=function({environment:e,clientId:t}){return[$,e,t].join(W).toLowerCase()}(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){const r=0===e.indexOf(ee.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){return!!t&&0===e.indexOf(Y)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(Ro,e),this.internalStorage.setItem(Mo,t)}getWrapperMetadata(){return[this.internalStorage.getItem(Ro)||_.EMPTY_STRING,this.internalStorage.getItem(Mo)||_.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(D),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(D);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(r))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(Cs)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){let r=!1;e&&(r=0===e.indexOf(re));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===Co){const e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){const n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach((e=>{-1===e.indexOf(_.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)})),this.browserStorage.getKeys().forEach((e=>{-1===e.indexOf(_.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(Vn,t);const r=this.getTokenKeys(),n=[];r.accessToken.forEach((e=>{const t=this.getAccessTokenCredential(e);t?.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&n.push(this.removeAccessToken(e))})),await Promise.all(n),n.length>0&&this.logger.warning(`${n.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):er.startsWith(e,_.CACHE_PREFIX)?e:`${_.CACHE_PREFIX}.${this.clientId}.${e}`}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(_o)),this.removeTemporaryItem(this.generateCacheKey(So)),this.removeTemporaryItem(this.generateCacheKey(ko)),this.removeTemporaryItem(this.generateCacheKey(Io)),this.removeTemporaryItem(this.generateCacheKey(No)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const r=Xi(JSON.stringify(e));if(this.setTemporaryCache(_o,r,!0),t){const e=Xi(t);this.setTemporaryCache(So,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(_o,!0);if(!e)throw Wi(mi);const t=this.getTemporaryCache(So,!0);let r,n="";try{r=JSON.parse(Ji(e)),t&&(n=Ji(t))}catch(t){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${t}`),Wi(gi)}return[r,n]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(No,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;return this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${_.CACHE_PREFIX}.${Lo}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${_.CACHE_PREFIX}.${Lo}`;if(e){if(this.getInteractionInProgress())throw Wi(ri);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(t)}async hydrateCache(e,t){const r=gt(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let n;t.claims&&(n=await this.cryptoImpl.hashString(t.claims));const o={idToken:r,accessToken:yt(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?ht(e.expiresOn):0,e.extExpiresOn?ht(e.extExpiresOn):0,Ji,void 0,e.tokenType,void 0,t.sshKid,t.claims,n)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(e){if(e instanceof Ar&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}function qs(e,t,r,n){try{switch(t){case Co:return new vs(e,r,n);case To:return new ws}}catch(e){r.error(e)}return new $a}class Bs{constructor(e){this.eventCallbacks=new Map,this.logger=e||new oe({}),"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,r){if("undefined"!=typeof window){const n=r||fa();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){const o={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};switch(e){case As:case Es:case Cs:this.broadcastChannel?.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach((([t,r],n)=>{(0===r.length||r.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e.eventType}`),t.apply(null,[e]))}))}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}const Hs="home_account_id",Fs="UPN",zs="client_id",js="redirect_uri",Gs="token_type",Ws="req_cnf",Ks="return_spa_code",$s="x-client-xtra-sku",Vs="brk_client_id",Ys="brk_redirect_uri",Qs="instance_aware";function Xs(e,t,r){if(!t)return;const n=e.get(zs);n&&e.has(Vs)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(js)},t)}function Zs(e,t){e.set("response_type",t)}function Js(e,t,r=!0,n=S){!r||n.includes("openid")||t.includes("openid")||n.push("openid");const o=r?[...t||[],...n]:t||[],i=new tr(o);e.set("scope",i.printScopes())}function ec(e,t){e.set(zs,t)}function tc(e,t){e.set(js,t)}function rc(e,t){e.set("login_hint",t)}function nc(e,t){e.set(O,`UPN:${t}`)}function oc(e,t){e.set(O,`Oid:${t.uid}@${t.utid}`)}function ic(e,t){e.set("sid",t)}function ac(e,t,r){const n=function(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw Jt(Dt)}else r={};return t&&t.length>0&&(r.hasOwnProperty(H)||(r[H]={}),r[H].xms_cc={values:t}),JSON.stringify(r)}(t,r);try{JSON.parse(n)}catch(e){throw Jt(Dt)}e.set("claims",n)}function sc(e,t){e.set("client-request-id",t)}function cc(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function lc(e,t){t?.appName&&e.set("x-app-name",t.appName),t?.appVersion&&e.set("x-app-ver",t.appVersion)}function uc(e,t){t&&e.set("state",t)}function dc(e,t){e.set("client_secret",t)}function hc(e,t){t&&e.set("client_assertion",t)}function pc(e,t){t&&e.set("client_assertion_type",t)}function fc(e,t){e.set("grant_type",t)}function mc(e){e.set("client_info","1")}function gc(e){e.has(Qs)||e.set(Qs,"true")}function yc(e,t){Object.entries(t).forEach((([t,r])=>{!e.has(t)&&r&&e.set(t,r)}))}function vc(e,t){t&&(e.set(Gs,te.POP),e.set(Ws,t))}function wc(e,t){t&&(e.set(Gs,te.SSH),e.set(Ws,t))}function bc(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function Ac(e){e.set("x-ms-lib-capability","retry-after, h429")}function Ec(e,t,r){e.has(Vs)||e.set(Vs,t),e.has(Ys)||e.set(Ys,r)}async function Cc(e,t,r,n,o,i,a){a?.addQueueMeasurement(On,i);const s=es.transformCIAMAuthority(ts(e)),c=new es(s,t,r,n,o,i,a);try{return await Za(c.resolveEndpointsAsync.bind(c),Rn,o,a,i)(),c}catch(e){throw it(ye)}}class Tc extends de{constructor(e,t,r,n,o){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=o,Object.setPrototypeOf(this,Tc.prototype)}}class xc{static generateThrottlingStorageKey(e){return`${re}.${JSON.stringify(e)}`}static preProcess(e,t){const r=xc.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){if(n.throttleTime<Date.now())return void e.removeItem(r);throw new Tc(n.errorCodes?.join(" ")||_.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,t,r){if(xc.checkResponseStatus(r)||xc.checkResponseForRetryAfter(r)){const n={throttleTime:xc.calculateThrottleTime(parseInt(r.headers[P])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(xc.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(P)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))}static removeThrottle(e,t,r,n){const o=hs(t,r,n),i=this.generateThrottlingStorageKey(o);e.removeItem(i)}}class kc{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){const p={...xr,...r};return{authOptions:(f=e,{clientCapabilities:[],azureCloudOptions:Lr,skipAuthorityMetadataCache:!1,instanceAware:!1,...f}),systemOptions:{...Tr,...t},loggerOptions:p,cacheOptions:{...kr,...n},storageInterface:o||new Cr(e.clientId,at,new oe(p)),networkInterface:i||Ir,cryptoInterface:a||at,clientCredentials:s||Sr,libraryInfo:{..._r,...c},telemetry:{...Nr,...l},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null};var f}(e),this.logger=new oe(this.config.loggerOptions,st,ct),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[N]=_.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Hs:try{const r=nr(e.credential);t[O]=`Oid:${r.uid}@${r.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Fs:t[O]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,o,i){i&&this.performanceClient?.addQueueMeasurement(i,o);const a=await this.sendPostRequest(n,e,{body:t,headers:r},o);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,n){let o;xc.preProcess(this.cacheManager,e);try{o=await Za(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Vr,this.logger,this.performanceClient,n)(t,r);const e=o.headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:e[M]||"",requestId:e[R]||""},n)}catch(e){if(e instanceof Go){const t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[M]||"",requestId:t[R]||"",contentTypeHeader:t[N]||void 0,contentLengthHeader:t["Content-Length"]||void 0,httpStatus:e.httpStatus},n),e.error}throw e instanceof de?e:it(ve)}return xc.postProcess(this.cacheManager,e,o),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(xn,t);const r=`https://${e}/${this.authority.tenant}/`,n=await Cc(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&Ec(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&yc(t,e.tokenQueryParameters),sc(t,e.correlationId),Xs(t,e.correlationId,this.performanceClient),dr(t)}}class Ic{static setRequestState(e,t,r){const n=Ic.generateLibraryState(e,r);return t?`${n}${_.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw it(Fe);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw it(Fe);if(!t)throw it(Ae);try{const r=t.split(_.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(_.RESOURCE_DELIM):_.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:o||_.EMPTY_STRING,libraryState:a}}catch(e){throw it(Ae)}}}class _c{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(Sn,e.correlationId);const r=await Za(this.generateKid.bind(this),Sn,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(Ln,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:c}=r,l=i?new hr(i):void 0,u=l?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:dt(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...n},t,c,r.correlationId)}}class Sc{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Lc{constructor(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const r=`Error(s): ${e.error_codes||_.NOT_AVAILABLE} - Timestamp: ${e.timestamp||_.NOT_AVAILABLE} - Description: ${e.error_description||_.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||_.NOT_AVAILABLE} - Trace ID: ${e.trace_id||_.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,o=new Tc(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${o}`);if(t&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${o}`);if(us(e.error,e.error_description,e.suberror))throw new ls(e.error,e.error_description,e.suberror,e.timestamp||_.EMPTY_STRING,e.trace_id||_.EMPTY_STRING,e.correlation_id||_.EMPTY_STRING,e.claims||_.EMPTY_STRING,n);throw o}}async handleServerTokenResponse(e,t,r,n,o,i,a,s,c){let l,u;if(this.performanceClient?.addQueueMeasurement(Nn,e.correlation_id),e.id_token){if(l=lt(e.id_token||_.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&l.nonce!==o.nonce)throw it(Te);if(n.maxAge||0===n.maxAge){const e=l.auth_time;if(!e)throw it(xe);ut(e,n.maxAge)}}this.homeAccountIdentifier=cr.generateHomeAccountId(e.client_info||_.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l),o&&o.state&&(u=Ic.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||n.sshKid||void 0;const d=this.generateCacheRecord(e,t,r,n,l,i,o);let h;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),h=new Sc(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(h)),a&&!s&&d.account){const e=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(e))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Lc.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,l,u,void 0,c)}await this.cacheStorage.saveCacheRecord(d,n.correlationId,n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&h&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(h))}return Lc.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,l,u,e,c)}generateCacheRecord(e,t,r,n,o,i,a){const s=t.getPreferredCache();if(!s)throw it(Be);const c=sr(o);let l,u;e.id_token&&o&&(l=gt(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),u=Nc(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,s,c,a,void 0,this.logger));let d=null;if(e.access_token){const o=e.scope?tr.fromString(e.scope):new tr(n.scopes||[]),a=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=r+a,p=h+l,f=u&&u>0?r+u:void 0;d=yt(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",o.printScopes(),h,p,this.cryptoObj.base64Decode,f,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;e.refresh_token_expires_in&&(t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),h=vt(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:s,familyId:e.foci}),{account:u,idToken:l,accessToken:d,refreshToken:h,appMetadata:p}}static async generateAuthenticationResult(e,t,r,n,o,i,a,s,c){let l,u,d=_.EMPTY_STRING,h=[],p=null,f=_.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==te.POP||o.popKid)d=r.accessToken.secret;else{const t=new _c(e),{secret:n,keyId:i}=r.accessToken;if(!i)throw it(Xe);d=await t.signPopToken(n,i,o)}h=tr.fromString(r.accessToken.target).asArray(),p=pt(r.accessToken.expiresOn),l=pt(r.accessToken.extendedExpiresOn),r.accessToken.refreshOn&&(u=pt(r.accessToken.refreshOn))}r.appMetadata&&(f=r.appMetadata.familyId===V?V:"");const m=i?.oid||i?.sub||"",g=i?.tid||"";s?.spa_accountid&&r.account&&(r.account.nativeAccountId=s?.spa_accountid);const y=r.account?ar(r.account.getAccountInfo(),void 0,i,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:m,tenantId:g,scopes:h,account:y,idToken:r?.idToken?.secret||"",idTokenClaims:i||{},accessToken:d,fromCache:n,expiresOn:p,extExpiresOn:l,refreshOn:u,correlationId:o.correlationId,requestId:c||_.EMPTY_STRING,familyId:f,tokenType:r.accessToken?.tokenType||_.EMPTY_STRING,state:a?a.userRequestState:_.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||_.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||_.EMPTY_STRING,code:s?.spa_code,fromNativeBroker:!1}}}function Nc(e,t,r,n,o,i,a,s,c,l,u){u?.verbose("setCachedAccount called");const d=e.getAccountKeys().find((e=>e.startsWith(r)));let h=null;d&&(h=e.getAccount(d));const p=h||cr.createAccount({homeAccountId:r,idTokenClaims:o,clientInfo:i,environment:a,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},t,n),f=p.tenantProfiles||[],m=s||p.realm;if(m&&!f.find((e=>e.tenantId===m))){const e=ir(r,p.localAccountId,m,o);f.push(e)}return p.tenantProfiles=f,p}class Pc{static validateRedirectUri(e){if(!e)throw Jt(St)}static validatePrompt(e){const t=[];for(const e in F)t.push(F[e]);if(t.indexOf(e)<0)throw Jt(Mt)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw Jt(Dt)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Jt(Ht);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([z.PLAIN,z.S256].indexOf(e)<0)throw Jt(Bt)}}async function Oc(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})}class Rc extends kc{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(kn,e.correlationId),!e.code)throw it(Le);const r=dt(),n=await Za(this.executeTokenRequest.bind(this),In,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=n.headers?.[R],i=new Lc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(n.body),Za(i.handleServerTokenResponse.bind(i),Nn,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,o)}getLogoutUri(e){if(!e)throw Jt(qt);const t=this.createLogoutUrlQueryString(e);return hr.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(In,t.correlationId);const r=this.createTokenQueryParameters(t),n=hr.appendQueryString(e.tokenEndpoint,r),o=await Za(this.createTokenRequestBody.bind(this),_n,this.logger,this.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const e=rr(t.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${e.uid}.${e.utid}`,type:Hs}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const a=this.createTokenRequestHeaders(i||t.ccsCredential),s=hs(this.config.authOptions.clientId,t);return Za(this.executePostToTokenEndpoint.bind(this),Qr,this.logger,this.performanceClient,t.correlationId)(n,o,a,s,t.correlationId,Qr)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(_n,e.correlationId);const t=new Map;if(ec(t,e.embeddedClientId||e.tokenBodyParameters?.[zs]||this.config.authOptions.clientId),this.includeRedirectUri?tc(t,e.redirectUri):Pc.validateRedirectUri(e.redirectUri),Js(t,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(t,e.code),cc(t,this.config.libraryInfo),lc(t,this.config.telemetry.application),Ac(t),this.serverTelemetryManager&&!Pr(this.config)&&bc(t,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&dc(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;hc(t,await Oc(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),pc(t,r.assertionType)}if(fc(t,"authorization_code"),mc(t),e.authenticationScheme===te.POP){const r=new _c(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await Za(r.generateCnf.bind(r),Sn,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,vc(t,n)}else if(e.authenticationScheme===te.SSH){if(!e.sshJwk)throw Jt(Gt);wc(t,e.sshJwk)}let r;if((!er.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&ac(t,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=rr(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${t.uid}.${t.utid}`,type:Hs}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case Hs:try{oc(t,nr(r.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Fs:nc(t,r.credential)}return e.embeddedClientId&&Ec(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&yc(t,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Ks]||yc(t,{[Ks]:"1"}),Xs(t,e.correlationId,this.performanceClient),dr(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&sc(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&uc(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&yc(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&gc(t),dr(t)}}class Mc{constructor(e,t){this.cacheOutcome="0",this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||_.EMPTY_STRING,this.wrapperVer=e.wrapperVer||_.EMPTY_STRING,this.telemetryCacheKey=ee.CACHE_KEY+W+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${ee.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(ee.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(ee.VALUE_SEPARATOR);return[ee.SCHEMA_VERSION,o,n].join(ee.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Mc.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(ee.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(ee.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?ee.OVERFLOW_TRUE:ee.OVERFLOW_FALSE].join(ee.VALUE_SEPARATOR);return[ee.SCHEMA_VERSION,e.cacheHits,r,n,i].join(ee.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=ee.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof de?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(ee.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Mc.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t,r=0,n=0;const o=e.errors.length;for(t=0;t<o;t++){const o=e.failedRequests[2*t]||_.EMPTY_STRING,i=e.failedRequests[2*t+1]||_.EMPTY_STRING,a=e.errors[t]||_.EMPTY_STRING;if(n+=o.toString().length+i.toString().length+a.length+3,!(n<ee.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||_.EMPTY_STRING),e.push(this.regionSource||_.EMPTY_STRING),e.push(this.regionOutcome||_.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return function(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[r,n]],[2,[o,i]]]);let s=[];if(t?.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},(()=>"|"));return a.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:o}=e;r>=t.length||(t[r]=[n,o].join("|"))}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})})),s.join(",")}(e)}}class Dc{constructor(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||fa(),this.logger=n.clone(vo,Ua,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){cr.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(cr.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return hr.getAbsoluteUrl(t,Na())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Mc(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Kr,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=r?.length?"true"===r:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace(hr.getDomainFromUrl(o),t.environment):o,s=es.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await Za(Cc,On,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Jt(Qt);return c}}async function Uc(e,t,r,n){r.addQueueMeasurement(sn,e.correlationId);const o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a={...e,correlationId:e.correlationId,authority:o,scopes:i};if(a.authenticationScheme){if(a.authenticationScheme===te.SSH){if(!e.sshJwk)throw Jt(Gt);if(!e.sshKid)throw Jt(Wt)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}else a.authenticationScheme=te.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!er.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await Ca(e.claims)),a}async function qc(e,t,r,n,o){n.addQueueMeasurement(cn,e.correlationId);const i=await Za(Uc,sn,o,n,e.correlationId)(e,r,n,o);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}class Bc extends Dc{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||fa(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=hr.getAbsoluteUrl(e.postLogoutRedirectUri,Na())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=hr.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Na())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=hr.getAbsoluteUrl(Na(),Na())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(gn,this.correlationId);const t=await Za(this.getClientConfiguration.bind(this),yn,this.logger,this.performanceClient,this.correlationId)(e);return new Rc(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}=e;this.performanceClient.addQueueMeasurement(yn,this.correlationId);const a=await Za(this.getDiscoveredAuthority.bind(this),Kr,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:vo,version:Ua,cpu:_.EMPTY_STRING,os:_.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(vn,this.correlationId);const r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=Ic.setRequestState(this.browserCrypto,e&&e.state||_.EMPTY_STRING,n),i={...await Za(Uc,sn,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:o,nonce:e.nonce||fa(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return i;const a=e.account||this.browserStorage.getActiveAccount();return a&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${a.homeAccountId}`,this.correlationId),i.account=a),i}}const Hc="user_switch",Fc={[Hc]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class zc extends de{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,zc.prototype),this.name="NativeAuthError",this.ext=r}}function jc(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode}function Gc(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return ds(ns);case"USER_INTERACTION_REQUIRED":return new ls(e,t);case"USER_CANCEL":return Wi(ii);case"NO_NETWORK":return Wi(Ai)}return new zc(e,Fc[e]||t,r)}class Wc{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(Kn)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:wo,extensionId:this.extensionId,responseId:fa(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise(((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})}))}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const n=new Wc(e,t,r,bo);return await n.sendHandshakeRequest(),n}catch(n){const o=new Wc(e,t,r);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:wo,extensionId:this.extensionId,responseId:fa(),body:{method:Ao}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise(((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Wi(Pi)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===wo&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Ao){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(Wi(Oi))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if("Response"===e){if(!r)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(Gc(e.code,e.description,e.ext));else{if(!e.result)throw he(ce,"Event does not contain result.");e.result.code&&e.result.description?r.reject(Gc(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result)}this.resolvers.delete(t.responseId)}else if("HandshakeResponse"===e){if(!n)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(t):n&&n.reject(t)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,r,n){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(n)switch(n){case te.BEARER:case te.POP:return t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}function Kc(e,t,r){const n=ur(e);if(!n)throw lr(e)?(r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),Wi(Jo)):(r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),Wi(Xo));return n}function $c(e,t){const r=dr(t);return hr.appendQueryString(e.authorizationEndpoint,r)}function Vc(e,t){if(!e.state||!t)throw e.state?it(Ce,"Cached State"):it(Ce,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(t){throw it(Ae,e.state)}try{n=decodeURIComponent(t)}catch(t){throw it(Ae,e.state)}if(r!==n)throw it(Ee);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+5):void 0}(e);if(us(e.error,e.error_description,e.suberror))throw new ls(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new Tc(e.error||"",e.error_description,e.suberror,t)}}class Yc{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(An,t.correlationId);try{r=function(e,t){if(Vc(e,t),!e.code)throw it(Ve);return e}(e,t.state)}catch(e){throw e instanceof Tc&&e.subError===ii?Wi(ii):e}return Za(this.handleCodeResponseFromServer.bind(this),bn,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(bn,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Za(this.authModule.updateAuthority.bind(this.authModule),xn,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await Za(this.authModule.acquireToken.bind(this.authModule),kn,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Hs}:e.loginHint?{credential:e.loginHint,type:Fs}:null}}class Qc extends kc{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(nn,e.correlationId);let t="0";if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!er.isEmptyObj(e.claims))throw this.setCacheOutcome("1",e.correlationId),it(We);if(!e.account)throw it(Ue);const r=e.account.tenantId||function(e){const t=new hr(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case U:case q:case B:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient,e.correlationId);if(!o)throw this.setCacheOutcome("2",e.correlationId),it(We);if(i=o.cachedAt,Number(i)>dt()||ft(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome("3",e.correlationId),it(We);var i;o.refreshOn&&ft(o.refreshOn,0)&&(t="4");const a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,n,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Za(this.generateResultFromCacheRecord.bind(this),on,this.logger,this.performanceClient,e.correlationId)(s,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),"0"!==e&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(on,t.correlationId),e.idToken&&(r=lt(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=r?.auth_time;if(!e)throw it(xe);ut(e,t.maxAge)}return Lc.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class Xc extends Bc{async acquireToken(e){this.performanceClient.addQueueMeasurement(zr,e.correlationId);const t=this.initializeServerTelemetryManager(61),r=await Za(this.getClientConfiguration.bind(this),yn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),n=new Qc(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await Za(n.acquireCachedToken.bind(n),nn,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof Gi&&e.errorCode===ki&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}class Zc extends Dc{constructor(e,t,r,n,o,i,a,s,c,l,u,d){super(e,t,r,n,o,i,s,c,d),this.apiId=a,this.accountId=l,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new Xc(e,this.nativeStorageManager,r,n,o,i,s,c,d);const h=this.nativeMessageHandler.getExtensionId()===bo?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=Mc.makeExtraSkuString({libraryName:vo,libraryVersion:Ua,extensionName:h,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[$s]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement($r,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const r=this.performanceClient.startMeasurement($r,e.correlationId),n=dt(),o=this.initializeServerTelemetryManager(this.apiId);try{const i=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,i);return r.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){if(1===t)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),e;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=i,s={method:Eo,request:a},c=await this.nativeMessageHandler.sendMessage(s),l=this.validateNativeResponse(c);return await this.handleNativeResponse(l,i,n).then((e=>(r.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),o.clearNativeBrokerErrorCode(),e))).catch((e=>{throw r.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}catch(e){throw e instanceof zc&&o.setNativeBrokerErrorCode(e.errorCode),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:tr.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),it(He);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw it(He);try{const e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),o={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:o}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const n=await this.initializeNativeRequest(r),o={method:Eo,request:n};try{const e=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(e)}catch(e){if(e instanceof zc&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(e.errorCode),jc(e)))throw e}this.browserStorage.setTemporaryCache(No,JSON.stringify(n),!0);const i={apiId:Do,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:n,...o}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(No));const i={method:Eo,request:o},a=dt();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,o,a),r=await t;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),r}catch(e){throw e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const n=lt(e.id_token,Ji),o=this.createHomeAccountIdentifier(e,n),i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(o!==i&&e.account.id!==t.accountId)throw Gc(Hc);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=Nc(this.browserStorage,a,o,Ji,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const c=await this.generateAuthenticationResult(e,t,n,s,a.canonicalAuthority,r);return await this.cacheAccount(s),await this.cacheNativeTokens(e,t,o,n,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return cr.generateHomeAccountId(e.client_info||_.EMPTY_STRING,0,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?tr.fromString(e.scope):tr.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===te.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new _c(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw it(Xe);return r.signPopToken(e.access_token,t.keyId,n)}return e.access_token}async generateAuthenticationResult(e,t,r,n,o,i){const a=this.addTelemetryFromNativeResponse(e),s=e.scope?tr.fromString(e.scope):tr.fromString(t.scope),c=e.account.properties||{},l=c.UID||r.oid||r.sub||_.EMPTY_STRING,u=c.TenantId||r.tid||_.EMPTY_STRING,d=ar(n.getAccountInfo(),void 0,r,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const h=await this.generatePopAccessToken(e,t),p=t.tokenType===te.POP?te.POP:te.BEARER;return{authority:o,uniqueId:l,tenantId:u,scopes:s.asArray(),account:d,idToken:e.id_token,idTokenClaims:r,accessToken:h,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:pt(i+e.expires_in),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)}))}cacheNativeTokens(e,t,r,n,o,i,a){const s=gt(r,t.authority,e.id_token||"",t.clientId,n.tid||""),c=a+(t.tokenType===te.POP?_.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,t),u={idToken:s,accessToken:yt(r,t.authority,o,t.clientId,n.tid||i,l.printScopes(),c,0,Ji,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(u,this.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw he(ce,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new hr(t);r.validateAsUri();const{scopes:n,...o}=e,i=new tr(n||[]);i.appendScopes(S);const a={...o,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case 863:case 61:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),F.NONE}if(e.prompt)switch(e.prompt){case F.NONE:case F.CONSENT:case F.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Wi(Di)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(a.signPopToken&&e.popKid)throw Wi(qi);if(this.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry="MATS",e.authenticationScheme===te.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},r=new _c(this.browserCrypto);let n;if(a.keyId)n=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:a.keyId})),a.signPopToken=!1;else{const o=await Za(r.generateCnf.bind(r),Sn,this.logger,this.performanceClient,e.correlationId)(t,this.logger);n=o.reqCnfString,a.keyId=o.kid,a.signPopToken=!0}a.reqCnf=n}return this.addRequestSKUs(a),a}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Vs)&&e.extraParameters.hasOwnProperty(Ys)&&e.extraParameters.hasOwnProperty(zs);if(!e.embeddedClientId&&!t)return;let r="";const n=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Ys],r=e.extraParameters[zs]),e.extraParameters={child_client_id:r,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:n},e.correlationId)}}async function Jc(e,t,r,n,o){const i=function(e,t,r,n){const o=t.correlationId,i=new Map;if(ec(i,t.embeddedClientId||t.extraQueryParameters?.[zs]||e.clientId),Js(i,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,e.authority.options.OIDCOptions?.defaultScopes),tc(i,t.redirectUri),sc(i,o),function(e,t){e.set("response_mode",t||"query")}(i,t.responseMode),mc(i),t.prompt&&(function(e,t){e.set("prompt",t)}(i,t.prompt),n?.addFields({prompt:t.prompt},o)),t.domainHint&&(function(e,t){e.set("domain_hint",t)}(i,t.domainHint),n?.addFields({domainHintFromRequest:!0},o)),t.prompt!==F.SELECT_ACCOUNT)if(t.sid&&t.prompt===F.NONE)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),ic(i,t.sid),n?.addFields({sidFromRequest:!0},o);else if(t.account){const e=(a=t.account,a.idTokenClaims?.sid||null);let s=function(e){return e.idTokenClaims?.login_hint||null}(t.account);if(s&&t.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),rc(i,s),n?.addFields({loginHintFromClaim:!0},o);try{oc(i,nr(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===F.NONE){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),ic(i,e),n?.addFields({sidFromClaim:!0},o);try{oc(i,nr(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),rc(i,t.loginHint),nc(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(t.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),rc(i,t.account.username),n?.addFields({loginHintFromUpn:!0},o);try{oc(i,nr(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),rc(i,t.loginHint),nc(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var a;return t.nonce&&function(e,t){e.set("nonce",t)}(i,t.nonce),t.state&&uc(i,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&ac(i,t.claims,e.clientCapabilities),t.embeddedClientId&&Ec(i,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(Qs)||gc(i),i}({...e.auth,authority:t},r,n,o);if(cc(i,{sku:vo,version:Ua,os:"",cpu:""}),e.auth.protocolMode!==ie&&lc(i,e.telemetry.application),r.platformBroker&&(function(e){e.set("nativebroker","1")}(i),r.authenticationScheme===te.POP)){const e=new Ya(n,o),t=new _c(e);let a;a=r.popKid?e.encodeKid(r.popKid):(await Za(t.generateCnf.bind(t),Sn,n,o,r.correlationId)(r,n)).reqCnfString,vc(i,a)}return Xs(i,r.correlationId,o),i}async function el(e,t,r,n,o){if(!r.codeChallenge)throw Jt(Ht);const i=await Za(Jc,"getStandardParams",n,o,r.correlationId)(e,t,r,n,o);return Zs(i,"code"),function(e,t,r){if(!t||!r)throw Jt(Ht);e.set("code_challenge",t),e.set("code_challenge_method",r)}(i,r.codeChallenge,_.S256_CODE_CHALLENGE_METHOD),yc(i,r.extraQueryParameters||{}),$c(t,i)}async function tl(e,t,r,n,o,i){if(!n.earJwk)throw Wi($o);const a=await Jc(t,r,n,o,i);Zs(a,"id_token token refresh_token"),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(a,n.earJwk);const s=new Map;return yc(s,n.extraQueryParameters||{}),function(e,t,r){const n=e.createElement("form");return n.method="post",n.action=t,r.forEach(((t,r)=>{const o=e.createElement("input");o.hidden=!0,o.name=r,o.value=t,n.appendChild(o)})),e.body.appendChild(n),n}(e,$c(r,s),a)}async function rl(e,t,r,n,o,i,a,s,c,l){if(!l)throw Wi(Ri);const u=new Ya(s,c),d=new Zc(n,o,u,s,a,n.system.navigationClient,r,c,l,t,i,e.correlationId),{userRequestState:h}=Ic.parseRequestState(u,e.state);return Za(d.acquireToken.bind(d),$r,s,c,e.correlationId)({...e,state:h,prompt:void 0})}async function nl(e,t,r,n,o,i,a,s,c,l,u,d){if(xc.removeThrottle(a,o.auth.clientId,e),t.accountId)return Za(rl,Cn,l,u,e.correlationId)(e,t.accountId,n,o,a,s,c,l,u,d);const h={...e,code:t.code||"",codeVerifier:r},p=new Yc(i,a,h,l,u);return await Za(p.handleCodeResponse.bind(p),An,l,u,e.correlationId)(t,e)}async function ol(e,t,r,n,o,i,a,s,c,l,u){if(xc.removeThrottle(i,n.auth.clientId,e),Vc(t,e.state),!t.ear_jwe)throw Wi(Vo);if(!e.earJwk)throw Wi($o);const d=JSON.parse(await Za(ya,ho,c,l,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return Za(rl,Cn,c,l,e.correlationId)(e,d.accountId,r,n,i,a,s,c,l,u);const h=new Lc(n.auth.clientId,i,new Ya(c,l),c,null,null,l);h.validateTokenResponse(d);const p={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return await Za(h.handleServerTokenResponse.bind(h),Nn,c,l,e.correlationId)(d,o,dt(),e,p,void 0,void 0,void 0,void 0)}async function il(e,t,r){e.addQueueMeasurement(Jn,r);const n=Xa(al,eo,t,e,r)(e,t,r);return{verifier:n,challenge:await Za(sl,to,t,e,r)(n,e,t,r)}}function al(e,t,r){try{const n=new Uint8Array(32);return Xa(ha,no,t,e,r)(n),Qi(n)}catch(e){throw Wi(Ko)}}async function sl(e,t,r,n){t.addQueueMeasurement(to,n);try{const o=await Za(da,ro,r,t,n)(e,t,n);return Qi(new Uint8Array(o))}catch(e){throw Wi(Ko)}}class cl extends Bc{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s,this.eventHandler=o}acquireToken(e,t){try{const r={popupName:this.generatePopupName(e.scopes||S,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r,t))}catch(e){return Promise.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,o))}catch(e){return Promise.reject(e)}}async acquireTokenPopupAsync(e,t,r){this.logger.verbose("acquireTokenPopupAsync called");const n=await Za(this.initializeAuthorizationRequest.bind(this),vn,this.logger,this.performanceClient,this.correlationId)(e,qo.Popup);t.popup&&Da(n.authority);const o=Wc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);return n.platformBroker=o,this.config.auth.protocolMode===ae?this.executeEarFlow(n,t):this.executeCodeFlow(n,t,r)}async executeCodeFlow(e,t,r){const n=e.correlationId,o=this.initializeServerTelemetryManager(Uo),i=r||await Za(il,Jn,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),a={...e,codeChallenge:i.challenge};try{const r=await Za(this.createAuthCodeClient.bind(this),gn,this.logger,this.performanceClient,n)({serverTelemetryManager:o,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account}),s=await Za(el,wn,this.logger,this.performanceClient,n)(this.config,r.authority,a,this.logger,this.performanceClient),c=this.initiateAuthRequest(s,t);this.eventHandler.emitEvent(Ps,qo.Popup,{popupWindow:c},null);const l=await this.monitorPopupForHash(c,t.popupWindowParent),u=Xa(Kc,Pn,this.logger,this.performanceClient,this.correlationId)(l,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await Za(nl,Tn,this.logger,this.performanceClient,n)(e,u,i.verifier,Uo,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}catch(e){throw t.popup?.close(),e instanceof de&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}async executeEarFlow(e,t){const r=e.correlationId,n=await Za(this.getDiscoveredAuthority.bind(this),Kr,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await Za(ga,uo,this.logger,this.performanceClient,r)(),i={...e,earJwk:o},a=t.popup||this.openPopup("about:blank",t);(await tl(a.document,this.config,n,i,this.logger,this.performanceClient)).submit();const s=await Za(this.monitorPopupForHash.bind(this),pn,this.logger,this.performanceClient,r)(a,t.popupWindowParent),c=Xa(Kc,Pn,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Za(ol,En,this.logger,this.performanceClient,r)(i,c,Uo,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}async logoutPopupAsync(e,t,r,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Os,qo.Popup,e);const o=this.initializeServerTelemetryManager(962);try{await this.clearCacheOnLogout(e.account);const i=await Za(this.createAuthCodeClient.bind(this),gn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r,account:e.account||void 0});try{i.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&i.authority.protocolMode===ie){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(Rs,qo.Popup,e),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=hr.getAbsoluteUrl(n,Na());await this.navigationClient.navigateInternal(t,e)}return void t.popup?.close()}}const a=i.getLogoutUri(e);this.eventHandler.emitEvent(Rs,qo.Popup,e);const s=this.openPopup(a,t);if(this.eventHandler.emitEvent(Ps,qo.Popup,{popupWindow:s},null),await this.monitorPopupForHash(s,t.popupWindowParent).catch((()=>{})),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=hr.getAbsoluteUrl(n,Na());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(e){throw t.popup?.close(),e instanceof de&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),this.eventHandler.emitEvent(Ms,qo.Popup,null,e),this.eventHandler.emitEvent(Ds,qo.Popup),e}this.eventHandler.emitEvent(Ds,qo.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Wi(Qo)}monitorPopupForHash(e,t){return new Promise(((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r(Wi(ii));let o="";try{o=e.location.href}catch(e){}if(!o||"about:blank"===o)return;clearInterval(n);let i="";const a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===j?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)}),this.config.system.pollIntervalMilliseconds)})).finally((()=>{this.cleanPopup(e,t)}))}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw Wi(oi);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),Wi(ni)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:n}){const o=n.screenLeft?n.screenLeft:n.screenX,i=n.screenTop?n.screenTop:n.screenY,a=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=r.popupSize?.width,l=r.popupSize?.height,u=r.popupPosition?.top,d=r.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=483),(!l||l<0||l>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=600),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-300+i)),(!d||d<0||d>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,a/2-241.5+o)),n.open(e,t,`width=${c}, height=${l}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${yo}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${yo}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class ll extends Bc{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.nativeStorage=s}async acquireToken(e){const t=await Za(this.initializeAuthorizationRequest.bind(this),vn,this.logger,this.performanceClient,this.correlationId)(e,qo.Redirect);t.platformBroker=Wc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);const r=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent("msal:restoreFromBFCache",qo.Redirect))},n=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${n}`),this.browserStorage.setTemporaryCache(ko,n,!0),window.addEventListener("pageshow",r);try{this.config.auth.protocolMode===ae?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(e){throw e instanceof de&&e.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",r),e}}async executeCodeFlow(e,t){const r=e.correlationId,n=this.initializeServerTelemetryManager(Do),o=await Za(il,Jn,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),i={...e,codeChallenge:o.challenge};this.browserStorage.cacheAuthorizeRequest(i,o.verifier);try{const r=await Za(this.createAuthCodeClient.bind(this),gn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),o=await Za(el,wn,this.logger,this.performanceClient,e.correlationId)(this.config,r.authority,i,this.logger,this.performanceClient);return await this.initiateAuthRequest(o,t)}catch(e){throw e instanceof de&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),e}}async executeEarFlow(e){const t=e.correlationId,r=await Za(this.getDiscoveredAuthority.bind(this),Kr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await Za(ga,uo,this.logger,this.performanceClient,t)(),o={...e,earJwk:n};this.browserStorage.cacheAuthorizeRequest(o),(await tl(document,this.config,r,o,this.logger,this.performanceClient)).submit()}async handleRedirectPromise(e="",t,r,n){const o=this.initializeServerTelemetryManager(865);try{const[i,a]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(ko,!0)||_.EMPTY_STRING;if(hr.removeHashFromUrl(s)===hr.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(s),await this.handleResponse(i,t,r,o);if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,t,r,o);if(!La()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Io,a,!0);const e={apiId:865,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let n=!0;if(s&&"null"!==s)this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),n=await this.navigationClient.navigateInternal(s,e);else{const t=function(){const e=new hr(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(ko,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),n=await this.navigationClient.navigateInternal(t,e)}if(!n)return await this.handleResponse(i,t,r,o)}return null}catch(e){throw e instanceof de&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===j?window.location.search:window.location.hash);let r=ur(t);if(r){try{!function(e,t,r){if(!e.state)throw Wi(Zo);const n=function(e,t){if(!t)return null;try{return Ic.parseRequestState(e,t).libraryState.meta}catch(e){throw it(Ae)}}(t,e.state);if(!n)throw Wi(ei);if(n.interactionType!==r)throw Wi(ti)}(r,this.browserCrypto,qo.Redirect)}catch(e){return e instanceof de&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return(n=window).location.hash="","function"==typeof n.history.replaceState&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}var n;const o=this.browserStorage.getTemporaryCache(Io,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Io)),o&&(r=ur(o),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}async handleResponse(e,t,r,n){if(!e.state)throw Wi(Zo);if(e.ear_jwe){const r=await Za(this.getDiscoveredAuthority.bind(this),Kr,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return Za(ol,En,this.logger,this.performanceClient,t.correlationId)(t,e,Do,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}const o=await Za(this.createAuthCodeClient.bind(this),gn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority});return Za(nl,Tn,this.logger,this.performanceClient,t.correlationId)(t,e,r,Do,this.config,o,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:Do,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},n=t||this.config.auth.onRedirectNavigate;return"function"==typeof n?(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==n(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,r)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,r))}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Wi(Qo)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(961);try{this.eventHandler.emitEvent(Os,qo.Redirect,e),await this.clearCacheOnLogout(t.account);const n={apiId:961,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await Za(this.createAuthCodeClient.bind(this),gn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===ie)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId),void this.eventHandler.emitEvent(Rs,qo.Redirect,t)}const i=o.getLogoutUri(t);if(this.eventHandler.emitEvent(Rs,qo.Redirect,t),!e||"function"!=typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(i,n);if(!1!==e.onRedirectNavigate(i))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(i,n);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(e){throw e instanceof de&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.eventHandler.emitEvent(Ms,qo.Redirect,null,e),this.eventHandler.emitEvent(Ds,qo.Redirect),e}this.eventHandler.emitEvent(Ds,qo.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return hr.getAbsoluteUrl(t,Na())}}async function ul(e,t,r,n,o){if(t.addQueueMeasurement(hn,n),!e)throw r.info("Navigate url is empty"),Wi(Qo);return o?Za(pl,fn,r,t,n)(e,o,t,n):Xa(fl,mn,r,t,n)(e)}async function dl(e,t,r,n,o){const i=ml();if(!i.contentDocument)throw"No document associated with iframe!";return(await tl(i.contentDocument,e,t,r,n,o)).submit(),i}async function hl(e,t,r,n,o,i,a){return n.addQueueMeasurement(pn,i),new Promise(((n,i)=>{t<1e4&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const s=window.setTimeout((()=>{window.clearInterval(c),i(Wi(si))}),t),c=window.setInterval((()=>{let t="";const r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let o="";r&&(o=a===j?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(c),n(o)}),r)})).finally((()=>{Xa(gl,$n,o,n,i)(e)}))}function pl(e,t,r,n){return r.addQueueMeasurement(fn,n),new Promise(((r,n)=>{const o=ml();window.setTimeout((()=>{o?(o.src=e,r(o)):n("Unable to load iframe")}),t)}))}function fl(e){const t=ml();return t.src=e,t}function ml(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function gl(e){document.body===e.parentNode&&document.body.removeChild(e)}class yl extends Bc{constructor(e,t,r,n,o,i,a,s,c,l,u){super(e,t,r,n,o,i,s,l,u),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(jr,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==F.NONE&&t.prompt!==F.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${F.NONE}`),t.prompt=F.NONE):t.prompt=F.NONE;const r=await Za(this.initializeAuthorizationRequest.bind(this),vn,this.logger,this.performanceClient,e.correlationId)(t,qo.Silent);return r.platformBroker=Wc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme),Da(r.authority),this.config.auth.protocolMode===ae?this.executeEarFlow(r):this.executeCodeFlow(r)}async executeCodeFlow(e){let t;const r=this.initializeServerTelemetryManager(this.apiId);try{return t=await Za(this.createAuthCodeClient.bind(this),gn,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await Za(this.silentTokenHelper.bind(this),dn,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(n){if(n instanceof de&&(n.setCorrelationId(this.correlationId),r.cacheFailedRequest(n)),!(t&&n instanceof de&&n.errorCode===go))throw n;return this.performanceClient.addFields({retryError:n.errorCode},this.correlationId),await Za(this.silentTokenHelper.bind(this),dn,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,r=await Za(this.getDiscoveredAuthority.bind(this),Kr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await Za(ga,uo,this.logger,this.performanceClient,t)(),o={...e,earJwk:n},i=await Za(dl,hn,this.logger,this.performanceClient,t)(this.config,r,o,this.logger,this.performanceClient),a=this.config.auth.OIDCOptions.serverResponseType,s=await Za(hl,pn,this.logger,this.performanceClient,t)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,a),c=Xa(Kc,Pn,this.logger,this.performanceClient,t)(s,a,this.logger);return Za(ol,En,this.logger,this.performanceClient,t)(o,c,this.apiId,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}logout(){return Promise.reject(Wi(hi))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(dn,r);const n=await Za(il,Jn,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),o={...t,codeChallenge:n.challenge},i=await Za(el,wn,this.logger,this.performanceClient,r)(this.config,e.authority,o,this.logger,this.performanceClient),a=await Za(ul,hn,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,c=await Za(hl,pn,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),l=Xa(Kc,Pn,this.logger,this.performanceClient,r)(c,s,this.logger);return Za(nl,Tn,this.logger,this.performanceClient,r)(t,l,n.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}}class vl extends kc{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Zr,e.correlationId);const t=dt(),r=await Za(this.executeTokenRequest.bind(this),Xr,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[R],o=new Lc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(r.body),Za(o.handleServerTokenResponse.bind(o),Nn,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw Jt(Ut);if(this.performanceClient?.addQueueMeasurement(en,e.correlationId),!e.account)throw it(Ue);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Za(this.acquireTokenWithCachedRefreshToken.bind(this),Jr,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const r=t instanceof ls&&t.errorCode===rs,n=t instanceof Tc&&"invalid_grant"===t.errorCode&&"client_mismatch"===t.subError;if(r||n)return Za(this.acquireTokenWithCachedRefreshToken.bind(this),Jr,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return Za(this.acquireTokenWithCachedRefreshToken.bind(this),Jr,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(Jr,e.correlationId);const r=Xa(this.cacheManager.getRefreshToken.bind(this.cacheManager),Yn,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw ds(rs);if(r.expiresOn&&ft(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),ds(os);const n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||te.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Hs}};try{return await Za(this.acquireToken.bind(this),Zr,this.logger,this.performanceClient,e.correlationId)(n)}catch(t){if(t instanceof ls&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),t.subError===is)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const e=mt(r);this.cacheManager.removeRefreshToken(e)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Xr,e.correlationId);const r=this.createTokenQueryParameters(e),n=hr.appendQueryString(t.tokenEndpoint,r),o=await Za(this.createTokenRequestBody.bind(this),tn,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),a=hs(this.config.authOptions.clientId,e);return Za(this.executePostToTokenEndpoint.bind(this),Yr,this.logger,this.performanceClient,e.correlationId)(n,o,i,a,e.correlationId,Yr)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(tn,e.correlationId);const t=new Map;if(ec(t,e.embeddedClientId||e.tokenBodyParameters?.[zs]||this.config.authOptions.clientId),e.redirectUri&&tc(t,e.redirectUri),Js(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),fc(t,"refresh_token"),mc(t),cc(t,this.config.libraryInfo),lc(t,this.config.telemetry.application),Ac(t),this.serverTelemetryManager&&!Pr(this.config)&&bc(t,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(t,e.refreshToken),this.config.clientCredentials.clientSecret&&dc(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;hc(t,await Oc(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),pc(t,r.assertionType)}if(e.authenticationScheme===te.POP){const r=new _c(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await Za(r.generateCnf.bind(r),Sn,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,vc(t,n)}else if(e.authenticationScheme===te.SSH){if(!e.sshJwk)throw Jt(Gt);wc(t,e.sshJwk)}if((!er.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&ac(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Hs:try{oc(t,nr(e.ccsCredential.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Fs:nc(t,e.ccsCredential.credential)}return e.embeddedClientId&&Ec(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&yc(t,e.tokenBodyParameters),Xs(t,e.correlationId,this.performanceClient),dr(t)}}class wl extends Bc{async acquireToken(e){this.performanceClient.addQueueMeasurement(Gr,e.correlationId);const t=await Za(Uc,sn,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const n=this.initializeServerTelemetryManager(61),o=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return Za(o.acquireTokenByRefreshToken.bind(o),en,this.logger,this.performanceClient,e.correlationId)(r).catch((e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e}))}logout(){return Promise.reject(Wi(hi))}async createRefreshTokenClient(e){const t=await Za(this.getClientConfiguration.bind(this),yn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new vl(t,this.performanceClient)}}class bl{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}async loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw Wi(wi);const n=e.correlationId||fa(),o=t.id_token?lt(t.id_token,Ji):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new es(es.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||fa()):void 0,s=await this.loadAccount(e,r.clientInfo||t.client_info||"",n,o,a),c=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,n),l=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,n),u=await this.loadRefreshToken(t,s.homeAccountId,s.environment,n);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:u},o,a)}async loadAccount(e,t,r,n,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=cr.createFromAccountInfo(e.account);return await this.storage.setAccount(t,r),t}if(!o||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Wi(xi);const i=cr.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=Nc(this.storage,o,i,Ji,n,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,r),s}async loadIdToken(e,t,r,n,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=gt(t,r,e.id_token,this.config.auth.clientId,n);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,r,n,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?tr.fromString(t.scope):new tr(e.scopes),c=i.expiresOn||t.expires_in+dt(),l=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+dt(),u=yt(r,n,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,l,Ji);return await this.storage.setAccessTokenCredential(u,a),u}async loadRefreshToken(e,t,r,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=vt(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,n),o}generateAuthenticationResult(e,t,r,n){let o,i="",a=[],s=null;t?.accessToken&&(i=t.accessToken.secret,a=tr.fromString(t.accessToken.target).asArray(),s=pt(t.accessToken.expiresOn),o=pt(t.accessToken.extendedExpiresOn));const c=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}class Al extends Rc{constructor(e){super(e),this.includeRedirectUri=!1}}class El extends Bc{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,s,c,l),this.apiId=a}async acquireToken(e){if(!e.code)throw Wi(Ii);const t=await Za(this.initializeAuthorizationRequest.bind(this),vn,this.logger,this.performanceClient,e.correlationId)(e,qo.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const n={...t,code:e.code},o=await Za(this.getClientConfiguration.bind(this),yn,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new Al(o);this.logger.verbose("Auth code client created");const a=new Yc(i,this.browserStorage,n,this.logger,this.performanceClient);return await Za(a.handleCodeResponseFromServer.bind(a),bn,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(e){throw e instanceof de&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}logout(){return Promise.reject(Wi(hi))}}function Cl(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function Tl(e,t){try{Ra(e)}catch(e){throw t.end({success:!1},e),e}}class xl{constructor(e){var t,r,n,o;this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Ya(this.logger,this.performanceClient):at,this.eventHandler=new Bs(this.logger),this.browserStorage=this.isBrowserEnvironment?new Us(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(e){throw Jt(Ft)}return{canonicalAuthority:e.authority?ts(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}(this.config.auth)):(t=this.config.auth.clientId,r=this.logger,n=this.performanceClient,o=this.eventHandler,new Us(t,{cacheLocation:xo,temporaryCacheLocation:xo,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},at,r,n,o));const i={cacheLocation:xo,temporaryCacheLocation:xo,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Us(this.config.auth.clientId,i,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new bl(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const r=new xl(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(bs);const t=e?.correlationId||this.getRequestCorrelationId(),r=this.config.system.allowPlatformBroker,n=this.performanceClient.startMeasurement(ln,t);if(this.eventHandler.emitEvent("msal:initializeStart"),await Za(this.browserStorage.initialize.bind(this.browserStorage),un,this.logger,this.performanceClient,t)(t),r)try{this.nativeExtensionProvider=await Wc.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await Za(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Vn,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t),this.initialized=!0,this.eventHandler.emitEvent(bs),n.end({allowPlatformBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Oa(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return void 0===r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const t=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),n=r&&Wc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e;let o,i=this.performanceClient.startMeasurement(Br,r?.correlationId||"");if(this.eventHandler.emitEvent("msal:handleRedirectStart",qo.Redirect),n&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new Zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,865,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);o=Za(e.handleRedirectPromise.bind(e),Wn,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{const[t,r]=this.browserStorage.getCachedRequest(),n=t.correlationId;i.discard(),i=this.performanceClient.startMeasurement(Br,n),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const a=this.createRedirectClient(n);o=Za(a.handleRedirectPromise.bind(a),Gn,this.logger,this.performanceClient,i.event.correlationId)(e,t,r,i)}return o.then((e=>(e?(this.browserStorage.resetRequestCache(),t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(xs,qo.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(_s,qo.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:Cl(e.account)})):i.event.errorCode?i.end({success:!1}):i.discard(),this.eventHandler.emitEvent(Ns,qo.Redirect),e))).catch((e=>{this.browserStorage.resetRequestCache();const r=e;throw t.length>0?this.eventHandler.emitEvent(Ss,qo.Redirect,null,r):this.eventHandler.emitEvent(ks,qo.Redirect,null,r),this.eventHandler.emitEvent(Ns,qo.Redirect),i.end({success:!1},r),e}))}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement("acquireTokenPreRedirect",t);r.add({accountType:Cl(e.account),scenarioId:e.scenarioId});const n=e.onRedirectNavigate;if(n)e.onRedirectNavigate=e=>{const t="function"==typeof n?n(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const n="function"==typeof e?e(t):void 0;return!1!==n?r.end({success:!0}):r.discard(),n}}const o=this.getAllAccounts().length>0;try{let n;return Ma(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),o?this.eventHandler.emitEvent(Is,qo.Redirect,e):this.eventHandler.emitEvent(Ts,qo.Redirect,e),n=this.nativeExtensionProvider&&this.canUsePlatformBroker(e)?new Zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Do,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch((r=>{if(r instanceof zc&&jc(r))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(r instanceof ls)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw r})):this.createRedirectClient(t).acquireToken(e),await n}catch(e){throw this.browserStorage.resetRequestCache(),r.end({success:!1},e),o?this.eventHandler.emitEvent(Ss,qo.Redirect,null,e):this.eventHandler.emitEvent(ks,qo.Redirect,null,e),e}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(qr,t);r.add({scenarioId:e.scenarioId,accountType:Cl(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Tl(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(e){return Promise.reject(e)}const n=this.getAllAccounts();let o;n.length>0?this.eventHandler.emitEvent(Is,qo.Popup,e):this.eventHandler.emitEvent(Ts,qo.Popup,e);const i=this.getPreGeneratedPkceCodes(t);return o=this.canUsePlatformBroker(e)?this.acquireTokenNative({...e,correlationId:t},Uo).then((e=>(r.end({success:!0,isNativeBroker:!0,accountType:Cl(e.account)}),e))).catch((r=>{if(r instanceof zc&&jc(r))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e,i);if(r instanceof ls)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,i);throw r})):this.createPopupClient(t).acquireToken(e,i),o.then((e=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(xs,qo.Popup,e):this.eventHandler.emitEvent(_s,qo.Popup,e),r.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Cl(e.account)}),e))).catch((e=>(n.length>0?this.eventHandler.emitEvent(Ss,qo.Popup,null,e):this.eventHandler.emitEvent(ks,qo.Popup,null,e),r.end({success:!1},e),Promise.reject(e)))).finally((async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)}))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};let n;return this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Wr,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:Cl(e.account)}),Tl(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent("msal:ssoSilentStart",qo.Silent,r),n=this.canUsePlatformBroker(r)?this.acquireTokenNative(r,863).catch((e=>{if(e instanceof zc&&jc(e))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw e})):this.createSilentIframeClient(r.correlationId).acquireToken(r),n.then((e=>(this.eventHandler.emitEvent("msal:ssoSilentSuccess",qo.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Cl(e.account)}),e))).catch((e=>{throw this.eventHandler.emitEvent("msal:ssoSilentFailure",qo.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(Rr,t);Tl(this.initialized,r),this.eventHandler.emitEvent("msal:acquireTokenByCodeStart",qo.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Wi(Si);if(e.code){const n=e.code;let o=this.hybridAuthCodeResponses.get(n);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync({...e,correlationId:t}).then((e=>(this.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",qo.Silent,e),this.hybridAuthCodeResponses.delete(n),r.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Cl(e.account)}),e))).catch((e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(Ls,qo.Silent,null,e),r.end({success:!1},e),e})),this.hybridAuthCodeResponses.set(n,o)),await o}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){const n=await this.acquireTokenNative({...e,correlationId:t},866,e.nativeAccountId).catch((e=>{throw e instanceof zc&&jc(e)&&(this.nativeExtensionProvider=void 0),e}));return r.end({accountType:Cl(n.account),success:!0}),n}throw Wi(Ni)}throw Wi(_i)}catch(e){throw this.eventHandler.emitEvent(Ls,qo.Silent,null,e),r.end({success:!1},e),e}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(jn,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then((e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e))).catch((e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(rn,e.correlationId),t){case 0:case 1:case 2:const t=this.createSilentCacheClient(e.correlationId);return Za(t.acquireToken.bind(t),zr,this.logger,this.performanceClient,e.correlationId)(e);default:throw it(We)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Mr,e.correlationId),t){case 0:case 2:case 3:case 4:const t=this.createSilentRefreshClient(e.correlationId);return Za(t.acquireToken.bind(t),Gr,this.logger,this.performanceClient,e.correlationId)(e);default:throw it(We)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(an,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return Za(t.acquireToken.bind(t),jr,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return Ma(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Ra(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e).finally((()=>{this.browserStorage.setInteractionInProgress(!1)}))}catch(e){return Promise.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return function(e,t,r,n){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(n):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return function(e,t,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const n=r.getAccountInfoFilteredBy(e);return n?(t.verbose("getAccount: Account matching provided filter found, returning"),n):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByUsername(e){return function(e,t,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const n=r.getAccountInfoFilteredBy({username:e});return n?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),n):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return function(e,t,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const n=r.getAccountInfoFilteredBy({homeAccountId:e});return n?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),n):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return function(e,t,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const n=r.getAccountInfoFilteredBy({localAccountId:e});return n?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),n):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}setActiveAccount(e){!function(e,t){t.setActiveAccount(e)}(e,this.browserStorage)}getActiveAccount(){return this.browserStorage.getActiveAccount()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=cr.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Wi(Ri);return new Zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,n)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!Wc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case F.NONE:case F.CONSENT:case F.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new cl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new ll(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new yl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,863,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new Xc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new wl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new El(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,866,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Pa(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===Co?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===Co?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?fa():_.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||Bo})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||Bo})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(Dr,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Tl(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const n=e.account||this.getActiveAccount();if(!n)throw Wi(pi);return r.add({accountType:Cl(n)}),this.acquireTokenSilentDeduped(e,n,t).then((n=>(r.end({success:!0,fromCache:n.fromCache,isNativeBroker:n.fromNativeBroker,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length}),{...n,state:e.state,correlationId:t}))).catch((e=>{throw e instanceof de&&e.setCorrelationId(t),r.end({success:!1},e),e}))}async acquireTokenSilentDeduped(e,t,r){const n=hs(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority,correlationId:r},t.homeAccountId),o=JSON.stringify(n),i=this.activeSilentTokenRequests.get(o);if(void 0===i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),this.performanceClient.addFields({deduped:!1},r);const n=Za(this.acquireTokenSilentAsync.bind(this),Ur,this.logger,this.performanceClient,r)({...e,correlationId:r},t);return this.activeSilentTokenRequests.set(o,n),n.finally((()=>{this.activeSilentTokenRequests.delete(o)}))}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),this.performanceClient.addFields({deduped:!0},r),i}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Ur,e.correlationId),this.eventHandler.emitEvent(Is,qo.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const n=await Za(qc,cn,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||0;return this.acquireTokenSilentNoIframe(n,o).catch((async e=>{const t=function(e,t){const r=!(e instanceof ls&&e.subError!==is),n=e.errorCode===go||e.errorCode===We,o=r&&n||e.errorCode===rs||e.errorCode===os,i=zo.includes(t);return o&&i}(e,o);if(t){if(this.activeIframeRequest){if(5!==o){const[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,n.correlationId);const i=this.performanceClient.startMeasurement("awaitConcurrentIframe",n.correlationId);i.add({awaitIframeCorrelationId:r});const a=await t;if(i.end({success:a}),a)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,o);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),Za(this.acquireTokenBySilentIframe.bind(this),an,this.logger,this.performanceClient,n.correlationId)(n)}{let e;return this.activeIframeRequest=[new Promise((t=>{e=t})),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),Za(this.acquireTokenBySilentIframe.bind(this),an,this.logger,this.performanceClient,n.correlationId)(n).then((t=>(e(!0),t))).catch((t=>{throw e(!1),t})).finally((()=>{this.activeIframeRequest=void 0}))}}throw e})).then((t=>(this.eventHandler.emitEvent(_s,qo.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t))).catch((e=>{throw this.eventHandler.emitEvent(Ss,qo.Silent,null,e),e})).finally((()=>{document.removeEventListener("visibilitychange",r)}))}async acquireTokenSilentNoIframe(e,t){return Wc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,61,e.account.nativeAccountId,t).catch((async e=>{if(e instanceof zc&&jc(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,it(We);throw e}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),1===t&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),Za(this.acquireTokenFromCache.bind(this),rn,this.logger,this.performanceClient,e.correlationId)(e,t).catch((r=>{if(1===t)throw r;return this.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",qo.Silent,e),Za(this.acquireTokenByRefreshToken.bind(this),Mr,this.logger,this.performanceClient,e.correlationId)(e,t)})))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await Za(il,Jn,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((t?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}}class kl{static async createPublicClientApplication(e){const t=await async function(e){const t=new Ba(e);return await t.initialize(),xl.createController(t,void 0)}(e);return new kl(e,t)}constructor(e,t){this.controller=t||new xl(new Ba(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var Il,_l={auth:{clientId:"".concat("768ccbfe-c251-4fe4-bfeb-eff27fdd356e"),authority:"https://login.microsoftonline.com/".concat("5ef3243e-fce7-454b-8508-f38fa4259f55"),redirectUri:"".concat("https://michel-bodje.github.io/automate/taskpane.html")},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:function(e,t){return console.log("MSAL: ".concat(t))},logLevel:"Verbose"}}},Sl=new kl(_l),Ll=r(5135),Nl=r.n(Ll),Pl=r(3227),Ol=r.n(Pl);function Rl(e){return Rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rl(e)}function Ml(){Ml=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:k(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function w(){}var b={};l(b,a,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(N([])));E&&E!==r&&n.call(E,a)&&(b=E);var C=w.prototype=y.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,i,a,s){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==Rl(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function k(t,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var l=d(t,r,n);if("normal"===l.type){if(o=n.done?m:p,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function I(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Rl(t)+" is not iterable")}return v.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:v,configurable:!0}),v.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},T(x.prototype),l(x.prototype,s,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new x(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(C),l(C,c,"Generator"),l(C,a,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Dl(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function Ul(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Dl(i,n,o,a,s,"next",e)}function s(e){Dl(i,n,o,a,s,"throw",e)}a(void 0)}))}}function ql(e){Office.context.mailbox.item.subject.setAsync(e,(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to set subject:",e.error.message)}))}function Bl(e){Office.context.mailbox.item.body.setAsync(e,{coercionType:Office.CoercionType.Html},(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to set body:",e.error.message)}))}function Hl(e){var t;Office.context.mailbox.item.categories?(t=function(){return function(e){Office.context.mailbox.item.categories.addAsync(e,(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to set category:",e.error.message)}))}(e)},function(e){Office.context.mailbox.item.categories.getAsync((function(t){t.status===Office.AsyncResultStatus.Failed?(console.error("Failed to get categories. Error:",t.error.message),e([])):e(t.value||[])}))}((function(e){if(0!==e.length){var r=e.map((function(e){return e.displayName}));Office.context.mailbox.item.categories.removeAsync(r,(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to remove categories. Error:",e.error.message),t()}))}else t()}))):console.error("Categories API is not available.")}function Fl(e){Office.context.mailbox.item.location.setAsync(e,(function(t){t.status===Office.AsyncResultStatus.Failed?console.error("Failed to set location:",t.error.message):console.log("Location set successfully:",e)}))}function zl(e,t){return"fr"===e?"contract"===t?"Contrat de services - Allen Madelin":"reply"===t?"Réponse - Allen Madelin":"Confirmation de rendez-vous - Allen Madelin":"contract"===t?"Contract of services - Allen Madelin":"reply"===t?"Reply - Allen Madelin":"Confirmation of appointment - Allen Madelin"}function jl(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(isNaN(e))throw console.error("Amount is not a number:",e),new Error("Amount is not a valid number.");var r=1.14975*e;return t&&(r+=100),r}function Gl(e){return Wl.apply(this,arguments)}function Wl(){return(Wl=Ul(Ml().mark((function e(t){var r,n,o,i,a,s,c,l,u,d,h,p,f,m;return Ml().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=Td.clientEmail){e.next=4;break}throw new Error("No client email provided.");case 4:if(Qd(r)){e.next=6;break}throw new Error("Please provide a valid email address.");case 6:if(n="Français"===Td.clientLanguage?"fr":"en",o=Ld[n][t],Ld.en.signature,o){e.next=11;break}throw new Error('No template found for type "'.concat(t,'" in language "').concat(n,'".'));case 11:if(i=rd(Td.lawyerId),a=o,s=new Date("".concat(Td.appointmentDate,"T").concat(Td.appointmentTime)),"office"!==t&&"teams"!==t&&"phone"!==t){e.next=21;break}if(s){e.next=17;break}throw new Error("No appointment date and time provided.");case 17:l=(c=s).toLocaleDateString("fr"==n?"fr-CA":"en-US",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),u=c.toLocaleTimeString("fr"==n?"fr-CA":"en-US",{hour:"2-digit",minute:"2-digit"}),a=a.replace("{{date}}",l).replace("{{time}}",u);case 21:d=Td.depositAmount,h=jl(Td.depositAmount,!0),d=Number(d).toFixed(),h=Number(h).toFixed(2),p=Td.isFirstConsultation,m=jl(f=p?125:350),f=Number(f).toFixed(),m=Number(m).toFixed(2),a=a.replace("{{lawyerName}}",i.name).replace("{{depositAmount}}",d).replace("{{totalAmount}}",h).replace("{{rates}}",f).replace("{{totalRates}}",m),ql(zl(n,t)),g=r,Office.context.mailbox.item.to.setAsync([g],(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to set recipient:",e.error.message)})),Bl(a),e.next=41;break;case 37:throw e.prev=37,e.t0=e.catch(0),console.error("createEmail:",e.t0),e.t0;case 41:case"end":return e.stop()}var g}),e,null,[[0,37]])})))).apply(this,arguments)}function Kl(e){return $l.apply(this,arguments)}function $l(){return($l=Ul(Ml().mark((function e(t){var r,n,o,i,a;return Ml().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=rd(Td.lawyerId),n=t.location.charAt(0).toUpperCase()+t.location.slice(1),o=Vd(),i="".concat(Td.clientName," (ma)"),a="\n      <p>Client:&nbsp;&nbsp;&nbsp;&nbsp;".concat(Td.clientName,"<br>\n\n      Phone:&nbsp;&nbsp;&nbsp;").concat(Td.clientPhone,"<br>\n\n      Email:&nbsp;&nbsp;&nbsp;&nbsp;").concat(Td.clientEmail,"<br>\n\n      Lang:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;").concat(Td.clientLanguage,"</p>\n\n      ").concat(Td.isRefBarreau?"<p><u><em>Ref. Barreau</em></u></p>":"","\n\n      <p>").concat(Td.isFirstConsultation?'<span style="background-color: yellow;">First Consultation</span>':'<span style="background-color: #d3d3d3;">Follow-up</span>',"\n      : ").concat(o,"</p>\n\n      <p><strong>Payment</strong>  ").concat(Td.isPaymentMade?"✔️":"❌","<br>\n      \n      ").concat(Td.isPaymentMade?"".concat(Td.paymentMethod," (ma)"):"",'</p>\n      \n      <p>Notes:<br>\n      <span style="font-style: italic">').concat(Td.notes,"</span></p>\n    "),Hl([r.name]),ql(i),c=t.start,l=t.end,Office.context.mailbox.item.start.setAsync(c,(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to set start time:",e.error.message)})),Office.context.mailbox.item.end.setAsync(l,(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to set end time:",e.error.message)})),s=[{displayName:r.name,emailAddress:r.email}],Office.context.mailbox.item.requiredAttendees.setAsync(s,(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to set attendees:",e.error.message)})),Fl(n),Bl(a),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),console.error("createMeeting:",e.t0),e.t0;case 18:case"end":return e.stop()}var s,c,l}),e,null,[[0,14]])})))).apply(this,arguments)}function Vl(){return Vl=Ul(Ml().mark((function e(){var t,r,n,o,i,a,s,c,l,u,d;return Ml().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Td.clientName,r=Td.clientEmail,n=Td.contractTitle,o=Td.depositAmount,i=Td.clientLanguage,t&&r&&n&&o){e.next=4;break}return console.error("One or more inputs are missing."),e.abrupt("return");case 4:if(Qd(r)){e.next=7;break}return console.error("Invalid email format."),e.abrupt("return");case 7:return a="Français"===i?"fr":"en",e.prev=8,e.next=11,Pd(a,"contract");case 11:return s=e.sent,c=new(Ol())(s),l=new(Nl())(c,{paragraphLoop:!0,linebreaks:!0}),u={clientName:t,clientEmail:"{{clientEmail}}",contractTitle:n,depositAmount:Number(o).toFixed(),totalAmount:Number(jl(o,!0)).toFixed(2),date:(new Date).toLocaleDateString()},l.render(u),d=l.getZip().generate({type:"base64"}),e.next=19,Word.run(function(){var e=Ul(Ml().mark((function e(t){var n,o,i;return Ml().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.application.createDocument(d),t.trackedObjects.add(n),e.next=4,t.sync();case 4:return o=n.body.search("{{clientEmail}}"),t.load(o,"items"),e.next=8,t.sync();case 8:if(0!==o.items.length){e.next=11;break}return console.error("Placeholder {{clientEmail}} not found in the document."),e.abrupt("return");case 11:return i='<a href="mailto:'.concat(r,'">').concat(r,"</a>"),o.items[0].insertHtml(i,Word.InsertLocation.replace),e.next=15,t.sync();case 15:console.log("Replaced {{clientEmail}} with a mailto hyperlink using HTML."),n.open(),t.trackedObjects.remove(n);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(8),console.error("Error creating contract:",e.t0);case 24:case"end":return e.stop()}}),e,null,[[8,21]])}))),Vl.apply(this,arguments)}function Yl(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError,function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(Il||(Il={}));class Ql{static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let r=t.next();for(;!r.done;){const e=r.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;let o=r;for(r=t.next();!r.done;){const e=r.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==o.value[1].id)return!1;o=r,r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const n=r.value[1];let o;if(void 0===n.dependsOn||0===n.dependsOn.length)o=n.id;else{if(1!==n.dependsOn.length)return!1;{const t=n.dependsOn[0];if(t===n.id||!e.has(t))return!1;o=t}}for(r=t.next();!r.done;){const e=r.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&o!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===o||e.dependsOn[0]!==o))return!1;if(e.dependsOn.length>1)return!1}r=t.next()}return!0})(e)}static getRequestData(e){return Yl(this,void 0,void 0,(function*(){const t={url:""},r=new RegExp("^https?://");t.url=r.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const n={};return e.headers.forEach(((e,t)=>{n[t]=e})),Object.keys(n).length&&(t.headers=n),e.method!==Il.PATCH&&e.method!==Il.POST&&e.method!==Il.PUT||(t.body=yield Ql.getRequestBody(e)),t}))}static getRequestBody(e){return Yl(this,void 0,void 0,(function*(){let t,r=!1;try{const n=e.clone();t=yield n.json(),r=!0}catch(e){}if(!r)try{if("undefined"!=typeof Blob){const r=yield e.blob(),n=new FileReader;t=yield new Promise((e=>{n.addEventListener("load",(()=>{const t=n.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])}),!1),n.readAsDataURL(r)}))}else"undefined"!=typeof Buffer&&(t=(yield e.buffer()).toString("base64"));r=!0}catch(e){}return t}))}constructor(e){if(this.requests=new Map,void 0!==e){const t=Ql.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}addRequest(e){const t=Ql.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),r=this.requests.entries();let n=r.next();for(;!n.done;){const t=n.value[1].dependsOn;if(void 0!==t){const r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&delete n.value[1].dependsOn}n=r.next()}return t}getContent(){return Yl(this,void 0,void 0,(function*(){const e=[],t={requests:e},r=this.requests.entries();let n=r.next();if(n.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!Ql.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!n.done;){const t=n.value[1],o=yield Ql.getRequestData(t.request);if(void 0!==o.body&&(void 0===o.headers||void 0===o.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}o.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(o.dependsOn=t.dependsOn),e.push(o),n=r.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const r=this.requests.get(e);if(void 0===r.dependsOn&&(r.dependsOn=[]),-1!==r.dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}r.dependsOn.push(t)}else{const r=this.requests.entries();let n,o=r.next();for(;!o.done&&o.value[1].id!==e;)n=o,o=r.next();if(void 0===n){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=n.value[0];if(void 0===o.value[1].dependsOn&&(o.value[1].dependsOn=[]),-1!==o.value[1].dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}o.value[1].dependsOn.push(t)}}}removeDependency(e,t){const r=this.requests.get(e);if(void 0===r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if(void 0!==t){const e=r.dependsOn.indexOf(t);return-1!==e&&(r.dependsOn.splice(e,1),!0)}return delete r.dependsOn,!0}}Ql.requestLimit=20;const Xl=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class Zl extends Error{static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new Zl,t.customError=e),t}constructor(e){super(e),Object.setPrototypeOf(this,Zl.prototype)}}const Jl=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],eu=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},tu=e=>nu(e),ru=(e,t)=>(t.forEach((e=>ou(e))),nu(e,t)),nu=(e,t=Xl)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const r=(e=e.replace("https://","")).indexOf(":"),n=e.indexOf("/");let o="";if(-1!==n)return-1!==r&&r<n?(o=e.substring(0,r),t.has(o)):(o=e.substring(0,n),t.has(o))}return!1},ou=e=>{if(-1!==e.indexOf("/"))throw new Zl("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class iu{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const au=(e,t,r)=>{let n=null;if("undefined"!=typeof Request&&e instanceof Request)n=e.headers.get(r);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)n=t.headers.get(r);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,o=e.length;t<o;t++)if(e[t][0]===r){n=e[t][1];break}}else void 0!==t.headers[r]&&(n=t.headers[r]);return n},su=(e,t,r,n)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(r,n);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[r]:n});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(r,n);else if(t.headers instanceof Array){let e=0;const o=t.headers.length;for(;e<o;e++){const o=t.headers[e];if(o[0]===r){o[1]=n;break}}e===o&&t.headers.push([r,n])}else Object.assign(t.headers,{[r]:n})},cu=(e,t,r,n)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(r,n):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[r]:n}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(r,n):t.headers instanceof Array?t.headers.push([r,n]):void 0===t.headers?t.headers={[r]:n}:void 0===t.headers[r]?t.headers[r]=n:t.headers[r]+=`, ${n}`)};class lu{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var uu,du,hu,pu,fu,mu,gu;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(uu||(uu={}));class yu{constructor(){this.featureUsage=uu.NONE}static updateFeatureUsageFlag(e,t){let r;e.middlewareControl instanceof iu?r=e.middlewareControl.getMiddlewareOptions(yu):e.middlewareControl=new iu,void 0===r&&(r=new yu,e.middlewareControl.setMiddlewareOptions(yu,r)),r.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class vu{constructor(e){this.authenticationProvider=e}execute(e){return Yl(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(tu(t)||e.customHosts&&ru(t,e.customHosts)){let t,r,n;e.middlewareControl instanceof iu&&(t=e.middlewareControl.getMiddlewareOptions(lu)),t&&(r=t.authenticationProvider,n=t.authenticationProviderOptions),r||(r=this.authenticationProvider);const o=`Bearer ${yield r.getAccessToken(n)}`;cu(e.request,e.options,vu.AUTHORIZATION_HEADER,o),yu.updateFeatureUsageFlag(e,uu.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[vu.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}vu.AUTHORIZATION_HEADER="Authorization";class wu{constructor(e=wu.DEFAULT_DELAY,t=wu.DEFAULT_MAX_RETRIES,r=wu.defaultShouldRetry){if(e>wu.MAX_DELAY&&t>wu.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${wu.MAX_DELAY} and ${wu.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>wu.MAX_DELAY){const e=new Error(`Delay should not be more than ${wu.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>wu.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${wu.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,wu.MAX_DELAY),this.maxRetries=Math.min(t,wu.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return wu.MAX_DELAY}}wu.DEFAULT_DELAY=3,wu.DEFAULT_MAX_RETRIES=3,wu.MAX_DELAY=180,wu.MAX_MAX_RETRIES=10,wu.defaultShouldRetry=()=>!0;class bu{constructor(e=new wu){this.options=e}isRetry(e){return-1!==bu.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const r="string"==typeof e?t.method:e.method;return r!==Il.PUT&&r!==Il.PATCH&&r!==Il.POST||"application/octet-stream"!==au(e,t,"Content-Type")}getDelay(e,t,r){const n=()=>Number(Math.random().toFixed(3)),o=void 0!==e.headers?e.headers.get(bu.RETRY_AFTER_HEADER):null;let i;return i=null!==o?Number.isNaN(Number(o))?Math.round((new Date(o).getTime()-Date.now())/1e3):Number(o):t>=2?this.getExponentialBackOffTime(t)+r+n():r+n(),Math.min(i,this.options.getMaxDelay()+n())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return Yl(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof iu&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new wu,this.options)),t}executeWithRetry(e,t,r){return Yl(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(e),t<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,t,e.request,e.options,e.response)){++t,su(e.request,e.options,bu.RETRY_ATTEMPT_HEADER,t.toString());const n=this.getDelay(e.response,t,r.delay);return yield this.sleep(n),yield this.executeWithRetry(e,t,r)}}))}execute(e){return Yl(this,void 0,void 0,(function*(){const t=this.getOptions(e);return yu.updateFeatureUsageFlag(e,uu.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)}))}setNext(e){this.nextMiddleware=e}}bu.RETRY_STATUS_CODES=[429,503,504],bu.RETRY_ATTEMPT_HEADER="Retry-Attempt",bu.RETRY_AFTER_HEADER="Retry-After";class Au{constructor(e=Au.DEFAULT_MAX_REDIRECTS,t=Au.defaultShouldRedirect){if(e>Au.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${Au.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}Au.DEFAULT_MAX_REDIRECTS=5,Au.MAX_MAX_REDIRECTS=20,Au.defaultShouldRedirect=()=>!0;class Eu{constructor(e=new Au){this.options=e}isRedirect(e){return-1!==Eu.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(Eu.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(Eu.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,n=r.exec(e);let o,i;null!==n&&(o=n[0]);const a=r.exec(t);return null!==a&&(i=a[0]),void 0!==o&&void 0!==i&&o!==i}updateRequestUrl(e,t){return Yl(this,void 0,void 0,(function*(){var r,n;t.request="string"==typeof t.request?e:yield(r=e,n=t.request,Yl(void 0,void 0,void 0,(function*(){const e=n.headers.get("Content-Type")?yield n.blob():yield Promise.resolve(void 0),{method:t,headers:o,referrer:i,referrerPolicy:a,mode:s,credentials:c,cache:l,redirect:u,integrity:d,keepalive:h,signal:p}=n;return new Request(r,{method:t,headers:o,body:e,referrer:i,referrerPolicy:a,mode:s,credentials:c,cache:l,redirect:u,integrity:d,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof iu&&(t=e.middlewareControl.getMiddlewareOptions(Au)),void 0===t&&(t=Object.assign(new Au,this.options)),t}executeWithRedirect(e,t,r){return Yl(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(e);const n=e.response;if(t<r.maxRedirects&&this.isRedirect(n)&&this.hasLocationHeader(n)&&r.shouldRedirect(n)){if(++t,n.status===Eu.STATUS_CODE_SEE_OTHER)e.options.method=Il.GET,delete e.options.body;else{const t=this.getLocationHeader(n);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(n.url,t)&&delete e.options.headers[Eu.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,r)}}))}execute(e){return Yl(this,void 0,void 0,(function*(){const t=this.getOptions(e);return e.options.redirect=Eu.MANUAL_REDIRECT,yu.updateFeatureUsageFlag(e,uu.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)}))}setNext(e){this.nextMiddleware=e}}Eu.REDIRECT_STATUS_CODES=[301,302,303,307,308],Eu.STATUS_CODE_SEE_OTHER=303,Eu.LOCATION_HEADER="Location",Eu.AUTHORIZATION_HEADER="Authorization",Eu.MANUAL_REDIRECT="manual";class Cu{execute(e){return Yl(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(tu(t)||e.customHosts&&ru(t,e.customHosts)){let t=au(e.request,e.options,Cu.CLIENT_REQUEST_ID_HEADER);t||(t=(()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e})(),su(e.request,e.options,Cu.CLIENT_REQUEST_ID_HEADER,t));let r,n=`${Cu.PRODUCT_NAME}/3.0.7`;if(e.middlewareControl instanceof iu&&(r=e.middlewareControl.getMiddlewareOptions(yu)),r){const e=r.getFeatureUsage();n+=` (${Cu.FEATURE_USAGE_STRING}=${e})`}cu(e.request,e.options,Cu.SDK_VERSION_HEADER,n)}else delete e.options.headers[Cu.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[Cu.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}Cu.CLIENT_REQUEST_ID_HEADER="client-request-id",Cu.SDK_VERSION_HEADER="SdkVersion",Cu.PRODUCT_NAME="graph-js",Cu.FEATURE_USAGE_STRING="featureUsage",r(65606),(hu=du||(du={}))[hu.MANUAL=0]="MANUAL",hu[hu.RANDOM=1]="RANDOM",function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(pu||(pu={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(fu||(fu={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(mu||(mu={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(gu||(gu={}));class Tu{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new Promise(((r,n)=>{e.text().then((e=>{try{const n=(new DOMParser).parseFromString(e,t);r(n)}catch(e){n(e)}}))})):Promise.resolve(e.body)}static convertResponse(e,t){return Yl(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let r;const n=e.headers.get("Content-type");switch(t){case pu.ARRAYBUFFER:r=yield e.arrayBuffer();break;case pu.BLOB:r=yield e.blob();break;case pu.DOCUMENT:r=yield Tu.parseDocumentResponse(e,fu.TEXT_XML);break;case pu.JSON:r=yield e.json();break;case pu.STREAM:r=yield Promise.resolve(e.body);break;case pu.TEXT:r=yield e.text();break;default:if(null!==n){const t=n.split(";")[0];r=new RegExp(gu.DOCUMENT).test(t)?yield Tu.parseDocumentResponse(e,t):new RegExp(gu.IMAGE).test(t)?e.blob():t===mu.TEXT_PLAIN?yield e.text():t===mu.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else r=Promise.resolve(e.body)}return r}))}static getResponse(e,t,r){return Yl(this,void 0,void 0,(function*(){if(t===pu.RAW)return Promise.resolve(e);{const n=yield Tu.convertResponse(e,t);if(!e.ok)throw n;if("function"!=typeof r)return n;r(null,n)}}))}}class xu{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class ku{get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}constructor(e,t){this._location=t,this._responseBody=e}static CreateUploadResult(e,t){return new ku(e,t.get("location"))}}class Iu{static createUploadSession(e,t,r,n={}){return Yl(this,void 0,void 0,(function*(){const o=yield e.api(t).headers(n).post(r);return{url:o.uploadUrl,expiry:new Date(o.expirationDateTime),isCancelled:!1}}))}constructor(e,t,r,n={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new Zl("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,n.rangeSize||(n.rangeSize=this.DEFAULT_FILE_SIZE),this.options=n,this.uploadSession=r,this.nextRange=new xu(0,this.options.rangeSize-1)}parseRange(e){const t=e[0];if(void 0===t||""===t)return new xu;const r=t.split("-"),n=parseInt(r[0],10);let o=parseInt(r[1],10);return Number.isNaN(o)&&(o=this.file.size-1),new xu(n,o)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new xu(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new Zl("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return Yl(this,void 0,void 0,(function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const r=yield this.file.sliceFile(t),n=yield this.uploadSliceGetRawResponse(r,t,this.file.size);if(!n)throw new Zl("Something went wrong! Large file upload slice response is null.");const o=yield Tu.getResponse(n);if(201===n.status||200===n.status&&o.id)return this.reportProgress(e,t),ku.CreateUploadResult(o,n.headers);const i={expirationDateTime:o.expirationDateTime||o.ExpirationDateTime,nextExpectedRanges:o.NextExpectedRanges||o.nextExpectedRanges};this.updateTaskStatus(i),this.reportProgress(e,t)}}))}reportProgress(e,t){e&&e.progress&&e.progress(t,e.extraCallbackParam)}uploadSlice(e,t,r){return Yl(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${r}`,"Content-Type":"application/octet-stream"}).put(e)}))}uploadSliceGetRawResponse(e,t,r){return Yl(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${r}`,"Content-Type":"application/octet-stream"}).responseType(pu.RAW).put(e)}))}cancel(){return Yl(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).responseType(pu.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e}))}getStatus(){return Yl(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}))}resume(){return Yl(this,void 0,void 0,(function*(){return yield this.getStatus(),yield this.upload()}))}getUploadSession(){return this.uploadSession}}class _u{constructor(e,t,r){if(this.content=e,this.name=t,this.size=r,!e||!t||!r)throw new Zl("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}class Su extends Iu{static constructCreateSessionUrl(e,t=Su.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map((e=>encodeURIComponent(e))).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let r,n;if("undefined"!=typeof Blob&&e instanceof Blob)r=new File([e],t),n=r.size;else if("undefined"!=typeof File&&e instanceof File)r=e,n=r.size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){const t=e;n=t.byteLength,r=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:r,size:n}}static create(e,t,r){return Yl(this,void 0,void 0,(function*(){if(!e||!t||!r)throw new Zl("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const n=r.fileName,o=Su.getFileInfo(t,n),i=new _u(o.content,n,o.size);return this.createTaskWithFileObject(e,i,r)}))}static createTaskWithFileObject(e,t,r){return Yl(this,void 0,void 0,(function*(){if(!e||!t||!r)throw new Zl("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const n=r.uploadSessionURL?r.uploadSessionURL:Su.constructCreateSessionUrl(r.fileName,r.path),o={fileName:r.fileName,fileDescription:r.fileDescription,conflictBehavior:r.conflictBehavior},i=yield Su.createUploadSession(e,n,o),a=((e=5242880)=>{const t=62914560;return e>t&&(e=t),(r=e)>327680&&(r=320*Math.floor(r/327680)*1024),r;var r})(r.rangeSize);return new Su(e,t,i,{rangeSize:a,uploadEventHandlers:r.uploadEventHandlers})}))}static createUploadSession(e,t,r){const n=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return Yl(this,void 0,void 0,(function*(){const o={item:{"@microsoft.graph.conflictBehavior":(null==r?void 0:r.conflictBehavior)||"rename",name:null==r?void 0:r.fileName,description:null==r?void 0:r.fileDescription}};return n.createUploadSession.call(this,e,t,o)}))}constructor(e,t,r,n){super(e,t,r,n)}commit(e,t="rename"){return Yl(this,void 0,void 0,(function*(){const r={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(r)}))}}Su.DEFAULT_UPLOAD_PATH="/";class Lu{constructor(e){this.provider=e}getAccessToken(){return Yl(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((r,n)=>Yl(this,void 0,void 0,(function*(){if(n)e(n);else{r||(r=new Zl("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md"));const e=yield Zl.setGraphClientError(r);t(e)}}))))}))}))}}class Nu extends Error{constructor(e=-1,t,r){super(t||r&&r.message),Object.setPrototypeOf(this,Nu.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class Pu{static constructError(e,t,r){const n=new Nu(t,"",e);return void 0!==e.name&&(n.code=e.name),n.body=e.toString(),n.date=new Date,n.headers=null==r?void 0:r.headers,n}static constructErrorFromResponse(e,t,r){const n=e.error,o=new Nu(t,n.message);return o.code=n.code,void 0!==n.innerError&&(o.requestId=n.innerError["request-id"],o.date=new Date(n.innerError.date)),o.body=JSON.stringify(n),o.headers=null==r?void 0:r.headers,o}static getError(e=null,t=-1,r,n){return Yl(this,void 0,void 0,(function*(){let o;if(e&&e.error?o=Pu.constructErrorFromResponse(e,t,n):e instanceof Error?o=Pu.constructError(e,t,n):(o=new Nu(t),o.body=e),"function"!=typeof r)return o;r(o,null)}))}}class Ou{constructor(e,t,r){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const r=e.indexOf("/");-1!==r&&(this.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const r=e.substring(t+1,e.length).split("&");for(const e of r)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let n=[];r.length>1&&"string"==typeof t?n=Array.prototype.slice.call(r):"string"==typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,r)=>{return[(n=e,n.replace(/\/+$/,"")),t(r)].join("/");var n}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const r in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const r in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,r)&&t.push(r+"="+e.otherURLQueryParams[r]);if(0!==e.otherURLQueryOptions.length)for(const r of e.otherURLQueryOptions)t.push(r);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),r=e.substring(0,t),n=e.substring(t+1);this.setURLComponentsQueryParamater(r,n)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==Jl.indexOf(e)){const r=this.urlComponents.oDataQueryParams[e],n=r&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=n?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,r){var n;return Yl(this,void 0,void 0,(function*(){let o;const i=new iu(this._middlewareOptions);this.updateRequestOptions(t);const a=null===(n=this.config)||void 0===n?void 0:n.customHosts;try{return o=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:i,customHosts:a})).response,yield Tu.getResponse(o,this._responseType,r)}catch(e){if(e instanceof Zl)throw e;let t;throw o&&(t=o.status),yield Pu.getError(e,t,r,o)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return Yl(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),r={method:Il.GET};return yield this.send(t,r,e)}))}post(e,t){return Yl(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),n={method:Il.POST,body:eu(e)};return"FormData"===(e&&e.constructor&&e.constructor.name)?n.headers={}:(this.setHeaderContentType(),n.headers=this._headers),yield this.send(r,n,t)}))}create(e,t){return Yl(this,void 0,void 0,(function*(){return yield this.post(e,t)}))}put(e,t){return Yl(this,void 0,void 0,(function*(){const r=this.buildFullUrl();this.setHeaderContentType();const n={method:Il.PUT,body:eu(e)};return yield this.send(r,n,t)}))}patch(e,t){return Yl(this,void 0,void 0,(function*(){const r=this.buildFullUrl();this.setHeaderContentType();const n={method:Il.PATCH,body:eu(e)};return yield this.send(r,n,t)}))}update(e,t){return Yl(this,void 0,void 0,(function*(){return yield this.patch(e,t)}))}delete(e){return Yl(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),r={method:Il.DELETE};return yield this.send(t,r,e)}))}del(e){return Yl(this,void 0,void 0,(function*(){return yield this.delete(e)}))}getStream(e){return Yl(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),r={method:Il.GET};return this.responseType(pu.STREAM),yield this.send(t,r,e)}))}putStream(e,t){return Yl(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),n={method:Il.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(r,n,t)}))}}class Ru{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,r)=>{r<e.length-1&&t.setNext(e[r+1])})),this.middleware=e[0]}sendRequest(e){return Yl(this,void 0,void 0,(function*(){if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}))}}class Mu{execute(e){return Yl(this,void 0,void 0,(function*(){e.response=yield fetch(e.request,e.options)}))}}var Du=r(65606);class Uu{static createWithAuthenticationProvider(e){const t=new vu(e),r=new bu(new wu),n=new Cu,o=new Mu;if(t.setNext(r),"object"==typeof Du){const e=new Eu(new Au);r.setNext(e),e.setNext(n)}else r.setNext(n);return n.setNext(o),Uu.createWithMiddleware(t)}static createWithMiddleware(...e){return new Ru(...e)}}class qu{static init(e){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]="authProvider"===r?new Lu(e[r]):e[r]);return qu.initWithMiddleware(t)}static initWithMiddleware(e){return new qu(e)}constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=Uu.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new Ru(...[].concat(e.middleware))}this.httpClient=t}api(e){return new Ou(this.httpClient,this.config,e)}}function Bu(e){return Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bu(e)}function Hu(){Hu=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:k(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function w(){}var b={};l(b,a,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(N([])));E&&E!==r&&n.call(E,a)&&(b=E);var C=w.prototype=y.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,i,a,s){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==Bu(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function k(t,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var l=d(t,r,n);if("normal"===l.type){if(o=n.done?m:p,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function I(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Bu(t)+" is not iterable")}return v.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:v,configurable:!0}),v.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},T(x.prototype),l(x.prototype,s,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new x(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(C),l(C,c,"Generator"),l(C,a,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Fu(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function zu(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Fu(i,n,o,a,s,"next",e)}function s(e){Fu(i,n,o,a,s,"throw",e)}a(void 0)}))}}var ju,Gu={getAccessToken:(ju=zu(Hu().mark((function e(){var t,r,n;return Hu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!((t=Sl.getAllAccounts()).length>0)){e.next=7;break}return e.next=5,Sl.acquireTokenSilent({scopes:["Calendars.ReadWrite"],account:t[0]});case 5:return r=e.sent,e.abrupt("return",r.accessToken);case 7:return e.next=9,Sl.loginPopup({scopes:["Calendars.ReadWrite"],prompt:"select_account"});case 9:return n=e.sent,e.abrupt("return",n.accessToken);case 13:throw e.prev=13,e.t0=e.catch(0),console.error("Token Debug:",{errorCode:e.t0.errorCode,message:e.t0.message,stack:e.t0.stack}),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,13]])}))),function(){return ju.apply(this,arguments)})},Wu=qu.initWithMiddleware({authProvider:Gu});function Ku(){return $u.apply(this,arguments)}function $u(){return($u=zu(Hu().mark((function e(){var t,r,n;return Hu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=3;break;case 3:return e.prev=3,t=new Date,r={start:new Date(t),end:new Date(t.setDate(t.getDate()+14))},e.next=8,Wu.api("/me/calendarView").header("Prefer",'outlook.timezone="'.concat("America/Toronto",'"')).query({startDateTime:r.start.toISOString(),endDateTime:r.end.toISOString(),$select:"subject,start,end,location,attendees,categories",$expand:"instances",$orderby:"start/dateTime",$top:99}).get();case 8:return n=e.sent,console.log("Fetched events:",n.value.map((function(e){return{subject:e.subject,start:e.start.dateTime,end:e.end.dateTime,location:e.location.displayName,attendees:e.attendees.map((function(e){return{name:e.emailAddress.name}})),categories:e.categories}}))),e.abrupt("return",n.value);case 13:throw e.prev=13,e.t0=e.catch(3),console.error("Graph API Error:",{error:e.t0,range:range}),e.t0;case 17:case"end":return e.stop()}}),e,null,[[3,13]])})))).apply(this,arguments)}var Vu=JSON.parse('{"w":[{"id":"MM","name":"Marie Madelin","email":"marie.madelin@amlex.ca","workingHours":{"start":"9:00","end":"17:00"},"breakMinutes":0,"maxDailyAppointments":5,"specialties":["estate","mandates","common"]},{"id":"DH","name":"Dorin Holban","email":"dorin.holban@amlex.ca","workingHours":{"start":"10:00","end":"17:00"},"breakMinutes":30,"maxDailyAppointments":5,"specialties":["divorce","employment","business","common"]},{"id":"TG","name":"Tim Gagin","email":"tim.gagin@amlex.ca","workingHours":{"start":"10:00","end":"17:00"},"breakMinutes":30,"maxDailyAppointments":5,"specialties":["estate","real_estate","defamations","contract","common"]},{"id":"YK","name":"Yasmine Kone","email":"yasmine.kone@amlex.ca","workingHours":{"start":"9:30","end":"17:00"},"breakMinutes":30,"maxDailyAppointments":5,"specialties":["adoptions","divorce","common"]},{"id":"LC","name":"Lauriane Carrier","email":"lauriane.carrier@amlex.ca","workingHours":{"start":"9:30","end":"17:00"},"breakMinutes":30,"maxDailyAppointments":5,"specialties":["name_change","estate","common"]},{"id":"AA","name":"Andrea Arruda","email":"andrea.arruda@amlex.ca","workingHours":{"start":"10:00","end":"17:00"},"breakMinutes":30,"maxDailyAppointments":3,"specialties":["assermentation","common"]},{"id":"AR","name":"Alexia Robert","email":"alexia.robert@amlex.ca","workingHours":{"start":"9:30","end":"17:00"},"breakMinutes":30,"maxDailyAppointments":3,"specialties":["assermentation","common"]},{"id":"MG","name":"Marine Garnier","email":"marine.garnier@umontreal.ca","workingHours":{"start":"10:00","end":"17:00"},"breakMinutes":60,"maxDailyAppointments":2,"specialties":["common"]}]}');function Yu(e){return Yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yu(e)}function Qu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zu(n.key),n)}}function Xu(e,t,r){return t&&Qu(e.prototype,t),r&&Qu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zu(e){var t=function(e){if("object"!=Yu(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Yu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Yu(t)?t:t+""}var Ju=Xu((function e(t,r,n,o,i,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.name=r,this.email=n,this.workingHours=o,this.breakMinutes=i,this.maxDailyAppointments=a,this.specialties=s})),ed=Vu.w.map((function(e){return new Ju(e.id,e.name,e.email,e.workingHours,e.breakMinutes,e.maxDailyAppointments,e.specialties)}));function td(){return ed}function rd(e){try{var t=ed.find((function(t){return t.id===e}));if(!t)throw new Error("Lawyer with ID ".concat(e," not found."));return t}catch(e){return console.warn(e.message),null}}function nd(e){return nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nd(e)}function od(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function id(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?od(Object(r),!0).forEach((function(t){ad(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):od(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ad(e,t,r){return(t=function(e){var t=function(e){if("object"!=nd(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=nd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==nd(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sd(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ld(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function cd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||ld(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ld(e,t){if(e){if("string"==typeof e)return ud(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ud(e,t):void 0}}function ud(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var dd=["office","phone","teams"],hd={DH:{office:["Monday"]},TG:{office:["Friday"]}};function pd(e,t,r){return{start:e,end:t,location:r}}function fd(e){var t;return{start:new Date(e.start.dateTime),end:new Date(e.end.dateTime),location:(null===(t=e.location)||void 0===t?void 0:t.displayName)||""}}function md(e){var t=e.getMinutes(),r=t<15?0:t<45?30:0;return 0===r&&t>=45&&e.setHours(e.getHours()+1),e.setMinutes(r,0,0),e}function gd(e){var t=e.location||"";if(!t)return console.error("Slot location is missing or invalid for virtual meeting check."),!1;var r=["phone","tel","telephone","téléphone","teams","ms teams","microsoft teams","microsoft teams meeting"].some((function(e){return t.includes(e)}));return console.log("Slot location: ".concat(t,", is virtual: ").concat(r)),r}function yd(e,t){return e.start<t.end&&t.start<e.end}function vd(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function wd(e,t,r){return console.log("Slot received for validation:",t),function(e,t){var r,n=t.start.toLocaleString("en-US",{weekday:"long"}),o=t.location,i=(null===(r=hd)||void 0===r?void 0:r[e])||{};return Object.entries(i).some((function(e){var t=cd(e,2),r=t[0],i=t[1];return r===o&&i.includes(n)}))}(e,t)?(console.warn("Slot rejected by availability rule",t),!1):function(e,t,r){var n=rd(e).maxDailyAppointments;return r.filter((function(e){return vd(new Date(e.start.dateTime),t)})).filter((function(t){return t.categories.includes(e)})).length>=n&&(console.warn("Daily limit reached for lawyer ".concat(e," on"),t),!0)}(e,t.start,r)?(console.warn("Slot rejected by daily limit",t),!1):function(e,t){try{if("office"!==e.location)return!1;var r,n=sd(t);try{for(n.s();!(r=n.n()).done;){var o,i=r.value,a=null===(o=i.location)||void 0===o||null===(o=o.displayName)||void 0===o?void 0:o.toLowerCase(),s=fd(i);if("office"===a&&yd(e,s))return console.warn("Office conflict detected:",e,i),!0}}catch(e){n.e(e)}finally{n.f()}return!1}catch(e){return console.error("Error checking for office location conflict:",e),!1}}(t,r)?(console.warn("Slot rejected by office conflict",t),!1):function(e,t,r){try{if(!["DH","TG"].includes(e))return!1;var n,o=rd("DH"===e?"TG":"DH"),i=gd(t),a=sd(r);try{for(a.s();!(n=a.n()).done;){var s,c=n.value,l=fd(c);if(null!==(s=c.categories)&&void 0!==s&&s.includes(o)&&gd(l)&&yd(t,l)&&i)return console.warn("Virtual conflict detected for ".concat(t," with ").concat(c.subject)),!0}}catch(e){a.e(e)}finally{a.f()}return!1}catch(e){return console.error("Error checking for DH_TG conflict:",e),!1}}(e,t,r)?(console.warn("Slot rejected by virtual conflict",t),!1):!function(e,t,r){var n,o=6e4*rd(e).breakMinutes,i=null,a=null,s=sd(r.filter((function(t){var r;return null===(r=t.categories)||void 0===r?void 0:r.includes(e)})).sort((function(e,t){return new Date(e.start.dateTime)-new Date(t.start.dateTime)})));try{for(s.s();!(n=s.n()).done;){var c=fd(n.value);if(c.end<=t.start)i=c;else if(c.start>=t.end){a=c;break}}}catch(e){s.e(e)}finally{s.f()}return i&&t.start.getTime()-i.end.getTime()<o?(console.warn("Break conflict detected with previous event:",t,i),!0):!!(a&&a.start.getTime()-t.end.getTime()<o)&&(console.warn("Break conflict detected with next event:",t,a),!0)}(e,t,r)||(console.warn("Slot rejected by break conflict",t),!1)}function bd(e,t,r){for(var n=function(e,t,r){var n,o=[],i=sd(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.recurrence)for(var s=new Date(a.start.dateTime);s<r;)s>=t&&o.push(id(id({},a),{},{start:{dateTime:s.toISOString()},end:{dateTime:new Date(s.getTime()+(new Date(a.end.dateTime)-new Date(a.start.dateTime))).toISOString()}})),s.setDate(s.getDate()+7);else o.push(a)}}catch(e){i.e(e)}finally{i.f()}return o}(r,new Date,new Date(Date.now()+12096e5)),o=n.filter((function(e){return!function(e){return e.isAllDay||e.start.dateTime===e.start.date&&e.end.dateTime===e.end.date}(e)})).filter((function(t){var r,n;return(null===(r=t.categories)||void 0===r?void 0:r.includes(e.id))||(null===(n=t.attendees)||void 0===n?void 0:n.some((function(t){return t.emailAddress.address===e.email})))})).map((function(e){return{start:new Date(e.start.dateTime),end:new Date(e.end.dateTime),raw:e}})).sort((function(e,t){return e.start-t.start})),i=[],a=new Date,s=36e5,c=6e4*e.breakMinutes,l=function(){var r=new Date(a);r.setDate(a.getDate()+u);var n=r.getDay();if(0===n||6===n)return 1;var l=cd(e.workingHours.start.split(":").map(Number),2),d=l[0],h=l[1],p=cd(e.workingHours.end.split(":").map(Number),2),f=p[0],m=p[1],g=new Date(r),y=new Date(r);g.setHours(d,h,0,0),y.setHours(f,m,0,0);var v,w=o.filter((function(e){return vd(e.start,r)&&e.end>g&&e.start<y})),b=md(new Date(g)),A=sd(w);try{var E=function(){var e=v.value;if(b.getTime()+s<=e.start.getTime())for(var n=new Date(b),o=function(){var e=new Date(n.getTime()+s);yd({start:n,end:e},I(r))||w.some((function(t){return yd({start:n,end:e},t)}))||i.push(pd(n,e,t)),n=md(n=new Date(e))};n.getTime()+s<=e.start.getTime();)o();b=md(b=new Date(e.end.getTime()+c))};for(A.s();!(v=A.n()).done;)E()}catch(e){A.e(e)}finally{A.f()}for(var C=function(){var e=new Date(b.getTime()+s);yd({start:b,end:e},I(r))||w.some((function(t){return yd({start:b,end:e},t)}))||i.push(pd(b,e,t)),b=md(b=new Date(e))};b.getTime()+s<=y.getTime();)C()},u=0;u<14;u++)l();return console.log("Generated slots:",i),i}function Ad(e){return Ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ad(e)}function Ed(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cd(n.key),n)}}function Cd(e){var t=function(e){if("object"!=Ad(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ad(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ad(t)?t:t+""}var Td=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()},(t=[{key:"reset",value:function(){this.lawyerId="",this.location="",this.clientName="",this.clientPhone="",this.clientEmail="",this.clientLanguage="",this.caseType="",this.appointmentDate=null,this.appointmentTime=null,this.isFirstConsultation=!1,this.isRefBarreau=!1,this.isPaymentMade=!1,this.paymentMethod="",this.depositAmount=0,this.contractTitle="",this.notes=""}},{key:"update",value:function(e,t){this[e]=t}}])&&Ed(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()),xd='<html xmlns="http://www.w3.org/TR/REC-html40" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word"> <head> <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/> <meta content="Word.Document" name="ProgId"/> <meta content="Microsoft Word 15" name="Generator"/> <meta content="Microsoft Word 15" name="Originator"/> <link href="Equipe%20Allen%20Madelin%20(admin@amlex.ca)_files/filelist.xml" rel="File-List"/> <link href="Equipe%20Allen%20Madelin%20(admin@amlex.ca)_files/editdata.mso" rel="Edit-Time-Data"/> \x3c!--[if !mso]>\r\n<style>\r\nv\\:* {behavior:url(#default#VML);}\r\no\\:* {behavior:url(#default#VML);}\r\nw\\:* {behavior:url(#default#VML);}\r\n.shape {behavior:url(#default#VML);}\r\n</style>\r\n<![endif]--\x3e\x3c!--[if gte mso 9]><xml>\r\n <o:OfficeDocumentSettings>\r\n  <o:AllowPNG/>\r\n </o:OfficeDocumentSettings>\r\n</xml><![endif]--\x3e <link href="Equipe%20Allen%20Madelin%20(admin@amlex.ca)_files/themedata.thmx" rel="themeData"/> <link href="Equipe%20Allen%20Madelin%20(admin@amlex.ca)_files/colorschememapping.xml" rel="colorSchemeMapping"/> \x3c!--[if gte mso 9]><xml>\r\n <w:WordDocument>\r\n  <w:View>Normal</w:View>\r\n  <w:Zoom>0</w:Zoom>\r\n  <w:TrackMoves/>\r\n  <w:TrackFormatting/>\r\n  <w:HyphenationZone>21</w:HyphenationZone>\r\n  <w:PunctuationKerning/>\r\n  <w:ValidateAgainstSchemas/>\r\n  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>\r\n  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>\r\n  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>\r\n  <w:DoNotPromoteQF/>\r\n  <w:LidThemeOther>FR-CA</w:LidThemeOther>\r\n  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>\r\n  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>\r\n  <w:DoNotShadeFormData/>\r\n  <w:Compatibility>\r\n   <w:BreakWrappedTables/>\r\n   <w:SnapToGridInCell/>\r\n   <w:WrapTextWithPunct/>\r\n   <w:UseAsianBreakRules/>\r\n   <w:DontGrowAutofit/>\r\n   <w:SplitPgBreakAndParaMark/>\r\n   <w:EnableOpenTypeKerning/>\r\n   <w:DontFlipMirrorIndents/>\r\n   <w:OverrideTableStyleHps/>\r\n   <w:UseFELayout/>\r\n  </w:Compatibility>\r\n  <m:mathPr>\r\n   <m:mathFont m:val="Cambria Math"/>\r\n   <m:brkBin m:val="before"/>\r\n   <m:brkBinSub m:val="&#45;-"/>\r\n   <m:smallFrac m:val="off"/>\r\n   <m:dispDef/>\r\n   <m:lMargin m:val="0"/>\r\n   <m:rMargin m:val="0"/>\r\n   <m:defJc m:val="centerGroup"/>\r\n   <m:wrapIndent m:val="1440"/>\r\n   <m:intLim m:val="subSup"/>\r\n   <m:naryLim m:val="undOvr"/>\r\n  </m:mathPr></w:WordDocument>\r\n</xml><![endif]--\x3e\x3c!--[if gte mso 9]><xml>\r\n <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"\r\n  DefSemiHidden="false" DefQFormat="false" DefPriority="99"\r\n  LatentStyleCount="376">\r\n  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>\r\n  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>\r\n  <w:LsdException Locked="false" Priority="9" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>\r\n  <w:LsdException Locked="false" Priority="9" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>\r\n  <w:LsdException Locked="false" Priority="9" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>\r\n  <w:LsdException Locked="false" Priority="9" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>\r\n  <w:LsdException Locked="false" Priority="9" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>\r\n  <w:LsdException Locked="false" Priority="9" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>\r\n  <w:LsdException Locked="false" Priority="9" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>\r\n  <w:LsdException Locked="false" Priority="9" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 5"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 6"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 7"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 8"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index 9"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 1"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 2"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 3"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 4"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 5"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 6"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 7"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 8"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="toc 9"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Normal Indent"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="footnote text"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="annotation text"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="header"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="footer"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="index heading"/>\r\n  <w:LsdException Locked="false" Priority="35" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="caption"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="table of figures"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="envelope address"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="envelope return"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="footnote reference"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="annotation reference"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="line number"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="page number"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="endnote reference"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="endnote text"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="table of authorities"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="macro"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="toa heading"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Bullet"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Number"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List 5"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Bullet 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Bullet 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Bullet 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Bullet 5"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Number 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Number 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Number 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Number 5"/>\r\n  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Closing"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Signature"/>\r\n  <w:LsdException Locked="false" Priority="1" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="Default Paragraph Font"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Body Text"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Body Text Indent"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Continue"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Continue 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Continue 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Continue 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="List Continue 5"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Message Header"/>\r\n  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Salutation"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Date"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Body Text First Indent"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Body Text First Indent 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Note Heading"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Body Text 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Body Text 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Body Text Indent 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Body Text Indent 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Block Text"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Hyperlink"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="FollowedHyperlink"/>\r\n  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>\r\n  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Document Map"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Plain Text"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="E-mail Signature"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Top of Form"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Bottom of Form"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Normal (Web)"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Acronym"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Address"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Cite"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Code"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Definition"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Keyboard"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Preformatted"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Sample"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Typewriter"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="HTML Variable"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Normal Table"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="annotation subject"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="No List"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Outline List 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Outline List 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Outline List 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Simple 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Simple 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Simple 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Classic 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Classic 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Classic 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Classic 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Colorful 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Colorful 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Colorful 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Columns 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Columns 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Columns 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Columns 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Columns 5"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Grid 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Grid 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Grid 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Grid 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Grid 5"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Grid 6"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Grid 7"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Grid 8"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table List 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table List 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table List 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table List 4"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table List 5"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table List 6"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table List 7"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table List 8"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table 3D effects 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table 3D effects 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table 3D effects 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Contemporary"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Elegant"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Professional"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Subtle 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Subtle 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Web 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Web 2"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Web 3"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Balloon Text"/>\r\n  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Table Theme"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>\r\n  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>\r\n  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>\r\n  <w:LsdException Locked="false" Priority="61" Name="Light List"/>\r\n  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>\r\n  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>\r\n  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>\r\n  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>\r\n  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>\r\n  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>\r\n  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>\r\n  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>\r\n  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>\r\n  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>\r\n  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>\r\n  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>\r\n  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>\r\n  <w:LsdException Locked="false" Priority="34" QFormat="true"\r\n   Name="List Paragraph"/>\r\n  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>\r\n  <w:LsdException Locked="false" Priority="30" QFormat="true"\r\n   Name="Intense Quote"/>\r\n  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="19" QFormat="true"\r\n   Name="Subtle Emphasis"/>\r\n  <w:LsdException Locked="false" Priority="21" QFormat="true"\r\n   Name="Intense Emphasis"/>\r\n  <w:LsdException Locked="false" Priority="31" QFormat="true"\r\n   Name="Subtle Reference"/>\r\n  <w:LsdException Locked="false" Priority="32" QFormat="true"\r\n   Name="Intense Reference"/>\r\n  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>\r\n  <w:LsdException Locked="false" Priority="37" SemiHidden="true"\r\n   UnhideWhenUsed="true" Name="Bibliography"/>\r\n  <w:LsdException Locked="false" Priority="39" SemiHidden="true"\r\n   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>\r\n  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>\r\n  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>\r\n  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>\r\n  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>\r\n  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>\r\n  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>\r\n  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>\r\n  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>\r\n  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="Grid Table 1 Light Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="Grid Table 6 Colorful Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="Grid Table 7 Colorful Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="Grid Table 1 Light Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="Grid Table 6 Colorful Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="Grid Table 7 Colorful Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="Grid Table 1 Light Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="Grid Table 6 Colorful Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="Grid Table 7 Colorful Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="Grid Table 1 Light Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="Grid Table 6 Colorful Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="Grid Table 7 Colorful Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="Grid Table 1 Light Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="Grid Table 6 Colorful Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="Grid Table 7 Colorful Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="Grid Table 1 Light Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="Grid Table 6 Colorful Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="Grid Table 7 Colorful Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>\r\n  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>\r\n  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="List Table 1 Light Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="List Table 6 Colorful Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="List Table 7 Colorful Accent 1"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="List Table 1 Light Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="List Table 6 Colorful Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="List Table 7 Colorful Accent 2"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="List Table 1 Light Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="List Table 6 Colorful Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="List Table 7 Colorful Accent 3"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="List Table 1 Light Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="List Table 6 Colorful Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="List Table 7 Colorful Accent 4"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="List Table 1 Light Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="List Table 6 Colorful Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="List Table 7 Colorful Accent 5"/>\r\n  <w:LsdException Locked="false" Priority="46"\r\n   Name="List Table 1 Light Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="51"\r\n   Name="List Table 6 Colorful Accent 6"/>\r\n  <w:LsdException Locked="false" Priority="52"\r\n   Name="List Table 7 Colorful Accent 6"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Mention"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Smart Hyperlink"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Hashtag"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Unresolved Mention"/>\r\n  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"\r\n   Name="Smart Link"/>\r\n </w:LatentStyles>\r\n</xml><![endif]--\x3e <style>@font-face{font-family:"Cambria Math";panose-1:2 4 5 3 5 4 6 3 2 4;mso-font-charset:0;mso-generic-font-family:roman;mso-font-pitch:variable;mso-font-signature:-536869121 1107305727 33554432 0 415 0}@font-face{font-family:Calibri;panose-1:2 15 5 2 2 2 4 3 2 4;mso-font-charset:0;mso-generic-font-family:swiss;mso-font-pitch:variable;mso-font-signature:-469750017 -1073732485 9 0 511 0}@font-face{font-family:Aptos;mso-font-charset:0;mso-generic-font-family:swiss;mso-font-pitch:variable;mso-font-signature:536871559 3 0 0 415 0}@font-face{font-family:"Arial Narrow";panose-1:2 11 6 6 2 2 2 3 2 4;mso-font-charset:0;mso-generic-font-family:swiss;mso-font-pitch:variable;mso-font-signature:647 2048 0 0 159 0}div.MsoNormal,li.MsoNormal,p.MsoNormal{mso-style-unhide:no;mso-style-qformat:yes;mso-style-parent:"";margin:0;mso-pagination:widow-orphan;font-size:12pt;font-family:Aptos,sans-serif;mso-ascii-font-family:Aptos;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Aptos;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-font-kerning:1.0pt;mso-ligatures:standardcontextual}div.MsoAutoSig,li.MsoAutoSig,p.MsoAutoSig{mso-style-priority:99;mso-style-link:"E-mail Signature Char";margin:0;mso-pagination:widow-orphan;font-size:12pt;font-family:Aptos,sans-serif;mso-ascii-font-family:Aptos;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Aptos;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-font-kerning:1.0pt;mso-ligatures:standardcontextual}span.E-mailSignatureChar{mso-style-name:"E-mail Signature Char";mso-style-priority:99;mso-style-unhide:no;mso-style-locked:yes;mso-style-link:"E-mail Signature"}.MsoChpDefault{mso-style-type:export-only;mso-default-props:yes;font-size:12pt;mso-ansi-font-size:12.0pt;mso-bidi-font-size:12.0pt;mso-ascii-font-family:Aptos;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Aptos;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;mso-font-kerning:1.0pt;mso-ligatures:standardcontextual}@page WordSection1{size:612.0pt 792.0pt;margin:72pt 90pt 72pt 90pt;mso-header-margin:36.0pt;mso-footer-margin:36.0pt;mso-paper-source:0}div.WordSection1{page:WordSection1}</style> \x3c!--[if gte mso 10]>\r\n<style>\r\n /* Style Definitions */\r\n table.MsoNormalTable\r\n\t{mso-style-name:"Table Normal";\r\n\tmso-tstyle-rowband-size:0;\r\n\tmso-tstyle-colband-size:0;\r\n\tmso-style-noshow:yes;\r\n\tmso-style-priority:99;\r\n\tmso-style-parent:"";\r\n\tmso-padding-alt:0cm 5.4pt 0cm 5.4pt;\r\n\tmso-para-margin:0cm;\r\n\tmso-pagination:widow-orphan;\r\n\tfont-size:12.0pt;\r\n\tfont-family:"Aptos",sans-serif;\r\n\tmso-ascii-font-family:Aptos;\r\n\tmso-ascii-theme-font:minor-latin;\r\n\tmso-hansi-font-family:Aptos;\r\n\tmso-hansi-theme-font:minor-latin;\r\n\tmso-font-kerning:1.0pt;\r\n\tmso-ligatures:standardcontextual;}\r\ntable.TableauNormal\r\n\t{mso-style-name:"Tableau Normal";\r\n\tmso-tstyle-rowband-size:0;\r\n\tmso-tstyle-colband-size:0;\r\n\tmso-style-noshow:yes;\r\n\tmso-style-priority:99;\r\n\tmso-style-unhide:no;\r\n\tmso-style-parent:"";\r\n\tmso-padding-alt:0cm 5.4pt 0cm 5.4pt;\r\n\tmso-para-margin:0cm;\r\n\tmso-pagination:widow-orphan;\r\n\tfont-size:12.0pt;\r\n\tfont-family:"Aptos",sans-serif;\r\n\tmso-ascii-font-family:Aptos;\r\n\tmso-ascii-theme-font:minor-latin;\r\n\tmso-hansi-font-family:Aptos;\r\n\tmso-hansi-theme-font:minor-latin;\r\n\tmso-font-kerning:1.0pt;\r\n\tmso-ligatures:standardcontextual;}\r\n</style>\r\n<![endif]--\x3e </head> <body lang="FR-CA" style="tab-interval:35.4pt;word-wrap:break-word"> <div class="WordSection1"> <p class="MsoNormal"><o:p> </o:p></p> <table align="left" border="0" cellpadding="0" cellspacing="0" class="MsoNormalTable" style="width:326.3pt;border-collapse:collapse;mso-yfti-tbllook:1184;mso-table-lspace:9.05pt;margin-left:6.8pt;mso-table-rspace:9.05pt;margin-right:6.8pt;mso-table-anchor-vertical:paragraph;mso-table-anchor-horizontal:column;mso-table-left:left;mso-padding-alt:0cm 0cm 0cm 0cm" width="435"> <tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:40.85pt"> <td style="width:64.05pt;border:solid #fff 1pt;padding:0;height:40.85pt" width="85"> <p class="MsoNormal" style="mso-element:frame;mso-element-frame-hspace:9.05pt;mso-element-wrap:around;mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:column;mso-height-rule:exactly"><span style="font-size:10pt;font-family:Arial,sans-serif;color:#222;mso-no-proof:yes">\x3c!--[if gte vml 1]><v:shapetype\r\n   id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"\r\n   path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">\r\n   <v:stroke joinstyle="miter"/>\r\n   <v:formulas>\r\n    <v:f eqn="if lineDrawn pixelLineWidth 0"/>\r\n    <v:f eqn="sum @0 1 0"/>\r\n    <v:f eqn="sum 0 0 @1"/>\r\n    <v:f eqn="prod @2 1 2"/>\r\n    <v:f eqn="prod @3 21600 pixelWidth"/>\r\n    <v:f eqn="prod @3 21600 pixelHeight"/>\r\n    <v:f eqn="sum @0 0 1"/>\r\n    <v:f eqn="prod @6 1 2"/>\r\n    <v:f eqn="prod @7 21600 pixelWidth"/>\r\n    <v:f eqn="sum @8 21600 0"/>\r\n    <v:f eqn="prod @7 21600 pixelHeight"/>\r\n    <v:f eqn="sum @10 21600 0"/>\r\n   </v:formulas>\r\n   <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>\r\n   <o:lock v:ext="edit" aspectratio="t"/>\r\n  </v:shapetype><v:shape id="Picture_x0020_1" o:spid="_x0000_i1037" type="#_x0000_t75"\r\n   style=\'width:57pt;height:34pt;visibility:visible;mso-wrap-style:square\'>\r\n   <v:imagedata src="Equipe%20Allen%20Madelin%20(admin@amlex.ca)_files/image001.gif"\r\n    o:title=""/>\r\n  </v:shape><![endif]--\x3e<?if !vml?><img height="45" src="'+new URL(r(9236),r.b)+'" v:shapes="Picture_x0020_1" width="76"/><?endif?></span><span style="font-size:10pt;font-family:Arial,sans-serif;color:#222;mso-ligatures:none;mso-fareast-language:EN-CA"><o:p></o:p></span></p> </td> <td style="width:262.25pt;border:solid #fff 1pt;border-left:none;padding:0;height:40.85pt" width="350"> <p class="MsoNormal" style="background:#fff;mso-element:frame;mso-element-frame-hspace:9.05pt;mso-element-wrap:around;mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:column;mso-height-rule:exactly"><b><span lang="EN-US" style="font-size:10pt;font-family:Arial,sans-serif;color:#222;mso-ligatures:none;mso-ansi-language:EN-US;mso-fareast-language:EN-CA">ÉQUIPE ALLEN MADELIN TEAM</span></b></p> <p class="MsoNormal" style="background:#fff;mso-element:frame;mso-element-frame-hspace:9.05pt;mso-element-wrap:around;mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:column;mso-height-rule:exactly"><span lang="EN-US" style=\'font-size:10pt;font-family:"Arial Narrow",sans-serif;color:#222;mso-ligatures:none;mso-ansi-language:EN-US;mso-fareast-language:EN-CA\'>ALLEN MADELIN INC., AVOCATS - LAWYERS</span><span lang="EN-US" style="font-size:10pt;font-family:Arial,sans-serif;color:#222;mso-ligatures:none;mso-ansi-language:EN-US;mso-fareast-language:EN-CA"><o:p></o:p></span></p> </td> </tr> <tr style="mso-yfti-irow:1;mso-yfti-lastrow:yes;height:40.85pt"> <td colspan="2" style="width:326.3pt;border:solid #fff 1pt;border-top:none;padding:0;height:40.85pt" width="435"> <p class="MsoNormal" style="mso-element:frame;mso-element-frame-hspace:9.05pt;mso-element-wrap:around;mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:column;mso-height-rule:exactly"><span lang="FR" style=\'font-size:10pt;font-family:"Arial Narrow",sans-serif;mso-ligatures:none;mso-ansi-language:FR;mso-fareast-language:EN-CA\'>4621 BOUL. SAINT-LAURENT, MONTRÉAL (QUÉBEC) H2T 1R2</span><span lang="FR" style=\'font-size:10pt;font-family:"Arial Narrow",sans-serif;mso-bidi-font-family:Calibri;mso-ligatures:none;mso-ansi-language:FR;mso-fareast-language:EN-CA\'><o:p></o:p></span></p> <p class="MsoNormal" style="text-align:justify;text-justify:inter-ideograph;background:#fff;mso-element:frame;mso-element-frame-hspace:9.05pt;mso-element-wrap:around;mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:column;mso-height-rule:exactly"><span lang="FR" style=\'font-size:10pt;font-family:"Arial Narrow",sans-serif;color:#222;mso-ligatures:none;mso-ansi-language:FR;mso-fareast-language:EN-CA\'>T : 514 904 4017, F : 514 904 4018 <o:p></o:p></span></p> <p class="MsoNormal" style="text-align:justify;text-justify:inter-ideograph;background:#fff;mso-element:frame;mso-element-frame-hspace:9.05pt;mso-element-wrap:around;mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:column;mso-height-rule:exactly"><span lang="FR" style=\'font-size:8pt;font-family:"Arial Narrow",sans-serif;color:#000;mso-ligatures:none;mso-ansi-language:FR;mso-fareast-language:EN-CA\'><o:p> </o:p></span></p> <p class="MsoNormal" style="text-align:justify;text-justify:inter-ideograph;background:#fff;mso-element:frame;mso-element-frame-hspace:9.05pt;mso-element-wrap:around;mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:column;mso-height-rule:exactly"><span lang="FR" style=\'font-size:7pt;font-family:"Arial Narrow",sans-serif;color:#000;mso-ligatures:none;mso-ansi-language:FR;mso-fareast-language:EN-CA\'>Ce courriel pourrait contenir des renseignements confidentiels ou privilégiés. Si vous n\'êtes pas le véritable destinataire, veuillez-nous en aviser immédiatement. </span><span lang="EN-US" style=\'font-size:7pt;font-family:"Arial Narrow",sans-serif;color:#000;mso-ligatures:none;mso-ansi-language:EN-US;mso-fareast-language:EN-CA\'>Merci.<o:p></o:p></span></p> <p class="MsoNormal" style="text-align:justify;text-justify:inter-ideograph;background:#fff;mso-element:frame;mso-element-frame-hspace:9.05pt;mso-element-wrap:around;mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:column;mso-height-rule:exactly"><span lang="EN-US" style=\'font-size:7pt;font-family:"Arial Narrow",sans-serif;color:#000;mso-ligatures:none;mso-ansi-language:EN-US;mso-fareast-language:EN-CA\'>This e-mail may contain confidential or privileged information. If you are not the intended recipient, please notify us immediately. </span><span style=\'font-size:7pt;font-family:"Arial Narrow",sans-serif;color:#000;mso-ligatures:none;mso-fareast-language:EN-CA\'>Thank you.</span><span style="font-size:5pt;font-family:Arial,sans-serif;color:#222;mso-ligatures:none;mso-fareast-language:EN-CA"><o:p></o:p></span></p> </td> </tr> </table> <p class="MsoNormal"><span lang="EN-CA" style="font-family:Calibri,sans-serif;mso-font-kerning:0pt;mso-ansi-language:EN-CA;mso-fareast-language:EN-CA"><o:p> </o:p></span></p> <p class="MsoNormal"><span lang="EN-CA" style="font-size:11pt;mso-ansi-language:EN-CA;mso-fareast-language:EN-US"><o:p> </o:p></span></p> <p class="MsoNormal"><span lang="EN-CA" style="mso-ansi-language:EN-CA"><o:p> </o:p></span></p> <p class="MsoNormal"><o:p> </o:p></p> <p class="MsoAutoSig"><o:p> </o:p></p> </div> </body> </html> ',kd=r(65606);function Id(e){return Id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Id(e)}function _d(){_d=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:k(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function w(){}var b={};l(b,a,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(N([])));E&&E!==r&&n.call(E,a)&&(b=E);var C=w.prototype=y.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,i,a,s){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==Id(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function k(t,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var l=d(t,r,n);if("normal"===l.type){if(o=n.done?m:p,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function I(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Id(t)+" is not iterable")}return v.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:v,configurable:!0}),v.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},T(x.prototype),l(x.prototype,s,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new x(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(C),l(C,c,"Generator"),l(C,a,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Sd(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}var Ld={en:{teams:'<p>Hello,</p> <p> I confirm your appointment for a consultation with <strong>Me {{lawyerName}}</strong> on <strong>{{date}}</strong> at <strong>{{time}}</strong> (Montreal Time). Please find the Teams link below: </p> <br> <br> <br> <p> The consultation fee is $<strong>{{rates}}</strong> + taxes ($<strong>{{totalRates}}</strong>). Payment is required at least 1 hour before the consultation; otherwise, it will be canceled. You can pay via Interac e-transfer using the email address <a href="mailto:general@amlex.ca">general@amlex.ca</a> (no password required) or by credit card. </p> <p> If you have relevant documents that could help the lawyer better understand your situation, please feel free to send them to the email address <a href="mailto:admin@amlex.ca">admin@amlex.ca</a>. Please note that we reserve the right to charge additional fees for reviewing documents if they are too voluminous. Therefore, please limit yourself to the necessary documents. </p> <p> We remind you that Allen Madelin also offers services in employment law, estate law, protection regimes, defamation, real estate, family law, and divorce. </p> <p>Feel free to contact us for any other questions.</p> <p>Thank you and have a great day!</p>',office:'<p>Hello,</p> <p> I confirm your appointment for a consultation with <strong>Me {{lawyerName}}</strong> on <strong>{{date}}</strong> at <strong>{{time}}</strong> (Montreal time). Our office is located at <strong>4621, Boul. St-Laurent, Montreal, QC H2T 1R2</strong>. </p> <p> The consultation fee is $<strong>{{rates}}</strong> + taxes ($<strong>{{totalRates}}</strong>). You can pay by Interac transfer using the email address <a href="mailto:general@amlex.ca">general@amlex.ca</a> (no password required), by credit card, or in cash. </p> <p> If you have any relevant documents that could help the lawyer better understand your situation, please send them to us at the email address <a href="mailto:admin@amlex.ca">admin@amlex.ca</a>. Please note that we reserve the right to charge for the time the lawyer spends reviewing your documents if a significant amount of time is necessary. Therefore, it is in your best interests to only send documents that are the most important in helping the lawyer to understand your case. </p> <p> Just a reminder that Allen Madelin also offers services in Employment Law, Estate Law and Succession, Protection Regimes, Defamation, Real Estate, and Family Law, including Divorce. </p> <p>Please do not hesitate to contact us if you have any other questions.</p> <p>Have a nice day!</p>',phone:'<p>Hello,</p> <p> I confirm your appointment for a consultation with <strong>Me {{lawyerName}}</strong> on <strong>{{date}}</strong> at <strong>{{time}}</strong> (Montreal time). Please call us at <a href="tel:5149044017">514 904 4017</a> and we will transfer your call to the lawyer. </p> <p> The consultation fee is $<strong>{{rates}}</strong> + taxes ($<strong>{{totalRates}}</strong>). Payment is required at least 1 hour before the consultation, otherwise it will be canceled. You can pay by Interac transfer using the email address <a href="mailto:general@amlex.ca">general@amlex.ca</a> (no password required) or by credit card. </p> <p> If you have any relevant documents that could help the lawyer better understand your situation, please send them to us at the email address <a href="mailto:admin@amlex.ca">admin@amlex.ca</a>. Please note that we reserve the right to charge for the time the lawyer spends reviewing your documents if a significant amount of time is necessary. Therefore, it is in your best interests to only send documents that are the most important in helping the lawyer to understand your case. </p> <p> Just a reminder that Allen Madelin also offers services in Employment Law, Estate Law and Succession, Protection Regimes, Defamation, Real Estate, and Family Law, including Divorce. </p> <p>Please do not hesitate to contact us if you have any other questions.</p> <p>Have a nice day!</p>',contract:'<p>Hello,</p> <p> Please find attached the contract for the services of <strong>Me {{lawyerName}}</strong>. </p> <p> Please return the contract signed on the 3rd page and initialed at the bottom of each page. Complete the client form with your information and the opposing party\'s form, if applicable. We will also need a copy of your ID. </p> <p> An initial deposit of $<strong>{{depositAmount}}</strong> + taxes ($<strong>{{totalAmount}}</strong>) is required to open the file. This amount will be placed in a trust account and will be used for judicial and extra-judicial disbursements. You can pay by Interac transfer to <a href="mailto:trust@amlex.ca">trust@amlex.ca</a>. Alternatively, you can pay by credit card (note that credit card payments are subject to an additional fee of 4%), cash, or cheque to Allen Madelin Inc. </p> <p>Best Regards,</p>',reply:'<p>Good morning,</p> <p> Thank you for contacting us. I read your situation, and I understand that you need legal help. <strong>Me {{lawyerName}}</strong> can advise you. I suggest making an appointment for a first consultation. </p> <p> It is charged $125 + taxes, and the first consultation usually lasts between 30 minutes to 1 hour. A first consultation is an opportunity for you to legally understand your situation and to obtain legal advice as well as their approximate costs. </p> <p> Please contact me at <a href="tel:5149044017">514-904-4017</a> to know his next availabilities. </p> <p>Best regards,</p>',feedback:'<p>Hello,</p> <p> We hope you have been satisfied with the services you have received from our firm. We are committed to providing quality legal service and to continually improving our expertise to better meet our customers\' needs. </p> <p> With this in mind, we would be very grateful if you could take a few minutes to share your experience with us. </p> <p> If you are willing to leave a comment, we invite you to do so via the following link: <a href="https://g.page/r/CXx1fndizC6lEBM/review" target="_blank" rel="noopener">https://g.page/r/CXx1fndizC6lEBM/review</a> </p> <p> Thank you in advance for your time and valuable input. </p> <p>Allen Madelin</p>',suivi:"<p>Dear Mr. X,</p> <p> I hope this message finds you well. I am following up with you regarding the service contract. Would you still like to retain our services, even if not at this time? In that case, we will securely keep your original documents. </p> <p> Otherwise, please let us know the date on which you would like to retrieve your original documents. Please note that we cannot be held responsible for them if you decide not to proceed with our services. </p> <p>Looking forward to your response,</p> <p>Best regards,</p>",signature:xd},fr:{teams:'<p>Bonjour,</p> <p> Je confirme votre rendez-vous pour une consultation avec <strong>Me {{lawyerName}}</strong> le <strong>{{date}}</strong> à <strong>{{time}}</strong> (Heure de Montréal). Veuillez trouver ci-dessous le lien Teams : </p> <br> <br> <br> <p> La consultation est facturée <strong>{{rates}}</strong>$ + taxes (<strong>{{totalRates}}</strong>$). Le paiement est requis au moins 1h avant la consultation, sinon celle-ci sera annulée. Vous pouvez payer par virement Interac en utilisant l’adresse courriel <a href="mailto:general@amlex.ca">general@amlex.ca</a> (aucun mot de passe requis) ou par carte de crédit. </p> <p> Si vous avez des documents pertinents pouvant aider l’avocat à mieux comprendre votre situation, n’hésitez pas à nous les transmettre à l’adresse courriel <a href="mailto:admin@amlex.ca">admin@amlex.ca</a>. Notez que nous nous réservons le droit de vous charger des frais supplémentaires pour la lecture des documents si ceux-ci sont trop volumineux. Veuillez donc vous limiter au nécessaire. </p> <p> Nous vous rappelons qu’Allen Madelin offre également des services en droit de l’emploi, droit des successions, régimes de protection, diffamation, immobilier, droit de la famille ainsi que divorce. </p> <p>N’hésitez pas à nous contacter pour toutes autres questions.</p> <p>Merci et bonne journée !</p>',office:'<p>Bonjour,</p> <p> Je confirme votre rendez-vous pour une consultation avec <strong>Me {{lawyerName}}</strong> le <strong>{{date}}</strong> à <strong>{{time}}</strong> (Heure de Montréal). Notre cabinet est situé au <strong>4621, Boul. St-Laurent, Montréal (QC) H2T 1R2</strong>. </p> <p> La consultation est facturée <strong>{{rates}}</strong>$ + taxes (<strong>{{totalRates}}</strong>$). Vous pouvez payer par virement Interac en utilisant l’adresse courriel <a href="mailto:general@amlex.ca">general@amlex.ca</a> (aucun mot de passe requis), par carte de crédit ou par argent comptant. </p> <p> Si vous avez des documents pertinents pouvant aider l’avocat à mieux comprendre votre situation, n’hésitez pas à les apporter lors de votre rendez-vous ou à nous les transmettre à l’adresse courriel <a href="mailto:admin@amlex.ca">admin@amlex.ca</a>. Notez que nous nous réservons le droit de vous charger des frais supplémentaires pour la lecture des documents si ceux-ci sont trop volumineux. Veuillez donc vous limiter au nécessaire. </p> <p> Nous vous rappelons qu’Allen Madelin offre également des services en droit de l’emploi, droit des successions, régimes de protection, diffamation, immobilier, droit de la famille ainsi que divorce. </p> <p>N’hésitez pas à nous contacter pour toutes autres questions.</p> <p>Merci et bonne journée !</p>',phone:'<p>Bonjour,</p> <p> Je confirme votre rendez-vous pour une consultation avec <strong>Me {{lawyerName}}</strong> le <strong>{{date}}</strong> à <strong>{{time}}</strong> (Heure de Montréal). Veuillez appeler le <a href="tel:514-904-4017">514-904-4017</a> et nous transfèrerons votre appel à l’avocat. </p> <p> La consultation est facturée <strong>{{rates}}</strong>$ + taxes (<strong>{{totalRates}}</strong>$). Le paiement est requis au moins 1h avant la consultation, sinon celle-ci sera annulée. Vous pouvez payer par virement Interac en utilisant l’adresse courriel <a href="mailto:general@amlex.ca">general@amlex.ca</a> (aucun mot de passe requis) ou par carte de crédit. </p> <p> Si vous avez des documents pertinents pouvant aider l’avocat à mieux comprendre votre situation, n’hésitez pas à nous les transmettre à l’adresse courriel <a href="mailto:admin@amlex.ca">admin@amlex.ca</a>. Notez que nous nous réservons le droit de vous charger des frais supplémentaires pour la lecture des documents si ceux-ci sont trop volumineux. Veuillez donc vous limiter au nécessaire. </p> <p> Nous vous rappelons qu’Allen Madelin offre également des services en droit de l’emploi, droit des successions, régimes de protection, diffamation, immobilier, droit de la famille ainsi que divorce. </p> <p>N’hésitez pas à nous contacter pour toutes autres questions.</p> <p>Merci et bonne journée !</p>',contract:'<p>Bonjour,</p> <p> Vous trouverez le contrat pour les services de <strong>Me {{lawyerName}}</strong> ci-joint. </p> <p> S’il-vous-plait, veuillez nous retourner le contrat signé à la 3e page et initialisé au bas de chaque page. Complétez la fiche client avec vos informations et la fiche avec celles de la partie adverse, le cas échéant. Nous aurons également besoin d’une copie de votre pièce d’identité. </p> <p> Concernant les frais d’ouverture de dossier, un dépôt initial de <strong>{{depositAmount}}</strong>$ + taxes (<strong>{{totalAmount}}</strong>$) est requis. Ce montant sera placé dans un compte en fidéicommis et il servira pour les débours judiciaires et extra-judiciaires. Vous pouvez procéder au paiement par virement Interac à l’adresse <a href="mailto:trust@amlex.ca">trust@amlex.ca</a>, sinon par carte de crédit (noter que les paiements par carte de crédit sont soumis à des frais additionnels de 4 %), par argent comptant ou par chèque adressé à Allen Madelin Inc. </p> <p>Bien à vous.</p>',reply:'<p>Bonjour,</p> <p> Nous avons reçu votre courriel et pris connaissance de votre situation. <strong>Me {{lawyerName}}</strong> saura utilement vous conseiller. Nous vous proposons de prendre rendez-vous pour une première consultation avec l’avocat au cours de laquelle on vous expliquera quelles sont vos options juridiques et les différentes démarches. </p> <p> Une première consultation est facturée 125 $ + taxes et dure généralement entre 30 min et 1h. Elle est, pour vous, l’occasion de comprendre juridiquement votre situation et d’obtenir plusieurs conseils sur les possibles voies de résolution ainsi que leurs frais approximatifs. </p> <p> Vous pouvez nous contacter au <a href="tel:514-904-4017">514-904-4017</a> pour connaître les prochaines disponibilités. </p> <p>Cordialement,</p>',feedback:'<p>Bonjour,</p> <p> Nous espérons que vous avez été satisfait des services que notre cabinet vous a offert. Nous nous engageons à fournir un service juridique de qualité et à améliorer continuellement notre expertise pour mieux répondre aux besoins de nos clients. </p> <p> Dans cette optique, nous serions très reconnaissants si vous pouviez prendre quelques minutes pour partager votre expérience avec nous. </p> <p> Si vous êtes disposé(e) à laisser un commentaire, nous vous invitons à le faire via le lien suivant : <a href="https://g.page/r/CXx1fndizC6lEBM/review" target="_blank" rel="noopener">https://g.page/r/CXx1fndizC6lEBM/review</a> </p> <p> Nous vous remercions par avance pour votre temps et votre précieuse contribution. </p> <p>L’équipe Allen Madelin</p>',suivi:"<p>Monsieur X,</p> <p> J'espère que vous allez bien. Je me permets de revenir vers vous concernant le contrat de services. Souhaitez-vous toujours retenir nos services, même si ce n'est pas pour le moment ? Dans ce cas, nous conserverons vos documents originaux en toute sécurité. </p> <p> Dans le cas contraire, merci de nous informer de la date à laquelle vous souhaitez récupérer vos documents originaux. Nous vous rappelons que nous ne pourrons être tenus responsables de ceux-ci si vous décidez de ne pas poursuivre avec nos services. </p> <p>Dans l'attente de votre réponse,</p> <p>Cordialement,</p>"}},Nd={en:{contract:"assets/templates/en/Contract.docx",receipt:"assets/templates/en/PaymentReceipt.docx"},fr:{contract:"assets/templates/fr/Contract.docx",receipt:"assets/templates/fr/PaymentReceipt.docx"}};function Pd(e,t){return Od.apply(this,arguments)}function Od(){var e;return e=_d().mark((function e(t,r){var n,o;return _d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Nd[t][r],e.next=3,fetch("".concat(kd.env.PUBLIC_PATH||"").concat(n)).then((function(e){if(!e.ok)throw new Error("Failed to fetch template at ".concat(n,": ").concat(e.status));return e.arrayBuffer()}));case 3:return o=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})),Od=function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Sd(i,n,o,a,s,"next",e)}function s(e){Sd(i,n,o,a,s,"throw",e)}a(void 0)}))},Od.apply(this,arguments)}function Rd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Md(t){document.querySelectorAll(".page").forEach((function(e){return e.classList.remove("active")}));var r=document.getElementById(t);r&&(r.classList.add("active"),t===e&&r.classList.remove("hidden"))}function Dd(){var e=document.getElementById(s);e&&e.classList.add("hidden");var r,a=Office.context.mailbox.item?Office.context.mailbox.item.itemType:null;if(a===Office.MailboxEnums.ItemType.Message){var c=document.getElementById(t);c&&c.classList.add("hidden")}else a===Office.MailboxEnums.ItemType.Appointment?[n,o,i].forEach((function(e){var t=document.getElementById(e);t&&t.classList.add("hidden")})):console.error("Unable to determine the extension point.");!function(){var e,t=td(),r=(e=new Set(t.flatMap((function(e){return e.specialties}))),function(e){if(Array.isArray(e))return Rd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Rd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rd(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(e){return{value:e,label:$d[e]?$d[e].label:e}}));r=r.sort((function(e,t){return"Other (Specify)"===e.label?1:"Other (Specify)"===t.label?-1:e.label.localeCompare(t.label)})),zd(T,r,"Select Case Type")}(),Gd(),r=dd,[h,p].forEach((function(e){zd(e,r.map((function(e){return{value:e,label:e.charAt(0).toUpperCase()+e.slice(1)}})),"Select Location")})),jd()}function Ud(e){document.getElementById("loading-overlay").classList.toggle("hidden",!e)}function qd(e){var t=document.getElementById("error-modal"),r=document.getElementById("error-message"),n=document.getElementById("error-ok-button");t&&r&&n?(r.textContent=e,t.classList.remove("hidden"),n.onclick=function(){t.classList.add("hidden")}):console.error("Error modal elements not found.")}function Bd(e){var t=e.title,r=e.contentOrFile,n=e.isFile,o=void 0!==n&&n,i=e.styles,a=void 0===i?"":i,s=e.width,c=void 0===s?684:s,l=e.height,u=void 0===l?600:l,d=e.position,h=void 0===d?"center":d,p=0,f=0;"center"===h?(p=(window.screen.width-c)/2,f=(window.screen.height-u)/2):"bottom-right"===h&&(p=window.screen.width-c,f=window.screen.height-u);var m=window.open("",t,"width=".concat(c,",height=").concat(u,",left=").concat(p,",top=").concat(f)),g=function(){var e=m.document.createElement("style");e.textContent="\n      body {\n        background-color: #1e1e1e;\n        color: #f4f4f4;\n        font-family: 'Trebuchet MS', 'Tahoma', 'Arial', sans-serif;\n        line-height: 1.6;\n        margin: 0;\n        padding: 1rem;\n      }\n      a {\n        color: #0078d4;\n        text-decoration: none;\n      }\n      a:hover {\n        text-decoration: underline;\n      }\n      h3 {\n        color: #0078d4;\n      }\n            button {\n        background-color: #0078d4;\n        color: #fff;\n        border: none;\n        padding: 0.5rem 1rem;\n        font-size: 1rem;\n        cursor: pointer;\n        border-radius: 4px;\n      }\n      button:hover {\n        background-color: #005a9e;\n      }\n      ".concat(a,"\n    "),m.document.head.appendChild(e)};o?fetch(r).then((function(e){if(!e.ok)throw new Error("Failed to load file: ".concat(r));return e.text()})).then((function(e){m.document.write(e),m.document.close(),g()})).catch((function(e){console.error("Error loading file:",e),m.document.write("\n          <html>\n            <head><title>Error</title></head>\n            <body>\n              <h3>Failed to load the requested file.</h3>\n              <p>".concat(e.message,'</p>\n              <button onclick="window.close()">Close</button>\n            </body>\n          </html>\n        ')),m.document.close(),g()})):(m.document.write("\n      <html>\n        <head>\n          <title>".concat(t,"</title>\n        </head>\n        <body>\n          ").concat(r,'\n          <button onclick="window.close()">Close</button>\n        </body>\n      </html>\n    ')),m.document.close(),g())}function Hd(e,t){var r="<h3>Next 5 available calendar slots</h3><ul>",n=e.indexOf(t);-1!==n&&(r+=s(e[n],!0));for(var o=t.start.toLocaleDateString(),i=n+1;i<e.length&&i<=n+4;i++){var a=e[i];a.start.toLocaleDateString()!==o&&(r+="<br>",o=a.start.toLocaleDateString()),r+=s(a)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.start.toLocaleString([],{weekday:"long",year:"numeric",month:"long",day:"numeric"}),n=e.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),o=e.end.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return"<li>".concat(t?"<strong>Selected Slot:</strong><br>":"").concat(r," - ").concat(n," to ").concat(o,"</li>")}Bd({title:"Available Slots",contentOrFile:r+="</ul>",width:480,height:300,position:"bottom-right"})}function Fd(){document.querySelectorAll("div[id$='-details']").forEach((function(e){e.hidden=!0,e.querySelectorAll("input, textarea").forEach((function(e){return e.value=""}))}));var e=document.getElementById(x);e&&(e.hidden=!0)}function zd(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Select an option",n=document.getElementById(e);n?(function(e,t){e.innerHTML="";var r=document.createElement("option");r.value="",r.textContent=t,r.disabled=!0,r.selected=!0,e.appendChild(r)}(n,r),t.forEach((function(e){var t=document.createElement("option");t.value=e.value,t.textContent=e.label,n.appendChild(t)}))):console.error("Dropdown with ID ".concat(e," not found."))}function jd(){[f,m,g,y,v].forEach((function(e){zd(e,[{value:"English",label:"English"},{value:"Français",label:"Français"}],"Select Language")}))}function Gd(){var e=Td.caseType,t=[c,l,u,d],r=td(),n=e?r.filter((function(t){return t.specialties.includes(e)})):r;t.forEach((function(e){zd(e,n.map((function(e){return{value:e.id,label:"".concat(e.name," (").concat(e.id,")")}})),"Select Lawyer")}))}function Wd(){var e=Td.clientLanguage;if(document.getElementById(E)){var t=({English:["Representation in Divorce","Representation in Estate Law","Limited Mandate"],"Français":["Représentation en divorce","Représentation en droit des successions","Mandat Limité"]}[e]||[]).map((function(e){return{value:e,label:e}}));t.push({value:"other",label:"Other (Specify)"}),zd(E,t,"Select Contract Title")}else console.error("Contract title dropdown not found.")}function Kd(){var e=document.getElementById("payment-options-container");e?Td.isPaymentMade?e.hidden=!1:e.hidden=!0:console.error("Payment options container not found.")}var $d={divorce:{label:"Divorce / Family Law",handler:function(){var e=document.getElementById("spouse-name").value,t=document.getElementById("conflict-search-done-divorce").checked;return"\n        ".concat(this.label,"\n        <p><strong>Spouse Name:</strong> ").concat(e,"</p>\n        <p>Conflict Search Done? ").concat(t?"✔️":"❌","</p>\n      ")}},estate:{label:"Successions / Estate Law",handler:function(){var e=document.getElementById("deceased-name").value,t=document.getElementById("executor-name").value,r=document.getElementById("conflict-search-done-estate").checked;return"\n        ".concat(this.label,"\n        <p><strong>Deceased Name:</strong> ").concat(e,"</p>\n        <p><strong>Executor Name:</strong> ").concat(t,"</p>\n        <p>Conflict Search Done? ").concat(r?"✔️":"❌","</p>\n      ")}},employment:{label:"Employment Law",handler:function(){var e=document.getElementById("employer-name").value;return"\n        ".concat(this.label,"\n        <p><strong>Employer Name:</strong> ").concat(e,"</p>\n      ")}},contract:{label:"Contract Law",handler:function(){var e=document.getElementById(k).value;return"\n        ".concat(this.label,"\n        <p><strong>Other Party:</strong> ").concat(e,"</p>\n      ")}},defamations:{label:"Defamations",handler:function(){return document.getElementById(k).value,"\n        ".concat(this.label,"\n      ")}},real_estate:{label:"Real Estate",handler:function(){return"\n        ".concat(this.label,"\n      ")}},name_change:{label:"Name Change",handler:function(){return"\n        ".concat(this.label,"\n      ")}},adoptions:{label:"Adoptions",handler:function(){return"\n        ".concat(this.label,"\n      ")}},mandates:{label:"Regimes de Protection / Mandates",handler:function(){var e=document.getElementById("mandate-details").value;return"\n        ".concat(this.label,"\n        <p><strong>Mandate Details:</strong> ").concat(e,"</p>\n      ")}},business:{label:"Business Law",handler:function(){var e=document.getElementById("business-name").value;return"\n        ".concat(this.label,"\n        <p><strong>Business Name:</strong> ").concat(e,"</p>\n      ")}},assermentation:{label:"Assermentation",handler:function(){return"\n        ".concat(this.label,"\n      ")}},common:{label:"Other (Specify)",handler:function(){var e=document.getElementById("common-field").value;if(!e)throw console.error("Please specify the details for the case type."),new Error("Missing common field details");return"\n        ".concat(e,"\n      ")}}};function Vd(){try{var e,t=null===(e=$d[Td.caseType])||void 0===e?void 0:e.handler();if(t)return t;throw new Error("Selected case type not found.")}catch(e){console.error(e.message)}}function Yd(){try{var e=Td.caseType;if(!(Td.clientName&&Td.clientPhone&&Td.clientEmail&&Td.clientLanguage&&e))throw new Error("Please fill in all required fields.");if(t=Td.clientPhone,!/^\+?[1-9]\d{1,14}$/.test(t.replace(/[\s-]/g,"")))throw new Error("Please provide a valid phone number in the format 555-555-5555.");if(!Qd(Td.clientEmail))throw new Error("Please provide a valid email address.");return!0}catch(e){return console.error(e.message),!1}var t}function Qd(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.toLowerCase())}var Xd=r(85072),Zd=r.n(Xd),Jd=r(97825),eh=r.n(Jd),th=r(77659),rh=r.n(th),nh=r(55056),oh=r.n(nh),ih=r(10540),ah=r.n(ih),sh=r(41113),ch=r.n(sh),lh=r(28926),uh={};function dh(e){return dh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dh(e)}function hh(){hh=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new L(n||[]);return o(a,"_invoke",{value:k(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function w(){}var b={};l(b,a,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(N([])));E&&E!==r&&n.call(E,a)&&(b=E);var C=w.prototype=y.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,i,a,s){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==dh(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function k(t,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var l=d(t,r,n);if("normal"===l.type){if(o=n.done?m:p,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function I(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(dh(t)+" is not iterable")}return v.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:v,configurable:!0}),v.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},T(x.prototype),l(x.prototype,s,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new x(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(C),l(C,c,"Generator"),l(C,a,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function ph(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function fh(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ph(i,n,o,a,s,"next",e)}function s(e){ph(i,n,o,a,s,"throw",e)}a(void 0)}))}}function mh(){return(mh=fh(hh().mark((function e(){return hh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gl("reply");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gh(){return(gh=fh(hh().mark((function e(){return hh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gl("contract");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yh(){return(yh=fh(hh().mark((function e(){var t;return hh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Td.location,e.next=3,Gl(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vh(e){return wh.apply(this,arguments)}function wh(){return wh=fh(hh().mark((function e(t){var r,n,o,i,a,s,c,l,u,d,h,p,f;return hh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=rd(Td.lawyerId),n=Td.location,e.next=5,Ku();case 5:if(o=e.sent,"manual"!==t){e.next=17;break}if(s=null===(i=document.getElementById(b))||void 0===i?void 0:i.value,c=null===(a=document.getElementById(A))||void 0===a?void 0:a.value,s&&c){e.next=11;break}throw new Error("Please select a valid date and time for manual scheduling.");case 11:if(l=new Date("".concat(s,"T").concat(c)),u=new Date(l.getTime()+36e5),d={start:l,end:u,location:n},wd(r.id,d,o)){e.next=16;break}throw new Error("The selected time slot is not valid.");case 16:return e.abrupt("return",[d]);case 17:return h=bd(r,n,o),e.next=20,Promise.all(h.map(function(){var e=fh(hh().mark((function e(t){return hh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{slot:t,valid:wd(r.id,t,o)});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 20:if(p=e.sent,0!==(f=p.filter((function(e){return e.valid})).map((function(e){return e.slot}))).length){e.next=24;break}throw new Error("No available slots found in the next 2 weeks.");case 24:return console.log("Valid slots:",f),e.abrupt("return",f);case 28:e.prev=28,e.t0=e.catch(0),console.error("Error finding schedule slot:",e.t0),qd(e.t0.message);case 32:case"end":return e.stop()}}),e,null,[[0,28]])}))),wh.apply(this,arguments)}function bh(){return(bh=fh(hh().mark((function e(){var t,r,n,o,i;return hh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Ud(!0),Yd()){e.next=4;break}throw new Error("Invalid inputs.");case 4:return r=null===(t=document.getElementById(w))||void 0===t?void 0:t.value,e.next=7,vh(r);case 7:if((n=e.sent)&&0!==n.length){e.next=10;break}throw new Error("No available slots found.");case 10:return o=new Date,i="manual"===r?n[0]:n.find((function(e){return!vd(e.start,o)||e.start>o}))||n[0],console.log("Selected appointment slot:",i.start),"auto"===r&&Hd(n,i),e.next=16,Kl(i);case 16:console.log("Scheduled appointment successfully."),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error("Scheduling Error:",e.t0);case 22:return e.prev=22,Ud(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,19,22,25]])})))).apply(this,arguments)}uh.styleTagTransform=ch(),uh.setAttributes=oh(),uh.insert=rh().bind(null,"head"),uh.domAPI=eh(),uh.insertStyleElement=ah(),Zd()(lh.A,uh),lh.A&&lh.A.locals&&lh.A.locals,Office.onReady(function(){var r=fh(hh().mark((function r(k){return hh().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(k.host!==Office.HostType.Outlook){r.next=6;break}return r.next=3,Sl.initialize();case 3:Dd(),r.next=7;break;case 6:k.host===Office.HostType.Word&&document.querySelectorAll(".menu-btn").forEach((function(e){e.id!==s&&e.id!==a&&e.classList.add("hidden"),Wd(),jd()}));case 7:document.querySelectorAll("input, select, textarea").forEach((function(e){e.addEventListener("change",(function(t){var r=t.target,n=r.id,o=r.value;switch(console.log("changed: %s",e.id),n){case c:case l:case u:case d:Td.update("lawyerId",o);break;case h:case p:Td.update("location",o);break;case T:Td.update("caseType",o),Gd(),function(){var e=Td.caseType,t=document.getElementById(x);if(Fd(),$d[e]){var r="".concat(e,"-details"),n=document.getElementById(r);n&&(t.hidden=!1,n.hidden=!1)}else t.hidden=!0}();break;case"schedule-client-name":case"word-client-name":Td.update("clientName",o);break;case"schedule-client-phone":Td.update("clientPhone",o);break;case"schedule-client-email":case"conf-client-email":case"contract-client-email":case"reply-client-email":case"word-client-email":Td.update("clientEmail",o);break;case f:case m:case g:case y:case v:Td.update("clientLanguage",o),Office.context.host===Office.HostType.Word&&Wd();break;case w:var i=document.getElementById(b),a=document.getElementById(A),s=document.querySelector("label[for=".concat(b,"]")),k=document.querySelector("label[for=".concat(A,"]"));"auto"===t.target.value?(s.classList.add("hidden"),k.classList.add("hidden"),i.classList.add("hidden"),a.classList.add("hidden"),i.required=!1,a.required=!1):(s.classList.remove("hidden"),k.classList.remove("hidden"),i.classList.remove("hidden"),a.classList.remove("hidden"),i.required=!0,a.required=!0);break;case"conf-date":case b:console.log("Date changed:",o),Td.update("appointmentDate",o);break;case"conf-time":case A:console.log("Time changed:",o),Td.update("appointmentTime",o);break;case"schedule-first-consultation":case"conf-first-consultation":Td.update("isFirstConsultation",t.target.checked);break;case"ref-barreau":Td.update("isRefBarreau",t.target.checked);break;case"payment-made":Td.update("isPaymentMade",t.target.checked),Kd();break;case"payment-method":Td.update("paymentMethod",o);break;case"schedule-notes":Td.update("notes",o);break;case"email-contract-deposit":case"word-contract-deposit":Td.update("depositAmount",o);break;case E:var I=document.getElementById(C);"other"===o?(I.classList.remove("hidden"),I.required=!0):(I.classList.add("hidden"),I.required=!1,Td.update("contractTitle",o));break;case C:Td.update("contractTitle",o)}}))})),document.querySelectorAll(".menu-btn").forEach((function(r){r.addEventListener("click",(function(r){switch(r.target.id){case t:Md("schedule-page");break;case n:Md("confirmation-page");break;case o:Md("contract-page");break;case i:Md("reply-page");break;case a:Bd({title:"User Manual",contentOrFile:"./user-manual.html",isFile:!0,position:"bottom-right"});break;case s:Md(e)}}))})),document.querySelectorAll(".back-btn").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),document.querySelectorAll("form").forEach((function(e){return e.reset()})),Td.reset(),Fd(),Kd(),Md("menu-page"),Gd(),jd(),Office.context.host===Office.HostType.Word&&Wd()}))})),document.querySelectorAll(".submit-btn").forEach((function(e){e.addEventListener("click",(function(e){switch(e.preventDefault(),e.target.id){case"schedule-appointment-btn":!function(){bh.apply(this,arguments)}();break;case"send-confirmation-btn":!function(){yh.apply(this,arguments)}();break;case"send-contract-btn":!function(){gh.apply(this,arguments)}();break;case"send-reply-btn":!function(){mh.apply(this,arguments)}();break;case"generate-word-contract-btn":!function(){Vl.apply(this,arguments)}()}}))}));case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}(),function(){"use strict";new URL(r(83315),r.b),new URL(r(49605),r.b)}()}();
//# sourceMappingURL=taskpane.bca0250ce2137e51e3ec.js.map